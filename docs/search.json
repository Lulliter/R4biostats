[
  {
    "objectID": "practice/slides_lab03.html#topics-discussed-in-lecture-3",
    "href": "practice/slides_lab03.html#topics-discussed-in-lecture-3",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Topics discussed in Lecture # 3",
    "text": "Topics discussed in Lecture # 3\n\n\nunderstand\n\nLecture 3: topics\n\nTesting for a correlation hypothesis (relationship of variables)\n\nPearson rho analysis (param)\nSpearman test (no param)\n\n\nMeasures of association\n\nFisher’s Exact Test\nChi-Square Test of Independence\n\n\nFrom correlation/association to causation\n\nintroduction to experiments\n\nExample: Linear regression models\nExample: Multiple Linear Regression\n\n\n\n\nFrom causation to prediction\n\nintroduction to Machine Learning\n\nSupervised algorithms\nUnsupervised algorithms"
  },
  {
    "objectID": "practice/slides_lab03.html#needed-r-packages",
    "href": "practice/slides_lab03.html#needed-r-packages",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Needed R Packages",
    "text": "Needed R Packages\n\n\nWe will use functions from packages base, utils, and stats (pre-installed and pre-loaded)\nWe will also use the packages below (specifying package::function for clarity).\n\n\n\n# Load them for this R session\n\n# General \nlibrary(fs)      # file/directory interactions\nlibrary(here)    # tools find your project's files, based on working directory\nlibrary(janitor) # tools for examining and cleaning data\nlibrary(dplyr)   # {tidyverse} tools for manipulating and summarizing tidy data \nlibrary(forcats) # {tidyverse} tool for handling factors\nlibrary(openxlsx) # Read, Write and Edit xlsx Files\nlibrary(flextable) # Functions for Tabular Reporting\n\n# Statistics\nlibrary(rstatix) # Pipe-Friendly Framework for Basic Statistical Tests\nlibrary(broom) # Convert Statistical Objects into Tidy Tibbles\nlibrary(tidymodels) # not installed on this machine\n# Plotting\nlibrary(ggplot2) # Create Elegant Data Visualisations Using the Grammar of Graphics\nlibrary(ggpubr) # 'ggplot2' Based Publication Ready Plots\n\n# Data \n# devtools::install_github(\"OI-Biostat/oi_biostat_data\")\n#library(oibiostat) \n\n\n# load some colors\ncolors &lt;- readRDS(here::here(\"practice\", \"data_input\", \"03_datasets\",\"colors.rds\"))"
  },
  {
    "objectID": "practice/slides_lab03.html#importing-dataset-1-nhanes",
    "href": "practice/slides_lab03.html#importing-dataset-1-nhanes",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Importing Dataset 1 (NHANES)",
    "text": "Importing Dataset 1 (NHANES)\n\nAdapting the function here to match your own folder structure\n\nName: NHANES (National Health and Nutrition Examination Survey) combines interviews and physical examinations to assess the health and nutritional status of adults and children in the United States. Sterted in the 1960s, it became a continuous program in 1999. Documentation: dataset1Sampling details: Here we use a sample of 500 adults from NHANES 2009-2010 & 2011-2012 (nhanes.samp.adult.500 in the R oibiostat package, which has been adjusted so that it can be viewed as a random sample of the US population)\n\n# Check my working directory location\n# here::here()\n\n# Use `here` in specifying all the subfolders AFTER the working directory \nnhanes_samp &lt;- read.csv(file = here::here(\"practice\", \"data_input\", \"03_datasets\",\n                                      \"nhanes_samp.csv\"), \n                          header = TRUE, # 1st line is the name of the variables\n                          sep = \",\", # which is the field separator character.\n                          na.strings = c(\"?\",\"NA\" ), # specific MISSING values  \n                          row.names = NULL)"
  },
  {
    "objectID": "practice/slides_lab03.html#nhanes-variables-and-their-description",
    "href": "practice/slides_lab03.html#nhanes-variables-and-their-description",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "- NHANES Variables and their description\n",
    "text": "- NHANES Variables and their description\n\n\n\n\n\n\n\nVariable\nType\nDescription\n\n\n\nX\nint\nxxxx\n\n\nID\nint\nxxxxx\n\n\nSurveyYr\nchr\nyyyy_mm. Ex. 2011_12\n\n\nGender\nchr\nGender (sex) of study participant coded as male or female\n\n\nAge\nint\n##\n\n\nAgeDecade\nchr\nyy-yy es 20-29\n\n\nRace1\nchr\nReported race of study participant: Mexican, Hispanic, White, Black, or Other\n\n\nRace3\nchr\nReported race of study participant... Not availale for 2009-10\n\n\nEducation\nchr\n[&gt;= 20 yro]. Ex. 8thGrade, 9-11thGrade, HighSchool, SomeCollege, or CollegeGrad.\n\n\nMaritalStatus\nchr\n[&gt;= 20 yro]. Ex. Married, Widowed, Divorced, Separated, NeverMarried, or LivePartner\n\n\nHHIncome\nchr\nTotal annual gross income for the household in US dollars\n\n\nHHIncomeMid\nint\nNumerical version of HHIncome derived from the middle income in each category. Ex. 12500 40000\n\n\nPoverty\ndbl\nA ratio of family income to poverty guidelines. Smaller numbers indicate more poverty Ex.. 0.95 1.74 4.99\n\n\nHomeRooms\nint\nHow many rooms are in home of study participant (counting kitchen but not bath room).\n\n\nHomeOwn\nchr\nOne of Home, Rent, or Other\n\n\nWork\nchr\nNotWorking Working\n\n\nWeight\ndbl\nWeight in kg\n\n\nHeight\ndbl\nStanding height in cm. Reported for participants aged 2 years or older.\n\n\nBMI\ndbl\nBody mass index (weight/height2 in kg/m2). Reported for participants aged 2 years or older\n\n\nPulse\nint\n60 second pulse rate\n\n\nBPSysAve\nint\nCombined systolic blood pressure reading, following the procedure outlined for BPXSAR\n\n\nBPDiaAve\nint\nCombined diastolic blood pressure reading, following the procedure outlined for BPXDAR\n\n\nBPSys1\nint\nSystolic blood pressure in mm Hg – first reading\n\n\nBPDia1\nint\nDiastolic blood pressure in mm Hg – second reading (consecutive readings)\n\n\nBPSys2\nint\nSystolic blood pressure in mm Hg – second reading (consecutive readings)\n\n\nBPDia2\nint\nDiastolic blood pressure in mm Hg – second reading\n\n\nBPSys3\nint\nSystolic blood pressure in mm Hg third reading (consecutive readings)\n\n\nBPDia3\nint\nDiastolic blood pressure in mm Hg – third reading (consecutive readings)\n\n\nTestosterone\ndbl\nTesterone total (ng/dL). Reported for participants aged 6 years or older. Not available for 2009-2010\n\n\nDirectChol\ndbl\nDirect HDL cholesterol in mmol/L. Reported for participants aged 6 years or older\n\n\nTotChol\ndbl\nTotal HDL cholesterol in mmol/L. Reported for participants aged 6 years or older\n\n\nUrineVol1\nint\nUrine volume in mL – first test. Reported for participants aged 6 years or older\n\n\nUrineFlow1\ndbl\nUrine flow rate in mL/min – first test. Reported for participants aged 6 years or older\n\n\nUrineVol2\nint\nUrine volume in mL – second test\n\n\nUrineFlow2\ndbl\nUrine flow rate (urine volume/time since last urination) in mL/min – second test\n\n\nDiabetes\nchr\nStudy participant told by a doctor or health professional that they have diabetes\n\n\nDiabetesAge\nint\nAge of study participant when first told they had diabetes\n\n\nHealthGen\nchr\nSelf-reported rating of health: Excellent, Vgood, Good, Fair, or Poor Fair\n\n\nDaysPhysHlthBad\nint\nSelf-reported # of days participant’s physical health was not good out of the past 30 days\n\n\nDaysMentHlthBad\nint\nSelf-reported # of days participant’s mental health was not good out of the past 30 days\n\n\nLittleInterest\nchr\nSelf-reported # of days where participant had little interest in doing things. Among: None, Several, Majority, or AlmostAll\n\n\nDepressed\nchr\nSelf-reported # of days where participant felt down, depressed or hopeless. Among: None, Several, Majority, or AlmostAll\n\n\nnPregnancies\nint\n# times participant has been pregnant\n\n\nnBabies\nint\n# deliveries resulted in live births\n\n\nPregnantNow\nchr\nPregnancy status ascertained for females 8-59 years of age\n\n\nAge1stBaby\nint\nAge of participant at time of first live birth\n\n\nSleepHrsNight\nint\nSelf-reported # of hours study participant gets at night on weekdays or workdays. For participants aged 16 years and older\n\n\nSleepTrouble\nchr\nParticipant [16 years and older] has had trouble sleeping. Coded as Yes or No.\n\n\nPhysActive\nchr\nParticipant does moderate or vigorous-intensity sports, fitness or recreational activities (Yes or No).\n\n\nPhysActiveDays\nint\nNumber of days in a typical week that participant does moderate or vigorous intensity activity.\n\n\nTVHrsDay\nchr\nNumber of hours per day on average participant watched TV over the past 30 days.\n\n\nCompHrsDay\nchr\nNumber of hours per day on average participant used a computer or gaming device over the past 30 day\n\n\nTVHrsDayChild\nlgl\n[2-11 yro] Number of hours per day on average participant watched TV over the past 30 days.\n\n\nCompHrsDayChild\nlgl\n[2-11 yro] Number of hours per day on average participant used a computer or gaming device over the past 30 day\n\n\nAlcohol12PlusYr\nchr\nParticipant has consumed at least 12 drinks of any type of alcoholic beverage in any one year\n\n\nAlcoholDay\nint\nAverage number of drinks consumed on days that participant drank alcoholic beverages\n\n\nAlcoholYear\nint\n[&gt;+ 18yro] Estimated number of days over the past year that participant drank alcoholic beverages\n\n\nSmokeNow\nchr\nStudy participant currently smokes cigarettes regularly. (Yes or No)\n\n\nSmoke100\nchr\nStudy participant has smoked at least 100 cigarettes in their entire life. (Yes pr No)\n\n\nSmoke100n\nchr\nSmoker Non-Smoker\n\n\nSmokeAge\nint\nAge study participant first started to smoke cigarettes fairly regularly\n\n\nMarijuana\nchr\nParticipant has tried marijuana\n\n\nAgeFirstMarij\nint\nAge Participant has tried marijuana first\n\n\nRegularMarij\nchr\nParticipant has been/is a regular marijuana user (used at least once a month for a year) (Yes or No)\n\n\nAgeRegMarij\nint\nAge of participant when first started regularly using marijuana\n\n\nHardDrugs\nchr\nParticipant has tried cocaine, crack cocaine, heroin or methamphetamine (Yes or No)\n\n\nSexEver\nchr\nParticipant had had sex (Yes or No)\n\n\nSexAge\nint\nAge Participant had had sex first time\n\n\nSexNumPartnLife\nint\nNumber of opposite sex partners participant has had\n\n\nSexNumPartYear\nint\nNumber of opposite sex partners over the past 12 months\n\n\nSameSex\nchr\nParticipant has had any kind of sex with a same sex partne(Yes or No)\n\n\nSexOrientation\nchr\nParticipant’s sexual orientation One of Heterosexual, Homosexual, Bisexual"
  },
  {
    "objectID": "practice/slides_lab03.html#importing-dataset-2-prevend",
    "href": "practice/slides_lab03.html#importing-dataset-2-prevend",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Importing Dataset 2 (PREVEND)",
    "text": "Importing Dataset 2 (PREVEND)\nData from the Prevention of Renal and Vascular End-stage Disease (PREVEND) study, which took place in the Netherlands. The study collected various demographic and cardiovascular risk factors. This dataset is from the third survey, which participants completed in 2003-2006; data is provided for 4,095 individuals who completed cognitive testing.\nName: PREVEND (Prevention of REnal and Vascular END-stage Disease) is a study which took place in the Netherlands on 8,592 participants aged 28-75, with subsequent follow-ups in 1997-1998. A second survey was conducted in 2001-2003 on 6,894 participants, 5,862 completed the third survey in 2003-2006 (here measurement of cognitive function was added to the study protocol).Documentation: dataset2Sampling details: Data from 4,095 individuals who completed cognitive testing are in the prevend dataset, available in the R package oibiostat.\n\n# Check my working directory location\n# here::here()\n\n# Use `here` in specifying all the subfolders AFTER the working directory \nprevend &lt;- read.csv(file = here::here(\"practice\", \"data_input\", \"03_datasets\",\n                                      \"prevend.csv\"), \n                          header = TRUE, # 1st line is the name of the variables\n                          sep = \",\", # which is the field separator character.\n                          na.strings = c(\"?\",\"NA\" ), # specific MISSING values  \n                          row.names = NULL)"
  },
  {
    "objectID": "practice/slides_lab03.html#prevend-variables-and-their-description",
    "href": "practice/slides_lab03.html#prevend-variables-and-their-description",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "- PREVEND Variables and their description\n",
    "text": "- PREVEND Variables and their description\n\n\n\n\n\n\n\nVariable\nDescription\n\n\n...\n..."
  },
  {
    "objectID": "practice/slides_lab03.html#importing-dataset-3-famuss",
    "href": "practice/slides_lab03.html#importing-dataset-3-famuss",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Importing Dataset 3 (FAMuSS)",
    "text": "Importing Dataset 3 (FAMuSS)\nName: FAMuSS (Functional SNPs Associated with Muscle Size and Strength) examine the association of demographic, physiological and genetic characteristics with muscle strength – including data on race and genotype at a specific locus on the ACTN3 gene (the “sports gene”).Documentation: dataset3Sampling details: the DATASET includes 595 observations on 9 variables\n\n# Check my working directory location\n# here::here()\n\n# Use `here` in specifying all the subfolders AFTER the working directory \nfamuss &lt;- read.csv(file = here::here(\"practice\", \"data_input\", \"03_datasets\",\n                                      \"famuss.csv\"), \n                          header = TRUE, # 1st line is the name of the variables\n                          sep = \",\", # which is the field separator character.\n                          na.strings = c(\"?\",\"NA\" ), # specific MISSING values  \n                          row.names = NULL)"
  },
  {
    "objectID": "practice/slides_lab03.html#famuss-variables-and-their-description",
    "href": "practice/slides_lab03.html#famuss-variables-and-their-description",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "- FAMuSS Variables and their description\n",
    "text": "- FAMuSS Variables and their description\n\n\n\n\n\n\n\nVariable\nDescription\n\n\n\nX\nid\n\n\nndrm.ch\nPercent change in strength in the non-dominant arm\n\n\ndrm.ch\nPercent change in strength in the dominant arm\n\n\nsex\nSex of the participant\n\n\nage\nAge in years\n\n\nrace\nRecorded as African Am (African American), Caucasian, Asian, Hispanic, Other\n\n\nheight\nHeight in inches\n\n\nweight\nWeight in pounds\n\n\nactn3.r577x\nGenotype at the location r577x in the ACTN3 gene.\n\n\nbmi\nBody Mass Index"
  },
  {
    "objectID": "practice/slides_lab03.html#explore-relationships-between-two-variables",
    "href": "practice/slides_lab03.html#explore-relationships-between-two-variables",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Explore relationships between two variables",
    "text": "Explore relationships between two variables\nApproaches for summarizing relationships between two variables vary depending on variable types…\n\nTwo numerical variables\nTwo categorical variables\nOne numerical variable and one categorical variable\n\nTwo variables \\(x\\) and \\(y\\) are\n\n\npositively associated if \\(y\\) increases as \\(x\\) increases.\n\nnegatively associated if \\(y\\) decreases as \\(x\\) increases."
  },
  {
    "objectID": "practice/slides_lab03.html#two-numerical-variables-plot",
    "href": "practice/slides_lab03.html#two-numerical-variables-plot",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Two numerical variables (plot)",
    "text": "Two numerical variables (plot)\nHeight and weight (taken from the nhanes_samp dataset) are positively associated.\n\nnotice we can also use the generic function base::plot for a simple scatter plot\n\n\n# rename for convenience\nnhanes &lt;- nhanes_samp %&gt;% \n  janitor::clean_names()\n\n# basis plot \nplot(nhanes$height, nhanes$weight,\n     xlab = \"Height (cm)\", ylab = \"Weight (kg)\", cex = 0.8)"
  },
  {
    "objectID": "practice/slides_lab03.html#two-numerical-variables-plot-output",
    "href": "practice/slides_lab03.html#two-numerical-variables-plot-output",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Two numerical variables (plot)",
    "text": "Two numerical variables (plot)"
  },
  {
    "objectID": "practice/slides_lab03.html#two-numerical-variables-correlation-with-statscor",
    "href": "practice/slides_lab03.html#two-numerical-variables-correlation-with-statscor",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Two numerical variables: correlation (with stats::cor)",
    "text": "Two numerical variables: correlation (with stats::cor)\nCorrelation is a numerical summary that measures the strength of a linear relationship between two variables.\n\n\nThe correlation coefficient \\(r\\) takes on values between \\(-1\\) and \\(1\\).\nThe closer \\(r\\) is to \\(\\pm 1\\), the stronger the linear association.\n\nHere we compute the Pearson rho (parametric), with the function cor\n\nnotice the use argument to choose how to deal with missing values (in this case only using all complete pairs)\n\n\n\n\nis.numeric(nhanes$height) \n\n[1] TRUE\n\nis.numeric(nhanes$weight)\n\n[1] TRUE\n\n# using `stats` package\ncor(x = nhanes$height, y =  nhanes$weight, \n    # argument for dealing with missing values\n    use = \"pairwise.complete.obs\",\n    method = \"pearson\")\n\n[1] 0.4102269"
  },
  {
    "objectID": "practice/slides_lab03.html#two-numerical-variables-correlation-or-with-statscor.test",
    "href": "practice/slides_lab03.html#two-numerical-variables-correlation-or-with-statscor.test",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Two numerical variables: correlation (or with stats::cor.test)",
    "text": "Two numerical variables: correlation (or with stats::cor.test)\n\nHere we compute the Pearson rho (parametric), with the function cor.test (the same we used for testing paired samples)\n\nimplicitely takes care on NAs\n\n\n\n\n\n# using `stats` package \ncor_test_result &lt;- cor.test(x = nhanes$height, y =  nhanes$weight, \n                            method = \"pearson\")\n\n# looking at the cor estimate\ncor_test_result[[\"estimate\"]][[\"cor\"]]\n\n[1] 0.4102269\n\n\n\nThe function ggpubr::ggscatter gives us all in one (scatter plot + \\(r\\) (“R”))\n\n\nlibrary(\"ggpubr\") # 'ggplot2' Based Publication Ready Plots\nggpubr::ggscatter(nhanes, x = \"height\", y = \"weight\", \n                  cor.coef = TRUE, cor.method = \"pearson\", #cor.coef.coord = 2,\n                  xlab = \"Height (in)\", ylab = \"Weight (lb)\")"
  },
  {
    "objectID": "practice/slides_lab03.html#two-numerical-variables-correlation-or-with-statscor.test-output",
    "href": "practice/slides_lab03.html#two-numerical-variables-correlation-or-with-statscor.test-output",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Two numerical variables: correlation (or with stats::cor.test)",
    "text": "Two numerical variables: correlation (or with stats::cor.test)"
  },
  {
    "objectID": "practice/slides_lab03.html#spearman-rank-order-correlation",
    "href": "practice/slides_lab03.html#spearman-rank-order-correlation",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Spearman rank-order correlation",
    "text": "Spearman rank-order correlation\nThe Spearman’s rank-order correlation is the nonparametric version of the Pearson correlation.\nSpearman’s correlation coefficient, (\\(ρ\\), also signified by \\(rs\\)) measures the strength and direction of association between two ranked variables.\n\nused when 2 variables have a non-linear relationship\nexcellent for ordinal data (when Pearson’s is not appropriate), i.e. Likert scale items\n\n\nTo compute it, we simply calculate Pearson’s correlation of the rankings of the raw data (instead of the data)."
  },
  {
    "objectID": "practice/slides_lab03.html#spearman-rank-order-correlation-example",
    "href": "practice/slides_lab03.html#spearman-rank-order-correlation-example",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Spearman rank-order correlation (example)",
    "text": "Spearman rank-order correlation (example)\nLet’s say we want to get Spearman’s correlation with ordinal factors Education and HealthGen in the NHANES sample. I have to convert them to their underlying numeric code, to compare rankings.\n\ntabyl(nhanes$education)\n\n nhanes$education   n percent valid_percent\n        8th Grade  32   0.064    0.06412826\n   9 - 11th Grade  68   0.136    0.13627255\n     College Grad 157   0.314    0.31462926\n      High School  94   0.188    0.18837675\n     Some College 148   0.296    0.29659319\n             &lt;NA&gt;   1   0.002            NA\n\ntabyl(nhanes$health_gen)\n\n nhanes$health_gen   n percent valid_percent\n         Excellent  47   0.094    0.10444444\n              Fair  53   0.106    0.11777778\n              Good 177   0.354    0.39333333\n              Poor  11   0.022    0.02444444\n             Vgood 162   0.324    0.36000000\n              &lt;NA&gt;  50   0.100            NA\n\nnhanes &lt;- nhanes %&gt;% \n  # reorder education\n  mutate (edu_ord = factor (education, \n                            levels = c(\"8th Grade\", \"9 - 11th Grade\",\n                                       \"High School\", \"Some College\",\n                                       \"College Grad\" , NA))) %&gt;%  \n  # create edu_rank \n  mutate (edu_rank = as.numeric(edu_ord)) %&gt;% \n  # reorder health education\n  mutate (health_ord = factor (health_gen, \n                            levels = c( NA, \"Poor\", \"Fair\",\n                                       \"Good\", \"Vgood\",\n                                       \"Excellent\"))) %&gt;%\n  # create health_rank \n  mutate (health_rank = as.numeric(health_ord)) \n\ntable(nhanes$edu_ord, useNA = \"ifany\" )\n\n\n     8th Grade 9 - 11th Grade    High School   Some College   College Grad \n            32             68             94            148            157 \n          &lt;NA&gt; \n             1 \n\ntable(nhanes$edu_rank, useNA = \"ifany\" )\n\n\n   1    2    3    4    5 &lt;NA&gt; \n  32   68   94  148  157    1 \n\ntable(nhanes$health_ord, useNA = \"ifany\" )\n\n\n     Poor      Fair      Good     Vgood Excellent      &lt;NA&gt; \n       11        53       177       162        47        50 \n\ntable(nhanes$health_rank,  useNA = \"ifany\" )\n\n\n   1    2    3    4    5 &lt;NA&gt; \n  11   53  177  162   47   50"
  },
  {
    "objectID": "practice/slides_lab03.html#spearman-rank-order-correlation-example-cont.",
    "href": "practice/slides_lab03.html#spearman-rank-order-correlation-example-cont.",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Spearman rank-order correlation (example cont.)",
    "text": "Spearman rank-order correlation (example cont.)\nNow we can actually compute it\n\nAfter setting up the variables correctly (as.numeric), just specify method = \"spearman\"\n\n\n\n# using `stats` package \ncor_test_result_sp &lt;- cor.test(x = nhanes$edu_rank,\n                               y = nhanes$health_rank, \n                               method = \"spearman\", \n                               exact = FALSE) # removes the Ties message warning \n# looking at the cor estimate\ncor_test_result_sp\n\n\n    Spearman's rank correlation rho\n\ndata:  nhanes$edu_rank and nhanes$health_rank\nS = 10641203, p-value = 1.915e-10\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n      rho \n0.2946493 \n\n#cor_test_result_sp[[\"estimate\"]][[\"rho\"]]"
  },
  {
    "objectID": "practice/slides_lab03.html#two-categorical-variables-plot",
    "href": "practice/slides_lab03.html#two-categorical-variables-plot",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Two categorical variables (plot)",
    "text": "Two categorical variables (plot)\nIn the famuss dataset, the variables race, and actn3.r577x are categorical variables.\n\n## genotypes as columns\ngenotype.race = matrix(table(famuss$actn3.r577x, famuss$race), ncol=3, byrow=T)\ncolnames(genotype.race) = c(\"CC\", \"CT\", \"TT\")\nrownames(genotype.race) = c(\"African Am\", \"Asian\", \"Caucasian\", \"Hispanic\", \"Other\")\n\nbarplot(genotype.race, col = colors[c(7, 4, 1, 2, 3)], ylim=c(0,300), width=2)\nlegend(\"topright\", inset=c(.05, 0), fill=colors[c(7, 4, 1, 2, 3)], \n       legend=rownames(genotype.race))"
  },
  {
    "objectID": "practice/slides_lab03.html#two-categorical-variables-contingency-table",
    "href": "practice/slides_lab03.html#two-categorical-variables-contingency-table",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Two categorical variables (contingency table)",
    "text": "Two categorical variables (contingency table)\nSpecifically, the variable actn3.r577x takes on three possible levels (CC, CT, or TT) which indicate the distribution of genotype at location r577x on the ACTN3 gene for the FAMuSS study participants.\nA contingency table summarizes data for two categorical variables.\n\nthe function stats::addmargins puts arbitrary Margins on Multidimensional Tables\n\nThe extra column & row \"Sum\" provide the marginal totals across each row and each column, respectively\n\n\n\n\n# levels of actn3.r577x\ntable(famuss$actn3.r577x)\n\n\n CC  CT  TT \n173 261 161 \n\n# contingency table to summarize race and actn3.r577x\naddmargins(table(famuss$race, famuss$actn3.r577x))\n\n            \n              CC  CT  TT Sum\n  African Am  16   6   5  27\n  Asian       21  18  16  55\n  Caucasian  125 216 126 467\n  Hispanic     4  10   9  23\n  Other        7  11   5  23\n  Sum        173 261 161 595"
  },
  {
    "objectID": "practice/slides_lab03.html#two-categorical-variables-contingency-table-prop",
    "href": "practice/slides_lab03.html#two-categorical-variables-contingency-table-prop",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Two categorical variables (contingency table prop)",
    "text": "Two categorical variables (contingency table prop)\nContingency tables can also be converted to show proportions. Since there are 2 variables, it is necessary to specify whether the proportions are calculated according to the row variable or the column variable. + using the margin = argument in the base::prop.table function (1 indicates rows, 2 indicates columns)\n\n# adding row proportions\naddmargins(prop.table(table(famuss$race, famuss$actn3.r577x), margin =  1))\n\n            \n                    CC        CT        TT       Sum\n  African Am 0.5925926 0.2222222 0.1851852 1.0000000\n  Asian      0.3818182 0.3272727 0.2909091 1.0000000\n  Caucasian  0.2676660 0.4625268 0.2698073 1.0000000\n  Hispanic   0.1739130 0.4347826 0.3913043 1.0000000\n  Other      0.3043478 0.4782609 0.2173913 1.0000000\n  Sum        1.7203376 1.9250652 1.3545972 5.0000000\n\n# adding column proportions\naddmargins(prop.table(table(famuss$race, famuss$actn3.r577x),margin =  2))\n\n            \n                     CC         CT         TT        Sum\n  African Am 0.09248555 0.02298851 0.03105590 0.14652996\n  Asian      0.12138728 0.06896552 0.09937888 0.28973168\n  Caucasian  0.72254335 0.82758621 0.78260870 2.33273826\n  Hispanic   0.02312139 0.03831418 0.05590062 0.11733618\n  Other      0.04046243 0.04214559 0.03105590 0.11366392\n  Sum        1.00000000 1.00000000 1.00000000 3.00000000"
  },
  {
    "objectID": "practice/slides_lab03.html#chi-squared-test-of-independence",
    "href": "practice/slides_lab03.html#chi-squared-test-of-independence",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Chi Squared test of independence\n",
    "text": "Chi Squared test of independence\n\nThe Chi-squared test is a hypothesis test used to determine whether there is a relationship between two categorical variables.\n\ncategorical vars. can have nominal or ordinal measurement scale\nthe observed frequencies are compared with the expected frequencies and their deviations are examined.\n\n\n# Chi-squared test\n# (Test of association to see if \n# H0: the 2 cat var (race  & actn3.r577x ) are independent\n# H1: the 2 cat var are correlated in __some way__\n\ntab &lt;- table(famuss$race, famuss$actn3.r577x)\ntest_chi &lt;- chisq.test(tab)\n\nthe obtained result (test_chi) is a list of objects…\n\n\n\n You try…\n\n\n…run View(test_chi) to check"
  },
  {
    "objectID": "practice/slides_lab03.html#chi-squared-test-of-independence-cont",
    "href": "practice/slides_lab03.html#chi-squared-test-of-independence-cont",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Chi Squared test of independence (cont)",
    "text": "Chi Squared test of independence (cont)\nWithin test_chi results there are:\n\n\n\n\nObserved frequencies = how often a combination occurs in our sample\n\n\n# Observed frequencies\ntest_chi$observed\n\n            \n              CC  CT  TT\n  African Am  16   6   5\n  Asian       21  18  16\n  Caucasian  125 216 126\n  Hispanic     4  10   9\n  Other        7  11   5\n\n\n\n\n\nExpected frequencies = what would it be if the 2 vars were PERFECTLY INDEPENDENT\n\n\n# Expected frequencies\nround(test_chi$expected  , digits = 1 )\n\n            \n                CC    CT    TT\n  African Am   7.9  11.8   7.3\n  Asian       16.0  24.1  14.9\n  Caucasian  135.8 204.9 126.4\n  Hispanic     6.7  10.1   6.2\n  Other        6.7  10.1   6.2"
  },
  {
    "objectID": "practice/slides_lab03.html#chi-squared-test-of-independence-res",
    "href": "practice/slides_lab03.html#chi-squared-test-of-independence-res",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Chi Squared test of independence (res)",
    "text": "Chi Squared test of independence (res)\n\nRecall that\n\n\n\\(H_{0}\\): the 2 cat. var. are independent\n\n\n\\(H_{1}\\): the 2 cat. var. are correlated in some way\n\n\nThe result of Chi-Square test represents a comparison of the above two tables (observed v. expected):\n\np-value = 0.01286 smaller than α = 0.05 so we REJECT the null hypothesis\n\n\n\n\n\ntest_chi\n\n\n    Pearson's Chi-squared test\n\ndata:  tab\nX-squared = 19.4, df = 8, p-value = 0.01286"
  },
  {
    "objectID": "practice/slides_lab03.html#computing-cramers-v-after-test-of-independence-by-hand",
    "href": "practice/slides_lab03.html#computing-cramers-v-after-test-of-independence-by-hand",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Computing Cramer’s V after test of independence (by hand)",
    "text": "Computing Cramer’s V after test of independence (by hand)\nRecall that Crammer’s V is a way in which we can measure effect size of the test of independence (i.e. a measure of the strength of association between two nominal variables)\n\nV ranges from [0 1] (the smaller V, the lower the correlation)\n\n\\[V=\\sqrt{\\frac{\\chi^2}{n(k-1)}} \\]\nwhere:\n\n\n\\(V\\) denotes Cramér’s V\n\n\\(\\chi^2\\) is the Pearson chi-square statistic from the aforementioned test;\n\n\\(n\\) is the sample size involved in the test and\n\n\\(k\\) is the lesser number of categories of either variable"
  },
  {
    "objectID": "practice/slides_lab03.html#computing-cramers-v-after-test-of-independence-2-ways",
    "href": "practice/slides_lab03.html#computing-cramers-v-after-test-of-independence-2-ways",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Computing Cramer’s V after test of independence (2 ways)",
    "text": "Computing Cramer’s V after test of independence (2 ways)\n\n✍🏻 By hand” first to see the steps\n\n\n# Compute Creamer's V\n \n# inputs \nchi_calc &lt;- test_chi$statistic\nn &lt;- nrow(famuss) # N of obd \nn_r &lt;- nrow(test_chi$observed) # number of rows in the contingency table\nn_c &lt;- ncol(test_chi$observed) # number of columns in the contingency table\n\n# Cramer’s V\nsqrt(chi_calc / (n*min(n_r -1, n_c -1)) )\n\nX-squared \n0.1276816 \n\n\n\n👩🏻‍💻 using an R function rstatix::cramer_v\n\n\n\n# Cramer’s V \nrstatix::cramer_v(test_chi$observed)\n\n[1] 0.1276816\n\n\nA Cramer’s V of 0.12 indicates a relatively weak association between the two categorical variables. It suggests that while there may be some relationship between the variables, it is not particularly strong"
  },
  {
    "objectID": "practice/slides_lab03.html#chi-squared-test-of-goodness-of-fit",
    "href": "practice/slides_lab03.html#chi-squared-test-of-goodness-of-fit",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Chi Squared test of goodness of fit\n",
    "text": "Chi Squared test of goodness of fit\n\nIn this case, we are conducting a type of Pearson’s Chi-square test\n\nused to test whether the observed distribution of a categorical variable differs from your expectations\nthe statistic is based on the discrepancies between observed and expected counts"
  },
  {
    "objectID": "practice/slides_lab03.html#chi-squared-test-of-goodness-of-fit-example",
    "href": "practice/slides_lab03.html#chi-squared-test-of-goodness-of-fit-example",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Chi Squared test of goodness of fit (example)",
    "text": "Chi Squared test of goodness of fit (example)\nSince the participants of the FAMuSS study where volunteers at a university, they did not come from a “representative” sample of the US population\n\nThe \\(\\chi^{2}\\) test can be used to test the \\(H_{0}\\) that the participants are racially representative of the general population\n\n\n\n\n\n\n\nRace\nAfrican.American\nAsian\nCaucasian\nOther\nTotal\n\n\n\nFAMuSS (Observed) \n27\n55\n467\n46\n595\n\n\nUS Census (Expected) \n76.16\n5.95\n478.38\n34.51\n595\n\n\n\n\n\n\nWe use the formula \\(\\chi^{2} = \\sum_{k}\\frac{(Observed - Expected)^{2}}{Expected}\\),\nunder \\(H_{0}\\) = the sample proportions should equal the population proportions."
  },
  {
    "objectID": "practice/slides_lab03.html#chi-squared-test-of-goodness-of-fit-example-1",
    "href": "practice/slides_lab03.html#chi-squared-test-of-goodness-of-fit-example-1",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Chi Squared test of goodness of fit (example)",
    "text": "Chi Squared test of goodness of fit (example)\n\n# Subset the vectors of frequencies from the 2 rows  \nobserved &lt;- c(27,  55,  467, 46)\nexpected &lt;- c(76.2,  5.95, 478.38,  34.51)\n\n# Calculate Chi-Square statistic manually \nchi_sq_statistic &lt;- sum((observed - expected)^2 / expected) \ndf &lt;- length(observed) - 1 \np_value &lt;- 1 - pchisq(chi_sq_statistic, df) \n\n# Print results \nchi_sq_statistic\n\n[1] 440.2166\n\ndf\n\n[1] 3\n\np_value \n\n[1] 0\n\n\nThe calculated \\(\\chi^{2}\\) statistic is very large, and the p_value is close to 0. Hence, There is more than sufficient evidence to reject the null hypothesis that the sample is representative of the general population.\nA comparison of the observed and expected values (or the residuals) indicates that the largest discrepancy is with the over-representation of Asian participants."
  },
  {
    "objectID": "practice/slides_lab03.html#splitting-the-sample",
    "href": "practice/slides_lab03.html#splitting-the-sample",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Splitting the sample",
    "text": "Splitting the sample\nIf we seek any causal relationship between an explanatory and outcome variable we should split our sample to have:\n\none sample to “train” a model on\none sample to “test” the model on\n\n\nOtherwise out model will seem better than it is (since it will be specifically built to “fit” our data)\nThe function rsample::initial_split will assist in that\n\n\nnhanes_split &lt;- rsample::initial_split(nhanes)\n# default = 75%  of observations \nnhanes_train &lt;- rsample::training(nhanes_split)\n# default = 25%  of observations \nnhanes_test &lt;- rsample::testing(nhanes_split)"
  },
  {
    "objectID": "practice/slides_lab03.html#visualize-the-data",
    "href": "practice/slides_lab03.html#visualize-the-data",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Visualize the data",
    "text": "Visualize the data\nWe are mainly looking for a “vaguely” linear shape here\n\n\nggplot2 gives us a visual confirmation via linear best fit (the least squares regression line), using method = lm, & its 95% CI\n\n\nggplot(nhanes_train, aes (x = age, \n                          y = bmi)) + \n  geom_point() + \n  geom_smooth(method = lm,  \n              #se = FALSE\n              )"
  },
  {
    "objectID": "practice/slides_lab03.html#visualize-the-data-output",
    "href": "practice/slides_lab03.html#visualize-the-data-output",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Visualize the data",
    "text": "Visualize the data"
  },
  {
    "objectID": "practice/slides_lab03.html#linear-regression-models",
    "href": "practice/slides_lab03.html#linear-regression-models",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Linear regression models",
    "text": "Linear regression models\nThe lm() function is used to fit linear models has the following generic structure:\n\nlm(y ~ x, data)\n\nwhere:\n\nthe 1st argument y ~ x specifies the variables used in the model (here the model regresses a response variable \\(y\\) against an explanatory variable \\(x\\).\nThe 2nd argument data is used only when the dataframe name is not already specified in the first argument."
  },
  {
    "objectID": "practice/slides_lab03.html#linear-regression-models-syntax",
    "href": "practice/slides_lab03.html#linear-regression-models-syntax",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Linear regression models syntax",
    "text": "Linear regression models syntax\nThe following example shows fitting a linear model that predicts BMI from age (in years) using data from nhanes_train adult sample (individuals 21 years of age or older from the NHANES data).\n\n#fitting linear model\nlm(nhanes_train$bmi ~ nhanes_train$age)\n\n\n#equivalently...\nlm(bmi ~ age, data = nhanes_train)\n\n\nCall:\nlm(formula = bmi ~ age, data = nhanes_train)\n\nCoefficients:\n(Intercept)          age  \n   28.64243      0.01265  \n\n\n\nRunning the function creates an object (of class lm) that contains several components (model coefficients, etc), either directly displayed or accessible with summary() notation or specific functions."
  },
  {
    "objectID": "practice/slides_lab03.html#linear-regression-models-syntax-1",
    "href": "practice/slides_lab03.html#linear-regression-models-syntax-1",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Linear regression models syntax",
    "text": "Linear regression models syntax\n\nWe can save the model and then extract individual output elements from it using the $ syntax\n\n# name the model object\nmodel &lt;- lm(bmi ~ age, data = nhanes_train)\n\n# extract model output elements\nmodel$coefficients\nmodel$residuals\nmodel$fitted.values\n\nThe command summary returns these elements\n\n\nCall: reminding the equation used\n\nResiduals: a 5 number summary of the Residuals\n\nCoefficients: estimates, and hypothesis testing\n\nintercept\nexplanatory variable slope"
  },
  {
    "objectID": "practice/slides_lab03.html#linear-regression-models-interpretation-coefficients",
    "href": "practice/slides_lab03.html#linear-regression-models-interpretation-coefficients",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Linear regression models interpretation: coefficients",
    "text": "Linear regression models interpretation: coefficients\n\nThe model tests the null hypothesis that a coefficient is 0\n\nCoefficients: estimates, std. error of these estimates, t value and p-value\n\nintercept\nexplanatory variable slope\n\n\nIn regression, the population parameter of interest is typically the slope parameter\n\nhere age doesn’t appear significantly ≠ 0\n\n\n\n\nsummary(model)"
  },
  {
    "objectID": "practice/slides_lab03.html#linear-regression-models-interpretation-coefficients-output",
    "href": "practice/slides_lab03.html#linear-regression-models-interpretation-coefficients-output",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Linear regression models interpretation: coefficients",
    "text": "Linear regression models interpretation: coefficients\n\n\nCall:\nlm(formula = bmi ~ age, data = nhanes_train)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-11.186  -4.871  -1.250   3.812  39.570 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 28.64243    1.12495  25.461   &lt;2e-16 ***\nage          0.01265    0.02133   0.593    0.554    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.795 on 370 degrees of freedom\n  (3 observations deleted due to missingness)\nMultiple R-squared:  0.0009493, Adjusted R-squared:  -0.001751 \nF-statistic: 0.3516 on 1 and 370 DF,  p-value: 0.5536"
  },
  {
    "objectID": "practice/slides_lab03.html#linear-regression-models-outputs-fitted-values",
    "href": "practice/slides_lab03.html#linear-regression-models-outputs-fitted-values",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Linear regression models outputs: fitted values",
    "text": "Linear regression models outputs: fitted values\n\nmodel$fitted.values\n\n       1        2        3        4        5        6        7        8 \n29.43938 29.22433 29.03458 29.31288 29.50263 29.18638 29.30023 29.31288 \n       9       10       11       12       13       14       15       16 \n29.45203 29.23698 29.65443 29.55323 28.93338 29.27493 29.48998 29.27493 \n      17       18       19       20       21       22       23       24 \n29.22433 29.07253 29.08518 29.52793 29.21168 29.13578 28.97133 29.05988 \n      25       26       27       28       30       31       32       33 \n29.42673 29.02193 29.65443 28.93338 29.27493 29.11048 29.35083 29.46468 \n      34       35       36       37       38       39       40       41 \n29.37613 29.13578 29.11048 29.00928 29.07253 29.22433 29.37613 29.59118 \n      42       43       44       45       46       47       48       49 \n29.45203 29.42673 29.31288 29.13578 28.90808 29.36348 29.52793 29.37613 \n      50       51       52       53       54       55       56       57 \n29.00928 29.09783 29.07253 29.33818 29.27493 29.00928 29.21168 29.32553 \n      58       59       60       61       62       63       64       65 \n29.52793 29.19903 28.94603 29.12313 29.05988 29.45203 29.24963 29.52793 \n      66       67       68       69       70       71       72       73 \n29.32553 29.47733 29.31288 29.24963 29.26228 28.93338 29.47733 29.37613 \n      74       75       76       77       78       79       80       81 \n29.11048 29.23698 29.35083 29.54058 29.38878 29.14843 29.65443 29.28758 \n      82       83       84       85       86       87       88       89 \n29.04723 29.36348 29.52793 28.97133 29.22433 29.40143 29.24963 29.17373 \n      90       91       92       93       94       95       96       98 \n29.54058 29.19903 29.14843 29.23698 29.35083 28.90808 29.65443 29.23698 \n      99      100      102      103      104      105      106      107 \n29.13578 29.33818 29.65443 29.55323 29.47733 29.21168 28.95868 29.12313 \n     108      109      110      111      112      113      114      115 \n29.42673 29.28758 28.90808 29.32553 28.95868 28.99663 29.23698 28.94603 \n     116      117      118      119      120      121      122      123 \n28.92073 29.65443 29.14843 29.35083 29.21168 29.41408 29.56588 29.14843 \n     124      125      126      127      128      129      130      131 \n28.97133 28.90808 29.04723 28.90808 28.97133 29.55323 28.97133 29.51528 \n     132      133      134      135      136      137      138      139 \n28.99663 28.98398 29.36348 29.14843 29.36348 29.32553 29.08518 29.21168 \n     140      141      142      143      144      145      146      147 \n28.90808 29.30023 29.31288 29.65443 29.54058 28.90808 29.56588 29.23698 \n     148      149      150      151      152      153      154      155 \n29.57853 29.09783 29.04723 29.54058 29.54058 29.05988 29.36348 29.02193 \n     156      157      158      159      160      161      162      163 \n29.11048 29.00928 29.16108 28.98398 29.19903 29.50263 29.24963 29.43938 \n     164      165      166      167      168      169      170      171 \n29.40143 29.04723 28.98398 28.95868 29.65443 28.97133 29.42673 29.35083 \n     172      173      174      175      176      177      178      179 \n29.60383 29.02193 29.00928 29.47733 29.65443 29.57853 29.35083 29.60383 \n     180      181      182      183      184      185      186      187 \n29.17373 29.04723 29.26228 29.60383 29.33818 29.24963 29.65443 29.27493 \n     188      189      190      191      192      193      194      195 \n29.30023 29.32553 28.93338 29.46468 29.30023 29.24963 29.19903 29.00928 \n     196      197      198      199      200      201      202      203 \n29.57853 28.90808 29.45203 29.03458 29.18638 29.52793 29.24963 29.18638 \n     204      205      206      207      208      209      210      211 \n29.24963 29.64178 29.45203 29.57853 29.05988 28.99663 29.41408 29.31288 \n     212      213      214      215      216      217      218      219 \n29.64178 29.19903 28.94603 29.56588 29.65443 29.31288 29.11048 29.41408 \n     220      221      222      223      224      225      226      227 \n29.22433 29.47733 29.60383 29.31288 29.19903 29.52793 29.22433 29.13578 \n     228      229      230      231      232      233      234      235 \n29.32553 29.16108 29.40143 29.23698 29.46468 29.31288 29.12313 29.41408 \n     236      237      238      239      240      241      242      243 \n29.45203 28.99663 29.36348 29.27493 29.26228 29.45203 29.37613 29.36348 \n     244      245      246      247      248      249      250      251 \n29.60383 29.14843 29.43938 29.60383 29.54058 29.36348 29.33818 29.09783 \n     252      253      254      255      256      257      258      259 \n29.16108 29.36348 29.21168 29.37613 29.08518 29.32553 29.42673 29.61648 \n     260      261      262      263      264      265      266      267 \n29.27493 29.17373 29.55323 29.50263 29.46468 29.32553 29.24963 29.65443 \n     268      269      270      271      272      273      274      275 \n28.92073 29.50263 29.13578 29.18638 29.45203 29.05988 29.24963 29.33818 \n     276      277      278      279      280      281      282      283 \n29.03458 29.23698 29.24963 29.65443 29.50263 29.23698 29.02193 29.30023 \n     284      285      286      287      288      289      290      291 \n28.97133 29.38878 29.35083 29.60383 29.36348 29.54058 29.07253 29.22433 \n     292      293      294      295      296      297      298      299 \n29.59118 28.94603 28.98398 29.07253 29.02193 29.27493 29.23698 29.57853 \n     300      301      302      303      304      305      306      307 \n29.45203 29.35083 29.32553 29.21168 29.54058 29.52793 29.14843 29.30023 \n     308      309      310      311      312      313      314      315 \n29.12313 29.46468 29.19903 29.04723 29.13578 29.00928 29.50263 28.93338 \n     316      317      318      319      320      321      322      323 \n29.09783 29.27493 29.30023 29.48998 29.16108 29.24963 29.11048 29.33818 \n     324      325      326      327      328      329      330      331 \n29.11048 29.28758 29.03458 29.04723 29.62913 29.42673 29.55323 29.13578 \n     332      333      334      335      336      337      338      339 \n29.48998 28.97133 29.23698 29.04723 29.46468 29.11048 29.40143 29.31288 \n     340      341      342      343      344      345      346      347 \n29.40143 29.35083 29.56588 29.08518 28.97133 29.13578 29.18638 29.41408 \n     348      349      350      351      352      353      354      355 \n29.12313 29.37613 29.45203 29.30023 29.65443 29.46468 29.03458 29.48998 \n     356      357      358      359      360      361      362      363 \n28.94603 29.36348 29.27493 29.30023 28.92073 28.90808 29.57853 28.99663 \n     364      365      366      367      368      369      370      371 \n29.60383 29.65443 29.55323 28.95868 29.28758 29.12313 29.35083 28.90808 \n     372      373      374      375 \n28.92073 29.26228 29.36348 29.24963"
  },
  {
    "objectID": "practice/slides_lab03.html#linear-regression-models-outputs-residuals",
    "href": "practice/slides_lab03.html#linear-regression-models-outputs-residuals",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Linear regression models outputs: residuals",
    "text": "Linear regression models outputs: residuals\n\nmodel$residuals \n\n            1             2             3             4             5 \n 3.760623e+00 -2.224328e+00 -2.184579e+00 -3.012878e+00  3.097373e+00 \n            6             7             8             9            10 \n 1.813622e+00 -3.800228e+00  3.727122e+00 -1.272027e+00  7.563022e+00 \n           11            12            13            14            15 \n 6.557385e-02 -2.532266e-01 -1.023338e+01 -7.274928e+00 -5.009977e+00 \n           16            17            18            19            20 \n 1.332507e+01 -1.724328e+00 -5.372529e+00 -8.885179e+00  6.572073e+00 \n           21            22            23            24            25 \n-1.070168e+01 -2.425778e+00  2.928671e+00 -5.479879e+00  9.193273e+00 \n           26            27            28            30            31 \n 6.318071e+00  2.145574e+00 -6.933793e-01 -3.874928e+00  7.895214e-01 \n           32            33            34            35            36 \n-4.850827e+00 -2.014677e+00  9.033873e+00 -7.325778e+00 -2.550479e+00 \n           37            38            39            40            41 \n-8.669279e+00  7.127471e+00  3.475672e+00  3.123873e+00 -4.181176e+00 \n           42            43            44            45            46 \n-5.252027e+00  4.273273e+00  2.987122e+00  3.514222e+00 -8.208079e+00 \n           47            48            49            50            51 \n-2.334774e-01  7.072073e+00  3.523873e+00 -2.889279e+00  2.802171e+00 \n           52            53            54            55            56 \n-8.472529e+00 -3.338178e+00 -1.374928e+00 -4.999279e+00  8.588322e+00 \n           57            58            59            60            61 \n 1.574472e+00 -9.279267e-01  7.180972e+00 -4.646029e+00  7.856872e+00 \n           62            63            64            65            66 \n-1.239879e+00 -3.052027e+00  6.180372e+00 -5.327927e+00 -6.415528e+00 \n           67            68            69            70            71 \n-8.157327e+00  4.787122e+00 -2.069628e+00 -3.622779e-01 -7.653379e+00 \n           72            73            74            75            76 \n-3.077327e+00 -3.276127e+00 -7.150479e+00  5.093022e+00 -2.050827e+00 \n           77            78            79            80            81 \n 1.459942e+01 -7.288777e+00  8.641572e+00 -4.904426e+00 -8.047578e+00 \n           82            83            84            85            86 \n-8.747229e+00  1.906523e+00  4.722073e+00  2.528671e+00  2.756719e-01 \n           87            88            89            90            91 \n-3.142727e-02  9.250372e+00 -2.663728e+00 -3.000577e+00  1.520972e+00 \n           92            93            94            95            96 \n-3.748428e+00  1.663022e+00 -5.630827e+00 -6.048079e+00 -2.844262e-01 \n           98            99           100           102           103 \n 1.630220e-01  4.164222e+00 -6.248178e+00 -5.274426e+00 -3.823227e+00 \n          104           105           106           107           108 \n 5.812673e+00 -7.221678e+00  3.141321e+00 -1.843128e+00 -3.666727e+00 \n          109           110           111           112           113 \n-9.087578e+00 -6.080794e-01  1.837447e+01 -3.458679e+00  4.033709e-01 \n          114           115           116           117           118 \n 1.863022e+00  1.992397e+01  8.189271e+00  1.135574e+00 -1.584284e-01 \n          119           120           121           122           123 \n 1.539173e+00  8.588322e+00 -1.714077e+00 -1.765877e+00 -4.238428e+00 \n          124           125           126           127           128 \n 3.528671e+00 -5.808079e+00 -5.747229e+00 -9.738079e+00 -6.161329e+00 \n          129           130           131           132           133 \n-2.873227e+00  6.268671e+00 -3.895277e+00  6.983371e+00  1.541602e+01 \n          134           135           136           137           138 \n 4.126523e+00  4.051572e+00  3.665226e-01 -1.125528e+00 -2.125179e+00 \n          139           140           141           142           143 \n 4.188322e+00 -7.218079e+00  8.997723e-01 -8.382878e+00 -2.804426e+00 \n          144           145           146           147           148 \n 5.394233e-01  4.331921e+00 -7.365877e+00 -6.926978e+00  1.214735e-01 \n          149           150           151           152           153 \n-6.897829e+00  6.527712e-01  1.594233e-01  5.589423e+00 -1.259879e+00 \n          154           155           156           157           158 \n-9.943477e+00  1.111807e+01 -1.610479e+00 -5.109279e+00 -6.871078e+00 \n          159           160           161           162           163 \n-4.423979e+00  7.800972e+00 -4.302627e+00 -4.349628e+00 -3.169377e+00 \n          164           165           166           167           168 \n-6.521427e+00 -4.617229e+00  5.086021e+00 -7.758679e+00 -9.844262e-01 \n          169           170           171           172           173 \n-2.871329e+00 -8.666727e+00 -9.800827e+00  4.961736e-01  7.598071e+00 \n          174           175           176           177           178 \n 5.690721e+00  3.852673e+00  1.045574e+00 -4.378526e+00  6.949173e+00 \n          179           180           181           182           183 \n-8.193826e+00  3.326272e+00  2.427712e-01 -8.262278e+00  9.961736e-01 \n          184           185           186           187           188 \n-2.381775e-01 -2.149628e+00 -2.054426e+00 -1.874928e+00  9.539772e+00 \n          189           190           191           192           193 \n 1.037447e+01  1.776662e+01 -5.044677e+00 -2.250228e+00 -9.019628e+00 \n          194           195           196           197           198 \n 9.718385e-04 -3.909279e+00 -6.748526e+00 -2.698079e+00 -1.520270e-01 \n          199           200           201           202           203 \n-9.034579e+00 -6.396378e+00  1.154207e+01  5.950372e+00  5.436218e-01 \n          204           205           206           207           208 \n 1.043037e+01 -6.981776e+00  1.987973e+00  1.039147e+01  3.957012e+01 \n          209           210           211           212           213 \n 4.403371e+00  9.295923e+00  1.217712e+01 -6.451776e+00 -1.899028e+00 \n          214           215           216           217           218 \n-5.526029e+00  2.534123e+00  4.865574e+00 -3.012878e+00 -5.570479e+00 \n          219           220           221           222           223 \n 9.592279e-02 -3.874328e+00 -4.807327e+00 -2.803826e+00  4.887122e+00 \n          224           225           226           227           228 \n 5.970972e+00  9.872073e+00  5.175672e+00 -1.052578e+01  4.474472e+00 \n          229           230           231           232           233 \n-6.871078e+00 -5.814273e-01 -4.369780e-01 -3.864677e+00  2.451712e+01 \n          234           235           236           237           238 \n 2.776872e+00  2.285923e+00 -2.852027e+00 -9.866291e-01  5.236523e+00 \n          239           240           241           242           243 \n-5.694928e+00 -7.122278e+00 -6.152027e+00 -1.118613e+01 -3.763477e+00 \n          244           245           246           247           248 \n 1.761736e-01 -9.548428e+00 -5.739377e+00  1.379617e+01  1.959423e+00 \n          249           250           251           252           253 \n-6.163477e+00  6.061822e+00  1.902171e+00 -9.610783e-01 -6.363477e+00 \n          254           255           256           257           258 \n-3.111678e+00 -1.516127e+00  5.482134e-02 -8.295528e+00  1.632728e-01 \n          259           260           261           262           263 \n 5.883524e+00 -7.274928e+00  3.326272e+00  3.467734e-01 -3.602627e+00 \n          264           265           266           267           268 \n 2.645323e+00 -1.125528e+00 -5.649628e+00 -6.054426e+00 -4.700729e+00 \n          269           270           271           272           273 \n 1.176737e+01  4.284222e+00 -9.786378e+00 -4.522027e+00 -1.459879e+00 \n          274           275           276           277           278 \n-1.449628e+00 -2.338178e+00 -3.274579e+00 -3.436978e+00 -3.599628e+00 \n          279           280           281           282           283 \n-4.854426e+00 -2.302627e+00  9.323022e+00 -1.521929e+00  4.499772e+00 \n          284           285           286           287           288 \n-8.371329e+00  4.581223e+00 -9.810827e+00  2.336174e+00 -3.263477e+00 \n          289           290           291           292           293 \n-1.950577e+00  1.160747e+01 -3.374328e+00 -1.991176e+00 -1.114603e+01 \n          294           295           296           297           298 \n-2.383979e+00 -6.072529e+00 -8.551929e+00  7.315072e+00  1.080302e+01 \n          299           300           301           302           303 \n-7.285265e-01  5.997973e+00 -6.150827e+00 -8.625528e+00 -3.521678e+00 \n          304           305           306           307           308 \n 1.865942e+01 -3.747927e+00 -8.248428e+00 -1.900228e+00 -2.312850e-02 \n          309           310           311           312           313 \n-7.984677e+00  1.148097e+01 -6.277229e+00 -2.995778e+00 -2.509279e+00 \n          314           315           316           317           318 \n 3.117373e+00 -4.933379e+00 -9.978286e-01  2.535072e+00  5.497723e-01 \n          319           320           321           322           323 \n 1.278002e+01 -1.411078e+00 -6.409628e+00  4.799521e+00 -6.318178e+00 \n          324           325           326           327           328 \n 3.479952e+01  2.512422e+00  1.256542e+01  6.352771e+00 -5.029126e+00 \n          329           330           331           332           333 \n 4.273273e+00  1.044677e+01  6.964222e+00  2.860023e+00  3.028671e+00 \n          334           335           336           337           338 \n-7.696978e+00 -2.472288e-01 -1.464677e+00  1.098952e+01 -9.014273e-01 \n          339           340           341           342           343 \n 1.168712e+01  3.798573e+00  4.749173e+00 -3.395877e+00  3.664821e+00 \n          344           345           346           347           348 \n-2.711329e+00  5.094222e+00 -6.566378e+00  1.188592e+01  8.516872e+00 \n          349           350           351           352           353 \n-4.866127e+00 -1.952027e+00 -8.070228e+00 -1.024426e+00 -3.024677e+00 \n          354           355           356           357           358 \n 2.675421e+00  2.000231e-01  1.045397e+01 -2.863477e+00  9.650722e-01 \n          359           360           361           362           363 \n 7.499772e+00 -6.120729e+00 -2.080794e-01 -3.398526e+00 -6.696629e+00 \n          364           365           366           367           368 \n-9.333826e+00  4.225574e+00 -2.873227e+00  1.185132e+01 -4.887578e+00 \n          369           370           371           372           373 \n 2.576872e+00  8.849173e+00 -6.508079e+00 -1.660729e+00  3.127722e+00 \n          374           375 \n-7.863477e+00  8.750372e+00"
  },
  {
    "objectID": "practice/slides_lab03.html#linear-regression-diagnostic-plots-residuals-v.-fitted-values-14",
    "href": "practice/slides_lab03.html#linear-regression-diagnostic-plots-residuals-v.-fitted-values-14",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Linear regression diagnostic plots: residuals v. fitted values 1/4",
    "text": "Linear regression diagnostic plots: residuals v. fitted values 1/4\n\nASSUMPTION 1: there exists a linear relationship between the independent variable, x, and the dependent variable, y\n\nFor an observation \\((x_i, y_i)\\), where \\(\\hat{y}_i\\) is the predicted value according to the line \\(\\hat{y} = b_0 + b_1x\\), the residual is the value \\(e_i = y_i - \\hat{y}_i\\)\n\nA linear model is a particularly good fit for the data when the residual plot shows random scatter above and below the horizontal line.\n\n(In this R plot, we look for a red line that is fairly straight)\n\n\n\n\n# residual plot\nplot(model, which = 1 )"
  },
  {
    "objectID": "practice/slides_lab03.html#linear-regression-diagnostic-plots-residuals-v.-fitted-values-14-output",
    "href": "practice/slides_lab03.html#linear-regression-diagnostic-plots-residuals-v.-fitted-values-14-output",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Linear regression diagnostic plots: residuals v. fitted values 1/4",
    "text": "Linear regression diagnostic plots: residuals v. fitted values 1/4"
  },
  {
    "objectID": "practice/slides_lab03.html#linear-regression-diagnostic-plots-normality-of-residuals-24",
    "href": "practice/slides_lab03.html#linear-regression-diagnostic-plots-normality-of-residuals-24",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Linear regression diagnostic plots: normality of residuals 2/4",
    "text": "Linear regression diagnostic plots: normality of residuals 2/4\n\nASSUMPTION 2: The residuals of the model are normally distributed\n\nWith the quantile-quantile plot (Q_Q) we can checking normality of the residuals.\n\n# quantile-quantile plot\nplot(model, which = 2 )"
  },
  {
    "objectID": "practice/slides_lab03.html#linear-regression-diagnostic-plots-normality-of-residuals-24-output",
    "href": "practice/slides_lab03.html#linear-regression-diagnostic-plots-normality-of-residuals-24-output",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Linear regression diagnostic plots: normality of residuals 2/4",
    "text": "Linear regression diagnostic plots: normality of residuals 2/4\n\n\nThe data appear roughly normal, but there are deviations from normality in the tails, particularly the upper tail."
  },
  {
    "objectID": "practice/slides_lab03.html#linear-regression-diagnostic-plots-homoscedasticity-34",
    "href": "practice/slides_lab03.html#linear-regression-diagnostic-plots-homoscedasticity-34",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Linear regression diagnostic plots: Homoscedasticity 3/4",
    "text": "Linear regression diagnostic plots: Homoscedasticity 3/4\n\nASSUMPTION 3: The residuals have constant variance at every level of x (“homoscedasticity”)\n\nThis one is called a Spread-location plot: shows if residuals are spread equally along the ranges of predictors\n\n# Spread-location plot\nplot(model, which = 3 )"
  },
  {
    "objectID": "practice/slides_lab03.html#linear-regression-diagnostic-plots-homoscedasticity-34-output",
    "href": "practice/slides_lab03.html#linear-regression-diagnostic-plots-homoscedasticity-34-output",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Linear regression diagnostic plots: Homoscedasticity 3/4",
    "text": "Linear regression diagnostic plots: Homoscedasticity 3/4"
  },
  {
    "objectID": "practice/slides_lab03.html#linear-regression-diagnostic-plots-leverage-44",
    "href": "practice/slides_lab03.html#linear-regression-diagnostic-plots-leverage-44",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Linear regression diagnostic plots: leverage 4/4",
    "text": "Linear regression diagnostic plots: leverage 4/4\nThis last diagnostic plot is actually not referred to any assumptions but has to do with outliers:\n\na residuals vs. leverage plot allows us to identify influential observations in a regression model\n\nThe x-axis shows the “leverage” of each point and the y-axis shows the “standardized residual of each point”, i.e. “How much would the coefficients in the regression model would change if a particular observation was removed from the dataset?”\nCook’s distance lines (red dashed lines) – not visible here – appear on the corners of the plot when there are influential cases\n\n\n\n\nplot(model, which = 5 )\n\n\n\n\n\nR 4 Biostatistics | MITGEST::training(2024)"
  },
  {
    "objectID": "practice/slides_lab03.html#linear-regression-diagnostic-plots-leverage-44-output",
    "href": "practice/slides_lab03.html#linear-regression-diagnostic-plots-leverage-44-output",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Linear regression diagnostic plots: leverage 4/4",
    "text": "Linear regression diagnostic plots: leverage 4/4\n\n\nIn this particular case, there is no influential case, or cases"
  },
  {
    "objectID": "practice/slides_lab01.html#goal-of-todays-practice-session",
    "href": "practice/slides_lab01.html#goal-of-todays-practice-session",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "GOAL OF TODAY’S PRACTICE SESSION",
    "text": "GOAL OF TODAY’S PRACTICE SESSION\n\nMotivate the choice of learning/using R for scientific quantitative analysis, and lay out some fundamental concepts in biostatistics with concrete R coding examples.\n\n\n\nLecture 1: topics\n\n\nIntroduction to R and R-studio\n\nWhy R?\nPrinciples of reproducible analysis with R + RStudio\n\n\nR objects, functions, packages\n\nUnderstanding different types of variables\n\nPrinciples of “tidy data”\n\n\n\nDescriptive statistics\n\nMeasures of central tendency, measures of variability (or spread), and frequency distribution\n\n\n\nVisual data exploration\n\n{ggplot2}"
  },
  {
    "objectID": "practice/slides_lab01.html#r-version",
    "href": "practice/slides_lab01.html#r-version",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "R version",
    "text": "R version\nIf you have previously installed R on your machine, you can check which version you are running by executing this command in R:\n\n# check your R version\nR.Version()\n\n$platform\n[1] \"x86_64-apple-darwin17.0\"\n\n$arch\n[1] \"x86_64\"\n\n$os\n[1] \"darwin17.0\"\n\n$system\n[1] \"x86_64, darwin17.0\"\n\n$status\n[1] \"\"\n\n$major\n[1] \"4\"\n\n$minor\n[1] \"2.2\"\n\n$year\n[1] \"2022\"\n\n$month\n[1] \"10\"\n\n$day\n[1] \"31\"\n\n$`svn rev`\n[1] \"83211\"\n\n$language\n[1] \"R\"\n\n$version.string\n[1] \"R version 4.2.2 (2022-10-31)\"\n\n$nickname\n[1] \"Innocent and Trusting\"\n\n# or just\n#R.version.string"
  },
  {
    "objectID": "practice/slides_lab01.html#install",
    "href": "practice/slides_lab01.html#install",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Install \n",
    "text": "Install \n\n\n\n\nR is available for free for Windows , GNU/Linux , and macOS .\n\nTo install R, go to this link https://cloud.r-project.org/. The latest available release is R 4.3.3 “Angel Food Cake” released on 2024-02/29, but any (fairly recent) version will do."
  },
  {
    "objectID": "practice/slides_lab01.html#install-rstudio-ide",
    "href": "practice/slides_lab01.html#install-rstudio-ide",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Install RStudio IDE",
    "text": "Install RStudio IDE\nRStudio Desktop is an Integrated Development Editor (IDE), basically a graphical interface wrapping and interfacing R (which needs to be installed first).\nBesides RStudio, R (which is a command line driven program) can be executed:\n\nvia its native interface (R GUI)\nfrom many other code editors, like VS Code, Sublime Text, Jupyter Notebook\n\n\n\nTo install RStudio, go to this link https://posit.co/download/rstudio-desktop/. The free-version contains everything you need."
  },
  {
    "objectID": "practice/slides_lab01.html#use-rstudio-ide",
    "href": "practice/slides_lab01.html#use-rstudio-ide",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Use RStudio IDE",
    "text": "Use RStudio IDE\n\nRStudio Pane Layout Source: Posit’s RStudio User Guide"
  },
  {
    "objectID": "practice/slides_lab01.html#creating-an-r-project-in-rstudio",
    "href": "practice/slides_lab01.html#creating-an-r-project-in-rstudio",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Creating an R Project [in Rstudio]",
    "text": "Creating an R Project [in Rstudio]\nAn R Project will keep all the files associated with a project (including invisible ones!) organized together – input data, R scripts, analytical results, figures. Besides being common practice, this has the advantage of implicitly setting the “working directory”, which is incredibly important when you need to load or output files, specifying their file path.\nIn Figure 1 you can see how easy it is just following RStudio prompts:\n\nCreate a new directory for each project\nSelect parent folder"
  },
  {
    "objectID": "practice/slides_lab01.html#creating-an-r-project-in-rstudio-cont.",
    "href": "practice/slides_lab01.html#creating-an-r-project-in-rstudio-cont.",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Creating an R Project [in Rstudio] (cont.)",
    "text": "Creating an R Project [in Rstudio] (cont.)\n\n\nFigure 1: Creating an R project\nNotice that, now, in the Files tab you see file with the extension .Rproj which is telling R that all folder’s files belong together."
  },
  {
    "objectID": "practice/slides_lab01.html#install-r-packages-from-cran-stable-version",
    "href": "practice/slides_lab01.html#install-r-packages-from-cran-stable-version",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Install R packages from CRAN (stable version)",
    "text": "Install R packages from CRAN (stable version)\nAn R package*  is a shareable bundle of functions. Besides the basic built-in functions already contained in the program (i.e. the base package), many useful R functions come in free libraries of code (or packages) written by R’s users. You can find them in different repositories:\nTo install a package use utils function install.packages(\"package_name)\n\n# Installing (ONLY the 1st time)\nutils::install.packages('here')\n\n# OR (same)\ninstall.packages('here')\n\n\n\nHere you are actually using a function (install.packages) of a pre-installed package (utils) using the syntax packagename::function_name. This prevents any ambiguity in case of duplicate function name… also helps you see what you are using."
  },
  {
    "objectID": "practice/slides_lab01.html#install-r-packages-rstudio-pane",
    "href": "practice/slides_lab01.html#install-r-packages-rstudio-pane",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Install R packages RStudio pane",
    "text": "Install R packages RStudio pane\nIn alternative, you can install/update packages using the Packages tab on the lower right pane of RStudio.\n\nScreenshot Install/Update pckgs from RStudio"
  },
  {
    "objectID": "practice/slides_lab01.html#install-r-packages-from-github-testing-version",
    "href": "practice/slides_lab01.html#install-r-packages-from-github-testing-version",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Install R packages from GitHub (testing version)",
    "text": "Install R packages from GitHub (testing version)\nUse install_github from the package devtools.EXAMPLE: let’s install a little package paint (which colors the structure of dataset when printing).\n\n\n\nCode\n\n# Installing devtools (ONLY the 1st time)\nutils::install.packages('devtools')\n\n# Installing paint from GitHub \nlibrary(devtools)\ndevtools::install_github(\"MilesMcBain/paint\")\n\n# test paint out\nlibrary(paint)\n\n\nOutput {paint} function\n\n# Structure of a data.frame \npaint::paint(mtcars)\n\n\n\n\n\n[After devtools::install_github(\"MilesMcBain/paint\"), R asks me if I want to update related packages…]"
  },
  {
    "objectID": "practice/slides_lab01.html#use-r-packages",
    "href": "practice/slides_lab01.html#use-r-packages",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Use R Packages",
    "text": "Use R Packages\n\nWe will be using {base} & {utils} (pre-installed and pre-loaded)\nWe will also use the packages below (specifying package::function for clarity).\n\n\n# Load them for this R session\nlibrary(here)      # tools find your project's files, based on working directory\nlibrary(janitor)   # tools for examining and cleaning data\nlibrary(skimr)     # tools for summary statistics \nlibrary(dplyr)     # {tidyverse} tools for manipulating and summarising tidy data \nlibrary(ggplot2)   # {tidyverse} tools for plotting\nlibrary(forcats)   # {tidyverse} tool for handling factors\nlibrary(ggridges)  # alternative to plot density functions \nlibrary(fs)        # file/directory interactions"
  },
  {
    "objectID": "practice/slides_lab01.html#help-on-r-packagefunction",
    "href": "practice/slides_lab01.html#help-on-r-packagefunction",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Help on R package/function",
    "text": "Help on R package/function\nTo inquire about a package and/or its functions, you can again write in your console ?package_name or ??package_name and RStudio will open up the Help tab in the lower right pane.\n\n# Opening Help page on package/function\n?here\n\n??here"
  },
  {
    "objectID": "practice/slides_lab01.html#file-paths-logistics",
    "href": "practice/slides_lab01.html#file-paths-logistics",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "File paths logistics",
    "text": "File paths logistics\nIt is never good practice to “hard code” the file’s absolute path: most likely it will break your code as soon as you (or someone else) need to run it on a different computer, let alone within a different OS.\n\nLet’s look at this example code using function readr::read_csv() (which reads a *.csv data file into the R workspace)\n\n# [NOT REPRODUCIBLE] hard coding your file path  -----------------------\n\n# File path on Mac:\ndataset &lt;- readr::read_csv(\"/Users/testuser/R4biostats/input_data/dataset.csv\")\n# Same file path on Windows:\ndataset &lt;- readr::read_csv(\"C:\\Users\\testuser\\R4biostats\\input_data\\dataset.csv\")\n\n🙄 …it won’t work on any other computer since it won’t have that same file structure!"
  },
  {
    "objectID": "practice/slides_lab01.html#reproducible-file-paths-with-here-in-rstudio",
    "href": "practice/slides_lab01.html#reproducible-file-paths-with-here-in-rstudio",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "(Reproducible) file paths with here (in Rstudio)",
    "text": "(Reproducible) file paths with here (in Rstudio)\n\nThe here package lets you reference file paths in a reproducible manner (anchored on the R Project’s folder as the root).\n\n\nWhere is my Working Directory?\n\nhere::here()\n\nYou should get: “/Users/YourName/RProj_Dir”  Now, you can embed here(dir,subdir) specifications in other functions.\nFor example, create sub-directories (for saving input data and output data) with the fs package\n\n## --- [check the function documentation]\n?fs::dir_create\n# with `here` I simply add subfolder names relative to my wd \nfs::dir_create(here(\"practice\", \"data\",\"data_input\"))\n# ...and a subfolder to put output files at the end\nfs::dir_create(here(\"practice\", \"data\",\"data_output\"))\n\n## --- [if I need to remove it (I have them already)]\nfs::dir_delete(here(\"practice\", \"data\"))"
  },
  {
    "objectID": "practice/slides_lab01.html#importing-data-into-r-workspace",
    "href": "practice/slides_lab01.html#importing-data-into-r-workspace",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Importing data into R workspace",
    "text": "Importing data into R workspace\nWe are using real data provided by Thabtah,Fadi. (2017). Autism Screening Adult. UCI Machine Learning Repository. https://doi.org/10.24432/C5F019  We use utils::read.csv to load a csv file\n\n?read.csv # to learn about function and arguments"
  },
  {
    "objectID": "practice/slides_lab01.html#option-1-importing-from-a-url",
    "href": "practice/slides_lab01.html#option-1-importing-from-a-url",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Option 1: Importing from a url",
    "text": "Option 1: Importing from a url\n\nautism_data_url &lt;- read.csv(\n  file = \"https://raw.githubusercontent.com/Sydney-Informatics-Hub/lessonbmc/gh-pages/_episodes_rmd/data/autism_data.csv\", \n  header = TRUE, # 1st line is the name of the variables\n  sep = \",\", # which is the field separator character.\n  na.strings = c(\"?\") # specific values R should interpret as NA\n)"
  },
  {
    "objectID": "practice/slides_lab01.html#option-2-importing-from-my-folder-if-you-previously-downloaded-the-file",
    "href": "practice/slides_lab01.html#option-2-importing-from-my-folder-if-you-previously-downloaded-the-file",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Option 2: Importing from my folder (if you previously downloaded the file)",
    "text": "Option 2: Importing from my folder (if you previously downloaded the file)\n\n\nhere lets me specify the complete path of the destination folder\n\n\n\n\n\n\n\n\nTip\n\n\nMake sure to match your own folder structure the file path here(...)!\n\n\n\n\n# Check my working directory location\n# here::here()\n\n# Use `here` in specifying all the subfolders AFTER the working directory \nautism_data_file &lt;- read.csv(\n  file = here(\"practice\", \"data_input\", \"01_datasets\", \"autism_data.csv\"), \n  header = TRUE, # 1st line is the name of the variables\n  sep = \",\", # which is the field separator character.\n  na.strings = c(\"?\"),# specific values R should interpret as NA\n  row.names = NULL)"
  },
  {
    "objectID": "practice/slides_lab01.html#viewing-the-dataset-and-variables",
    "href": "practice/slides_lab01.html#viewing-the-dataset-and-variables",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Viewing the dataset and variables",
    "text": "Viewing the dataset and variables\n\nView(autism_data_file)\n\n\nOr click on the object in Environment tab (upper right pane of RStudio)\n\n\n# What data type is this data?\nclass(autism_data_file)\n\n[1] \"data.frame\"\n\n# What variables are included in this dataset?\nbase::colnames(autism_data_file)\n\n [1] \"id\"              \"A1_Score\"        \"A2_Score\"        \"A3_Score\"       \n [5] \"A4_Score\"        \"A5_Score\"        \"A6_Score\"        \"A7_Score\"       \n [9] \"A8_Score\"        \"A9_Score\"        \"A10_Score\"       \"age\"            \n[13] \"gender\"          \"ethnicity\"       \"jaundice\"        \"autism\"         \n[17] \"contry_of_res\"   \"used_app_before\" \"result\"          \"age_desc\"       \n[21] \"relation\"        \"Class.ASD\"      \n\n\n\nNotice the var name formatting inconsistency: Class.ASD"
  },
  {
    "objectID": "practice/slides_lab01.html#manipulate-clean-the-dataframe",
    "href": "practice/slides_lab01.html#manipulate-clean-the-dataframe",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Manipulate / clean the dataframe",
    "text": "Manipulate / clean the dataframe\nI want consistent name formatting for variables: no “.”, only “_” separator. So, I use a very handy function clean_names from the janitor package\n\nautism_data &lt;- janitor::clean_names(autism_data_file, \n                                     case = \"none\") \n# check change\ncolnames(autism_data)\n\n [1] \"id\"              \"A1_Score\"        \"A2_Score\"        \"A3_Score\"       \n [5] \"A4_Score\"        \"A5_Score\"        \"A6_Score\"        \"A7_Score\"       \n [9] \"A8_Score\"        \"A9_Score\"        \"A10_Score\"       \"age\"            \n[13] \"gender\"          \"ethnicity\"       \"jaundice\"        \"autism\"         \n[17] \"contry_of_res\"   \"used_app_before\" \"result\"          \"age_desc\"       \n[21] \"relation\"        \"Class_ASD\"      \n\ndim(autism_data)\n\n[1] 704  22\n\n\n\nBy default clean_names renames cols into “snake” format (i.e. “abc_xyz”)\nThe option case is for capitalization preferences\n\n\ncase = \"none\" leaves the case as is, but only uses “_” separator"
  },
  {
    "objectID": "practice/slides_lab01.html#isolate-a-variable-column",
    "href": "practice/slides_lab01.html#isolate-a-variable-column",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Isolate a variable (column)",
    "text": "Isolate a variable (column)\nYou can use the $ sign to extract a variable (column name)\n\nautism_data$id\nautism_data$A1_Score\nautism_data$gender\nautism_data$autism"
  },
  {
    "objectID": "practice/slides_lab01.html#add-a-new-column",
    "href": "practice/slides_lab01.html#add-a-new-column",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Add a new column",
    "text": "Add a new column\n(I prefer to rename the dataframe when I make changes)\n\n# rename dataframe \nautism_pids &lt;- autism_data\n\nCreate a new column, using paste (function to concatenate strings)\n\n# create a new column \nautism_pids$pids &lt;- paste(\"PatientID_\" , autism_data$id, sep = \"\")\n\nCheck results:\n\n# check change in df structure\nbase::colnames(autism_pids)\n\n [1] \"id\"              \"A1_Score\"        \"A2_Score\"        \"A3_Score\"       \n [5] \"A4_Score\"        \"A5_Score\"        \"A6_Score\"        \"A7_Score\"       \n [9] \"A8_Score\"        \"A9_Score\"        \"A10_Score\"       \"age\"            \n[13] \"gender\"          \"ethnicity\"       \"jaundice\"        \"autism\"         \n[17] \"contry_of_res\"   \"used_app_before\" \"result\"          \"age_desc\"       \n[21] \"relation\"        \"Class_ASD\"       \"pids\"           \n\ndim(autism_data)\n\n[1] 704  22\n\ndim(autism_pids)\n\n[1] 704  23"
  },
  {
    "objectID": "practice/slides_lab01.html#optional-clean-up-my-workspace",
    "href": "practice/slides_lab01.html#optional-clean-up-my-workspace",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "(optional) Clean up my workspace",
    "text": "(optional) Clean up my workspace\n\n# what do I have in the environment? \nls() \n\n[1] \"autism_data\"      \"autism_data_file\" \"autism_pids\"     \n\n# remove all EXCEPT for \"autism_pids\" \nrm(\"autism_data\", \"autism_data_file\", \"autism_data_url\" ) \n\n\n\n\n(Warning: mind that after rm(), you will not have these objects in your workspace anymore.)"
  },
  {
    "objectID": "practice/slides_lab01.html#option-1-extract-cols-with",
    "href": "practice/slides_lab01.html#option-1-extract-cols-with",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Option 1 Extract cols with $",
    "text": "Option 1 Extract cols with $\n\n(head only specifies to take the first 6 observations of the dataset)\n\n\n# With the `$` sign I extract a variable (column name)\nhead(autism_pids$id) \n\n[1] 1 2 3 4 5 6\n\nhead(autism_pids$pids)\n\n[1] \"PatientID_1\" \"PatientID_2\" \"PatientID_3\" \"PatientID_4\" \"PatientID_5\"\n[6] \"PatientID_6\"\n\nhead(autism_pids$A1_Score)\n\n[1] 1 1 1 1 1 1\n\nhead(autism_pids$ethnicity)\n\n[1] \"White-European\" \"Latino\"         \"Latino\"         \"White-European\"\n[5] NA               \"Others\""
  },
  {
    "objectID": "practice/slides_lab01.html#option-2a-extract-cols-with-col",
    "href": "practice/slides_lab01.html#option-2a-extract-cols-with-col",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Option 2a Extract cols with [,#col]",
    "text": "Option 2a Extract cols with [,#col]\n\nThis is called “indexing”\n\n\n# Indexing to pick `[ , #col]`  \nhead(autism_pids[ ,1] )# empty rows means all \n\n[1] 1 2 3 4 5 6\n\nhead(autism_pids[ ,23])\n\n[1] \"PatientID_1\" \"PatientID_2\" \"PatientID_3\" \"PatientID_4\" \"PatientID_5\"\n[6] \"PatientID_6\"\n\nhead(autism_pids[ ,2])\n\n[1] 1 1 1 1 1 1\n\nhead(autism_pids[ ,14])\n\n[1] \"White-European\" \"Latino\"         \"Latino\"         \"White-European\"\n[5] NA               \"Others\""
  },
  {
    "objectID": "practice/slides_lab01.html#option-2b-extract-rows-with-row",
    "href": "practice/slides_lab01.html#option-2b-extract-rows-with-row",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Option 2b Extract rows with [#row,]",
    "text": "Option 2b Extract rows with [#row,]\n\n# Indexing to pick `[#row, ]`  \nhead(autism_pids[1 , ] ) # empty cols means all \n\n  id A1_Score A2_Score A3_Score A4_Score A5_Score A6_Score A7_Score A8_Score\n1  1        1        1        1        1        0        0        1        1\n  A9_Score A10_Score age gender      ethnicity jaundice autism contry_of_res\n1        0         0  26      f White-European       no     no United States\n  used_app_before result    age_desc relation Class_ASD        pids\n1              no      6 18 and more     Self        NO PatientID_1\n\nhead(autism_pids[50,])\n\n   id A1_Score A2_Score A3_Score A4_Score A5_Score A6_Score A7_Score A8_Score\n50 50        1        1        0        0        0        1        1        1\n   A9_Score A10_Score age gender ethnicity jaundice autism contry_of_res\n50        0         1  30      f     Asian       no     no    Bangladesh\n   used_app_before result    age_desc relation Class_ASD         pids\n50              no      6 18 and more     Self        NO PatientID_50\n\nhead(autism_pids[25:26 ,])\n\n   id A1_Score A2_Score A3_Score A4_Score A5_Score A6_Score A7_Score A8_Score\n25 25        1        1        1        1        0        0        0        1\n26 26        0        1        1        0        0        0        0        1\n   A9_Score A10_Score age gender ethnicity jaundice autism contry_of_res\n25        0         0  43      m      &lt;NA&gt;       no     no       Lebanon\n26        0         0  24      f      &lt;NA&gt;      yes     no   Afghanistan\n   used_app_before result    age_desc relation Class_ASD         pids\n25              no      5 18 and more     &lt;NA&gt;        NO PatientID_25\n26              no      3 18 and more     &lt;NA&gt;        NO PatientID_26"
  },
  {
    "objectID": "practice/slides_lab01.html#option-3-extract-rows-cols-with-rowcol",
    "href": "practice/slides_lab01.html#option-3-extract-rows-cols-with-rowcol",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Option 3 Extract rows & cols with [#row,#col]",
    "text": "Option 3 Extract rows & cols with [#row,#col]\n\n# Indexing to pick `[#row, #col]`  \nautism_pids[1:3,1]\n\n[1] 1 2 3\n\nautism_pids[1:3,23]\n\n[1] \"PatientID_1\" \"PatientID_2\" \"PatientID_3\"\n\nautism_pids[1:3,2]\n\n[1] 1 1 1\n\nautism_pids[1:3,14]\n\n[1] \"White-European\" \"Latino\"         \"Latino\""
  },
  {
    "objectID": "practice/slides_lab01.html#option-1-using-base-functions",
    "href": "practice/slides_lab01.html#option-1-using-base-functions",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Option 1 using base functions",
    "text": "Option 1 using base functions\n\non the whole dataset\n\n\n# What are the data types of the variables? ---------------------------------\nstr(autism_pids) # integer and character\n\n'data.frame':   704 obs. of  23 variables:\n $ id             : int  1 2 3 4 5 6 7 8 9 10 ...\n $ A1_Score       : int  1 1 1 1 1 1 0 1 1 1 ...\n $ A2_Score       : int  1 1 1 1 0 1 1 1 1 1 ...\n $ A3_Score       : int  1 0 0 0 0 1 0 1 0 1 ...\n $ A4_Score       : int  1 1 1 1 0 1 0 1 0 1 ...\n $ A5_Score       : int  0 0 1 0 0 1 0 0 1 0 ...\n $ A6_Score       : int  0 0 0 0 0 0 0 0 0 1 ...\n $ A7_Score       : int  1 0 1 1 0 1 0 0 0 1 ...\n $ A8_Score       : int  1 1 1 1 1 1 1 0 1 1 ...\n $ A9_Score       : int  0 0 1 0 0 1 0 1 1 1 ...\n $ A10_Score      : int  0 1 1 1 0 1 0 0 1 0 ...\n $ age            : int  26 24 27 35 40 36 17 64 29 17 ...\n $ gender         : chr  \"f\" \"m\" \"m\" \"f\" ...\n $ ethnicity      : chr  \"White-European\" \"Latino\" \"Latino\" \"White-European\" ...\n $ jaundice       : chr  \"no\" \"no\" \"yes\" \"no\" ...\n $ autism         : chr  \"no\" \"yes\" \"yes\" \"yes\" ...\n $ contry_of_res  : chr  \"United States\" \"Brazil\" \"Spain\" \"United States\" ...\n $ used_app_before: chr  \"no\" \"no\" \"no\" \"no\" ...\n $ result         : int  6 5 8 6 2 9 2 5 6 8 ...\n $ age_desc       : chr  \"18 and more\" \"18 and more\" \"18 and more\" \"18 and more\" ...\n $ relation       : chr  \"Self\" \"Self\" \"Parent\" \"Self\" ...\n $ Class_ASD      : chr  \"NO\" \"NO\" \"YES\" \"NO\" ...\n $ pids           : chr  \"PatientID_1\" \"PatientID_2\" \"PatientID_3\" \"PatientID_4\" ..."
  },
  {
    "objectID": "practice/slides_lab01.html#option-1-using-base-functions-cont.",
    "href": "practice/slides_lab01.html#option-1-using-base-functions-cont.",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Option 1 using base functions (cont.)",
    "text": "Option 1 using base functions (cont.)\n\non specific columns\n\n\n# What values can the variables take? ---------------------------------\nsummary(autism_pids$pids)\n\n   Length     Class      Mode \n      704 character character \n\nlength(unique(autism_pids$pids)) # N unique values\n\n[1] 704\n\nsum(is.na(autism_pids$pids)) # N missing values\n\n[1] 0\n\nsummary(autism_pids$ethnicity)\n\n   Length     Class      Mode \n      704 character character \n\nlength(unique(autism_pids$ethnicity)) # N unique values\n\n[1] 12\n\nsum(is.na(autism_pids$ethnicity)) # N missing values\n\n[1] 95"
  },
  {
    "objectID": "practice/slides_lab01.html#option-2-using-skimr-function-skim",
    "href": "practice/slides_lab01.html#option-2-using-skimr-function-skim",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Option 2 using skimr function skim\n",
    "text": "Option 2 using skimr function skim\n\n\non specific columns\n\n\nautism_pids %&gt;% \n  skimr::skim(pids, ethnicity) %&gt;%\n  dplyr::select(#skim_variable, \n                skim_type, \n                complete_rate,\n                n_missing, \n                character.n_unique)\n\n\n\n# A tibble: 2 × 4\n  skim_type complete_rate n_missing character.n_unique\n  &lt;chr&gt;             &lt;dbl&gt;     &lt;int&gt;              &lt;int&gt;\n1 character         1             0                704\n2 character         0.865        95                 11"
  },
  {
    "objectID": "practice/slides_lab01.html#option-2-using-skimr-function-skim-cont.",
    "href": "practice/slides_lab01.html#option-2-using-skimr-function-skim-cont.",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Option 2 using skimr function skim (cont.)",
    "text": "Option 2 using skimr function skim (cont.)\n\non the whole dataset\n\n\nautism_pids %&gt;% \n  skimr::skim() \n\n\n\n\n── Variable type: character ────────────────────────────────────────────────────\n   skim_variable   n_missing complete_rate min max empty n_unique whitespace\n 1 gender                  0         1       1   1     0        2          0\n 2 ethnicity              95         0.865   5  15     0       11          0\n 3 jaundice                0         1       2   3     0        2          0\n 4 autism                  0         1       2   3     0        2          0\n 5 contry_of_res           0         1       4  20     0       67          0\n 6 used_app_before         0         1       2   3     0        2          0\n 7 age_desc                0         1      11  11     0        1          0\n 8 relation               95         0.865   4  24     0        5          0\n 9 Class_ASD               0         1       2   3     0        2          0\n10 pids                    0         1      11  13     0      704          0\n\n── Variable type: numeric ──────────────────────────────────────────────────────\n   skim_variable n_missing complete_rate    mean      sd p0  p25  p50  p75 p100\n 1 id                    0         1     352.    203.     1 177. 352. 528.  704\n 2 A1_Score              0         1       0.722   0.449  0   0    1    1     1\n 3 A2_Score              0         1       0.453   0.498  0   0    0    1     1\n 4 A3_Score              0         1       0.457   0.499  0   0    0    1     1\n 5 A4_Score              0         1       0.496   0.500  0   0    0    1     1\n 6 A5_Score              0         1       0.499   0.500  0   0    0    1     1\n 7 A6_Score              0         1       0.284   0.451  0   0    0    1     1\n 8 A7_Score              0         1       0.418   0.494  0   0    0    1     1\n 9 A8_Score              0         1       0.649   0.478  0   0    1    1     1\n10 A9_Score              0         1       0.324   0.468  0   0    0    1     1\n11 A10_Score             0         1       0.574   0.495  0   0    1    1     1\n12 age                   2         0.997  29.2     9.71  17  21   27   35    64\n13 result                0         1       4.88    2.50   0   3    4    7    10"
  },
  {
    "objectID": "practice/slides_lab01.html#from-character-to-factor-using-base-r",
    "href": "practice/slides_lab01.html#from-character-to-factor-using-base-r",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "From character to factor using base R",
    "text": "From character to factor using base R\n\n#### char 2 factor -------------------------------------------------------------\n# Say I want to treat some variables as factors\nautism_pids$gender &lt;- as.factor(autism_pids$gender)\nautism_pids$ethnicity &lt;- as.factor(autism_pids$ethnicity)\nautism_pids$contry_of_res &lt;- as.factor(autism_pids$contry_of_res)\nautism_pids$relation &lt;- as.factor(autism_pids$relation)\n\n# check \nclass(autism_pids$gender)\n\n[1] \"factor\"\n\nclass(autism_pids$ethnicity)\n\n[1] \"factor\"\n\nclass(autism_pids$contry_of_res)\n\n[1] \"factor\"\n\nclass(autism_pids$relation)\n\n[1] \"factor\""
  },
  {
    "objectID": "practice/slides_lab01.html#from-character-to-factor-using-base-r-n-cols",
    "href": "practice/slides_lab01.html#from-character-to-factor-using-base-r-n-cols",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "From character to factor using base R (n cols)",
    "text": "From character to factor using base R (n cols)\n\nautism_pids_temp &lt;- autism_pids # copy df for test \n\nto_factor &lt;- c(\"gender\", \"ethnicity\", \"contry_of_res\", \"relation\") # vector of col names \nautism_pids_temp[ ,to_factor] &lt;-  lapply(X =  autism_pids[ ,to_factor], FUN = as.factor)\n\n# check \nclass(autism_pids_temp$gender)\n\n[1] \"factor\"\n\nclass(autism_pids_temp$ethnicity)\n\n[1] \"factor\"\n\nclass(autism_pids_temp$contry_of_res)\n\n[1] \"factor\"\n\nclass(autism_pids_temp$relation)\n\n[1] \"factor\"\n\n# now I have Variable type: factor"
  },
  {
    "objectID": "practice/slides_lab01.html#inspect-factors-levels-3-different-ways",
    "href": "practice/slides_lab01.html#inspect-factors-levels-3-different-ways",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Inspect factors levels (3 different ways)",
    "text": "Inspect factors levels (3 different ways)\n\nusing base::levels function\n\n\nlevels(autism_pids$ethnicity)\n\n [1] \"Asian\"           \"Black\"           \"Hispanic\"        \"Latino\"         \n [5] \"Middle Eastern \" \"others\"          \"Others\"          \"Pasifika\"       \n [9] \"South Asian\"     \"Turkish\"         \"White-European\" \n\n\n\nusing base::table function\n\n\ntable(autism_pids$ethnicity,useNA = \"ifany\")\n\n\n          Asian           Black        Hispanic          Latino Middle Eastern  \n            123              43              13              20              92 \n         others          Others        Pasifika     South Asian         Turkish \n              1              30              12              36               6 \n White-European            &lt;NA&gt; \n            233              95"
  },
  {
    "objectID": "practice/slides_lab01.html#inspect-factors-levels-3-different-ways-cont.",
    "href": "practice/slides_lab01.html#inspect-factors-levels-3-different-ways-cont.",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Inspect factors levels – 3 different ways (cont.)",
    "text": "Inspect factors levels – 3 different ways (cont.)\n\nusing janitor function tabyl, which uses the “pipe” operator %&gt;% which takes the output of a function as input of the next one\n\n\njanitor::tabyl(autism_pids$ethnicity) %&gt;% \n  adorn_totals() %&gt;% \n  adorn_pct_formatting()\n\n autism_pids$ethnicity   n percent valid_percent\n                 Asian 123   17.5%         20.2%\n                 Black  43    6.1%          7.1%\n              Hispanic  13    1.8%          2.1%\n                Latino  20    2.8%          3.3%\n       Middle Eastern   92   13.1%         15.1%\n                others   1    0.1%          0.2%\n                Others  30    4.3%          4.9%\n              Pasifika  12    1.7%          2.0%\n           South Asian  36    5.1%          5.9%\n               Turkish   6    0.9%          1.0%\n        White-European 233   33.1%         38.3%\n                  &lt;NA&gt;  95   13.5%             -\n                 Total 704  100.0%        100.0%"
  },
  {
    "objectID": "practice/slides_lab01.html#identify-missing-values",
    "href": "practice/slides_lab01.html#identify-missing-values",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Identify missing values",
    "text": "Identify missing values\nUse is.na to check if the 95 missing obs are the same missing for ethnicity and relation\n\nwhich(is.na(autism_pids$ethnicity)) # indices of TRUE elements in vector\n\n [1]   5  13  14  15  20  21  25  26  63  80  81  82  92 217 222 239 258 271 277\n[20] 278 286 307 316 325 338 339 340 341 342 343 344 345 346 347 348 349 350 351\n[39] 352 353 354 355 356 362 366 370 371 373 379 380 381 382 383 384 385 386 387\n[58] 388 389 391 396 400 401 402 404 424 428 429 430 433 439 454 486 506 519 528\n[77] 535 536 537 538 557 565 572 573 589 594 637 643 646 652 653 659 660 667 702\n\nwhich(is.na(autism_pids$relation))  # indices of TRUE elements in vector\n\n [1]   5  13  14  15  20  21  25  26  63  80  81  82  92 217 222 239 258 271 277\n[20] 278 286 307 316 325 338 339 340 341 342 343 344 345 346 347 348 349 350 351\n[39] 352 353 354 355 356 362 366 370 371 373 379 380 381 382 383 384 385 386 387\n[58] 388 389 391 396 400 401 402 404 424 428 429 430 433 439 454 486 506 519 528\n[77] 535 536 537 538 557 565 572 573 589 594 637 643 646 652 653 659 660 667 702\n\n\n…indeed they are the same IDs!"
  },
  {
    "objectID": "practice/slides_lab01.html#from-character-to-logical",
    "href": "practice/slides_lab01.html#from-character-to-logical",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "From character to logical",
    "text": "From character to logical\nI may prefer to code a variable as logical. For example, age_desc may be more explicit if coded as logical.\n\nI create a new column age_desc_log\n\n\n\n# observe a subset of some columns \nautism_subset &lt;- autism_pids [1:5, c(\"gender\",\"jaundice\", \"autism\",\"age_desc\",\n                                     \"Class_ASD\",\"pids\")]\n# View(autism_subset)\n\n# recode \"age_desc\" as LOGICAL new var \"age_desc_log\"\nautism_pids$age_desc_log &lt;- ifelse(autism_pids$age_desc == \"18 and more\", TRUE, FALSE )\nclass(autism_pids$age_desc)\n\n[1] \"character\"\n\nclass(autism_pids$age_desc_log)\n\n[1] \"logical\""
  },
  {
    "objectID": "practice/slides_lab01.html#from-character-to-dummy-01",
    "href": "practice/slides_lab01.html#from-character-to-dummy-01",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "From character to dummy [0,1]",
    "text": "From character to dummy [0,1]\nI also may need binary variables expressed as [0,1] (e.g. to incorporate nominal variables into regression analysis). Let’s recode autism.\n\nautism_pids$autism_dummy &lt;- ifelse(autism_pids$autism == 'yes', 1, 0)\nclass(autism_pids$autism)\n\n[1] \"character\"\n\nclass(autism_pids$autism_dummy)\n\n[1] \"numeric\""
  },
  {
    "objectID": "practice/slides_lab01.html#subsetting-the-data-for-further-investigation",
    "href": "practice/slides_lab01.html#subsetting-the-data-for-further-investigation",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Subsetting the data for further investigation",
    "text": "Subsetting the data for further investigation\nRecall how to view the names of columns / variables\n\ncolnames(autism_pids)\n\n [1] \"id\"              \"A1_Score\"        \"A2_Score\"        \"A3_Score\"       \n [5] \"A4_Score\"        \"A5_Score\"        \"A6_Score\"        \"A7_Score\"       \n [9] \"A8_Score\"        \"A9_Score\"        \"A10_Score\"       \"age\"            \n[13] \"gender\"          \"ethnicity\"       \"jaundice\"        \"autism\"         \n[17] \"contry_of_res\"   \"used_app_before\" \"result\"          \"age_desc\"       \n[21] \"relation\"        \"Class_ASD\"       \"pids\"            \"age_desc_log\"   \n[25] \"autism_dummy\""
  },
  {
    "objectID": "practice/slides_lab01.html#using-head-or-tail-from-utils",
    "href": "practice/slides_lab01.html#using-head-or-tail-from-utils",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "using head or tail from utils\n",
    "text": "using head or tail from utils\n\n\n\nhead or tail return the first or last parts of an object\n\n\nhead(autism_pids)   #return fist 6 obs\ntail(autism_pids)   #return last 6 obs"
  },
  {
    "objectID": "practice/slides_lab01.html#using-head-or-tail-from-utils-cont.",
    "href": "practice/slides_lab01.html#using-head-or-tail-from-utils-cont.",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "using head or tail from utils (cont.)",
    "text": "using head or tail from utils (cont.)\n\nhead(autism_pids, n = 2) #return fist 2 obs\n\n  id A1_Score A2_Score A3_Score A4_Score A5_Score A6_Score A7_Score A8_Score\n1  1        1        1        1        1        0        0        1        1\n2  2        1        1        0        1        0        0        0        1\n  A9_Score A10_Score age gender      ethnicity jaundice autism contry_of_res\n1        0         0  26      f White-European       no     no United States\n2        0         1  24      m         Latino       no    yes        Brazil\n  used_app_before result    age_desc relation Class_ASD        pids\n1              no      6 18 and more     Self        NO PatientID_1\n2              no      5 18 and more     Self        NO PatientID_2\n  age_desc_log autism_dummy\n1         TRUE            0\n2         TRUE            1\n\ntail(autism_pids, n = 2) #return last 2 obs\n\n     id A1_Score A2_Score A3_Score A4_Score A5_Score A6_Score A7_Score A8_Score\n703 703        1        0        0        1        1        0        1        0\n704 704        1        0        1        1        1        0        1        1\n    A9_Score A10_Score age gender      ethnicity jaundice autism contry_of_res\n703        1         1  35      m    South Asian       no     no      Pakistan\n704        1         1  26      f White-European       no     no        Cyprus\n    used_app_before result    age_desc relation Class_ASD          pids\n703              no      6 18 and more     Self        NO PatientID_703\n704              no      8 18 and more     Self       YES PatientID_704\n    age_desc_log autism_dummy\n703         TRUE            0\n704         TRUE            0"
  },
  {
    "objectID": "practice/slides_lab01.html#investigating-a-subset-of-observations",
    "href": "practice/slides_lab01.html#investigating-a-subset-of-observations",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Investigating a subset of observations",
    "text": "Investigating a subset of observations\nE.g. I learned that some patients have missing age… how many are they?\n\n# run...\nsum(is.na(autism_pids$age)) \n\n[1] 2\n\n# or \nskimr::n_missing(autism_pids$age)\n\n[1] 2\n\n\n So, next, I want to ID those patients with missing age."
  },
  {
    "objectID": "practice/slides_lab01.html#new-df-patients-missing-age-as-subset-of-the-given-df",
    "href": "practice/slides_lab01.html#new-df-patients-missing-age-as-subset-of-the-given-df",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "New df (patients missing age) as SUBSET of the given df",
    "text": "New df (patients missing age) as SUBSET of the given df\nI want to extract only the obs (rows) of interest with a few useful vars (cols)\nOption 1) using [] from base\n\n\nmissing_age_subset &lt;- autism_pids[is.na(autism_pids$age), \n                                  c(\"pids\", \"age\", \"autism_dummy\") ]\nmissing_age_subset\n\n           pids age autism_dummy\n63 PatientID_63  NA            0\n92 PatientID_92  NA            0"
  },
  {
    "objectID": "practice/slides_lab01.html#new-df-patients-missing-age-as-subset-of-the-given-df-1",
    "href": "practice/slides_lab01.html#new-df-patients-missing-age-as-subset-of-the-given-df-1",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "New df (patients missing age) as SUBSET of the given df",
    "text": "New df (patients missing age) as SUBSET of the given df\nI want to extract only the obs (rows) of interest with a few useful vars (cols)\nOption 2) using which from base\n\n\nmissing_age_subset2 &lt;- autism_pids[which(is.na(autism_pids$age)), \n                                   c(\"pids\", \"age\", \"autism_dummy\")] \nmissing_age_subset2\n\n           pids age autism_dummy\n63 PatientID_63  NA            0\n92 PatientID_92  NA            0"
  },
  {
    "objectID": "practice/slides_lab01.html#new-df-patients-missing-age-as-subset-of-the-given-df-2",
    "href": "practice/slides_lab01.html#new-df-patients-missing-age-as-subset-of-the-given-df-2",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "New df (patients missing age) as SUBSET of the given df",
    "text": "New df (patients missing age) as SUBSET of the given df\nI want to extract only the obs (rows) of interest with a few useful vars (cols)\nOption 3) using subset from base\n\n\n# arguments allow me to specify rows and cols \nmissing_age_subset3 &lt;- subset(x = autism_pids, \n                              subset = is.na(autism_pids$age), # 1 logical condition\n                              select = c(\"pids\", \"age\", \"autism_dummy\") # which cols\n                              ) \nmissing_age_subset3\n\n           pids age autism_dummy\n63 PatientID_63  NA            0\n92 PatientID_92  NA            0"
  },
  {
    "objectID": "practice/slides_lab01.html#new-df-filtering-on-2-conditions-as-subset-of-the-given-df",
    "href": "practice/slides_lab01.html#new-df-filtering-on-2-conditions-as-subset-of-the-given-df",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "New df (filtering on 2 conditions) as SUBSET of the given df",
    "text": "New df (filtering on 2 conditions) as SUBSET of the given df\nOption 1) using base::subset\n\n\n# Creates a SUBSET based on MORE conditions (`age` and `ethnicity`)\ntwocond_base_subset &lt;- subset(x = autism_pids, \n                       # 2 logical conditions      \n                       subset = age &lt; 25 & contry_of_res == \"Brazil\", \n                       # pick a few cols \n                       select = c(\"pids\", \"age\", \"contry_of_res\",\n                                  \"autism_dummy\")) \n\ntwocond_base_subset\n\n             pids age contry_of_res autism_dummy\n2     PatientID_2  24        Brazil            1\n54   PatientID_54  21        Brazil            1\n94   PatientID_94  19        Brazil            1\n429 PatientID_429  20        Brazil            0\n587 PatientID_587  21        Brazil            0\n588 PatientID_588  21        Brazil            0"
  },
  {
    "objectID": "practice/slides_lab01.html#new-df-filtering-on-2-conditions-as-subset-of-the-given-df-1",
    "href": "practice/slides_lab01.html#new-df-filtering-on-2-conditions-as-subset-of-the-given-df-1",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "New df (filtering on 2 conditions) as SUBSET of the given df",
    "text": "New df (filtering on 2 conditions) as SUBSET of the given df\nOption 2) using dplyr (filter + select)\nSwitching to the package dplyr and embracing the “pipe” (%&gt;%) operator logic, in which the filtering (rows) and selecting (columns) is done in sequence\n\n## here the filtering (rows) and selecting (columns) is done in sequence\ntwocond_dplyr_subset &lt;- autism_pids %&gt;% \n  dplyr::filter(age &lt; 25 & contry_of_res == \"Brazil\") %&gt;%  # which rows\n  dplyr::select (pids, age, contry_of_res, autism_dummy)   # which cols\n\ntwocond_dplyr_subset\n\n           pids age contry_of_res autism_dummy\n1   PatientID_2  24        Brazil            1\n2  PatientID_54  21        Brazil            1\n3  PatientID_94  19        Brazil            1\n4 PatientID_429  20        Brazil            0\n5 PatientID_587  21        Brazil            0\n6 PatientID_588  21        Brazil            0"
  },
  {
    "objectID": "practice/slides_lab01.html#input-values-where-missing",
    "href": "practice/slides_lab01.html#input-values-where-missing",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Input values where missing",
    "text": "Input values where missing\n\n⚠️ WARNING︎: This is a very delicate & risky step ⚠️\n\nany modified/imputed data (beyond the original collection) can affect subsequent analysis and statistical modeling\nit will be necessary to document and justify whichever approach is used to deal with missing data.  Let’s assume we can get the missing data by cross-checking related clinical information\n\n\n# 1/2 create a new variable \nautism_pids$age_inputed &lt;- autism_pids$age\n# 2/2 replace value (presumably taken from other source) of `aged_inputed` \n  # CONDITIONAL on `pids`\nautism_pids$age_inputed[autism_pids$pids == \"PatientID_63\"] &lt;-  65\nautism_pids$age_inputed[autism_pids$pids == \"PatientID_92\"] &lt;-  45\n\n# check\nskimr::n_missing(autism_pids$age) \n\n[1] 2\n\nskimr::n_missing(autism_pids$age_inputed)  \n\n[1] 0"
  },
  {
    "objectID": "practice/slides_lab01.html#summarizing-all-variables",
    "href": "practice/slides_lab01.html#summarizing-all-variables",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Summarizing all variables",
    "text": "Summarizing all variables\nTry these 2 options: \n\n\nbase::c\n\nsummary(autism_pids)\n\n\nskimr::skim\n\nskimr::skim(autism_pids)"
  },
  {
    "objectID": "practice/slides_lab01.html#notice-summary-different-behavior-according-to-the-variables-type",
    "href": "practice/slides_lab01.html#notice-summary-different-behavior-according-to-the-variables-type",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Notice summary different behavior according to the variable’s type",
    "text": "Notice summary different behavior according to the variable’s type\nThe function’s results depend on the class of the object\n\nlook at the output in case of integer (e.g. A1_Score)\n\n\nsummary(autism_pids$A1_Score)     # min, max quartiles, mean, median\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.0000  0.0000  1.0000  0.7216  1.0000  1.0000 \n\n\n\nlook at the output in case of factor (e.g. ethnicity)\n\n\nsummary(autism_pids$ethnicity)    # counts of levels' frequency (included NA!)\n\n          Asian           Black        Hispanic          Latino Middle Eastern  \n            123              43              13              20              92 \n         others          Others        Pasifika     South Asian         Turkish \n              1              30              12              36               6 \n White-European            NA's \n            233              95"
  },
  {
    "objectID": "practice/slides_lab01.html#notice-summary-different-behavior-according-to-the-variables-type-cont.",
    "href": "practice/slides_lab01.html#notice-summary-different-behavior-according-to-the-variables-type-cont.",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Notice summary different behavior according to the variable’s type (cont.)",
    "text": "Notice summary different behavior according to the variable’s type (cont.)\n\nlook at the output in case of logical (e.g. age_desc_log)\n\n\nsummary(autism_pids$age_desc_log) # counts of TRUE \n\n   Mode    TRUE \nlogical     704"
  },
  {
    "objectID": "practice/slides_lab01.html#frequency-distributions-with-table",
    "href": "practice/slides_lab01.html#frequency-distributions-with-table",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Frequency distributions with table\n",
    "text": "Frequency distributions with table\n\n\nFrequency distributions can be used for nominal, ordinal, or interval/ration variables\n\n\ntable(autism_pids$gender)\n\n\n  f   m \n337 367 \n\ntable(autism_pids$age) # automatically drops missing...\n\n\n17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 \n18 31 35 46 49 37 37 34 27 28 31 24 27 30 21 18 16 12 17 13 17 13  7 16  3 15 \n43 44 45 46 47 48 49 50 51 52 53 54 55 56 58 59 60 61 64 \n11 10  4  6  8  4  3  5  1  5  6  2  6  2  2  1  1  2  1 \n\ntable(autism_pids$age, useNA = \"ifany\") #...unless specified\n\n\n  17   18   19   20   21   22   23   24   25   26   27   28   29   30   31   32 \n  18   31   35   46   49   37   37   34   27   28   31   24   27   30   21   18 \n  33   34   35   36   37   38   39   40   41   42   43   44   45   46   47   48 \n  16   12   17   13   17   13    7   16    3   15   11   10    4    6    8    4 \n  49   50   51   52   53   54   55   56   58   59   60   61   64 &lt;NA&gt; \n   3    5    1    5    6    2    6    2    2    1    1    2    1    2"
  },
  {
    "objectID": "practice/slides_lab01.html#cross-tabulation-with-table-2-vars",
    "href": "practice/slides_lab01.html#cross-tabulation-with-table-2-vars",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Cross tabulation with table (2 vars)",
    "text": "Cross tabulation with table (2 vars)\n\nCross tabulation\n\n\ntable(autism_pids$gender, autism_pids$age_inputed)\n\n   \n    17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41\n  f  7 11 22 22 18 14 17 10 11 14 18 15 16 13  8 14  6  7 12  7 11  6  5  9  0\n  m 11 20 13 24 31 23 20 24 16 14 13  9 11 17 13  4 10  5  5  6  6  7  2  7  3\n   \n    42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 58 59 60 61 64 65\n  f  6  5  4  5  4  3  2  2  2  0  2  4  1  1  0  1  0  1  1  0  0\n  m  9  6  6  0  2  5  2  1  3  1  3  2  1  5  2  1  1  0  1  1  1\n\ntable(autism_pids$ethnicity, autism_pids$autism_dummy)\n\n                 \n                    0   1\n  Asian           118   5\n  Black            38   5\n  Hispanic         12   1\n  Latino           12   8\n  Middle Eastern   83   9\n  others            1   0\n  Others           28   2\n  Pasifika         10   2\n  South Asian      34   2\n  Turkish           5   1\n  White-European  183  50"
  },
  {
    "objectID": "practice/slides_lab01.html#grouping-and-summarizing-with-base-r",
    "href": "practice/slides_lab01.html#grouping-and-summarizing-with-base-r",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Grouping and summarizing with base R",
    "text": "Grouping and summarizing with base R\nE.g. I want to know the average age of men and women sub-groups.\nOption 1) using by\n\n\n# by(data$column, data$grouping_column, mean)\nby(data = autism_pids$age_inputed, INDICES = autism_pids$gender, FUN = mean)\n\nautism_pids$gender: f\n[1] 29.60237\n------------------------------------------------------------ \nautism_pids$gender: m\n[1] 28.98365"
  },
  {
    "objectID": "practice/slides_lab01.html#grouping-and-summarizing-with-base-r-1",
    "href": "practice/slides_lab01.html#grouping-and-summarizing-with-base-r-1",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Grouping and summarizing with base R",
    "text": "Grouping and summarizing with base R\nOption 2) using tapply\n\n\n# i.e. apply a function to subsets of a vector or array, split by one or more factors.\ntapply(X = autism_pids$age_inputed, INDEX = autism_pids$gender, FUN = mean)\n\n       f        m \n29.60237 28.98365 \n\n\nOption 3) using split + sapply\n\n\n# sapply(split(data$column, data$grouping_column), mean)\nsapply(X = split(autism_pids$age_inputed, autism_pids$gender),FUN = mean) # returns a vector\n\n       f        m \n29.60237 28.98365"
  },
  {
    "objectID": "practice/slides_lab01.html#grouping-and-summarizing-with-dplyr",
    "href": "practice/slides_lab01.html#grouping-and-summarizing-with-dplyr",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Grouping and summarizing with dplyr\n",
    "text": "Grouping and summarizing with dplyr\n\n\n\n\nautism_pids %&gt;% \n  dplyr::group_by(gender) %&gt;% \n  dplyr::summarise(mean(age_inputed))  # returns a dataframe!\n\n# A tibble: 2 × 2\n  gender `mean(age_inputed)`\n  &lt;fct&gt;                &lt;dbl&gt;\n1 f                     29.6\n2 m                     29.0\n\n\nI could add more statistics to the grouped summary…\n\nautism_pids %&gt;% \n  dplyr::group_by(gender) %&gt;% \n  dplyr::summarise(mean_age = mean(age_inputed),  \n                   N_obs = n(), \n                   N_with_autism = sum(autism_dummy == 1)\n  ) \n\n# A tibble: 2 × 4\n  gender mean_age N_obs N_with_autism\n  &lt;fct&gt;     &lt;dbl&gt; &lt;int&gt;         &lt;int&gt;\n1 f          29.6   337            54\n2 m          29.0   367            37"
  },
  {
    "objectID": "practice/slides_lab01.html#mean-and-median",
    "href": "practice/slides_lab01.html#mean-and-median",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Mean and median",
    "text": "Mean and median\nRecall that: \nPopulation MEAN \\(\\mu=\\frac{\\sum_{i=1}^n x_{i}}n\\)Sample MEAN \\(\\bar{x}=\\frac{\\sum_{i=1}^n x_{i}}n\\) Sample MEDIAN\nFor uneven \\(n\\): \\(Mdn = \\frac{x_{(n+1)}}2\\)\nFor even \\(n\\): \\(Mdn = \\frac{x_{(n/2)} + x_{(n/2+1)}}2\\)"
  },
  {
    "objectID": "practice/slides_lab01.html#meanmedian-using-base-r",
    "href": "practice/slides_lab01.html#meanmedian-using-base-r",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Mean/Median using base R",
    "text": "Mean/Median using base R\n\nImportant to specify the argument na.rm = TRUE or the functions won’t work\n\n\n## Let's use `age` and `age_inputed` to see what inputed missing values did \nmean(autism_pids$age)\n\n[1] NA\n\nmedian(autism_pids$age)\n\n[1] NA\n\nmean(autism_pids$age, na.rm = TRUE)\n\n[1] 29.20655\n\nmedian(autism_pids$age, na.rm = TRUE)\n\n[1] 27\n\nmean(autism_pids$age_inputed)\n\n[1] 29.27983\n\nmedian(autism_pids$age_inputed)\n\n[1] 27"
  },
  {
    "objectID": "practice/slides_lab01.html#create-custom-function-to-calculate-statistical-mode-12",
    "href": "practice/slides_lab01.html#create-custom-function-to-calculate-statistical-mode-12",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Create custom function to calculate statistical mode 1/2",
    "text": "Create custom function to calculate statistical mode 1/2\nR doesn’t have a built-in function for the statistical mode, so we can create a custom one: f_calc_mode\nDefine the custom function\n\nf_calc_mode  &lt;- function(x) { \n  # `unique` returns a vector of unique values \n  uni_x &lt;- unique(x)  \n  # `match` returns the index positions of 1st vector against 2nd vector\n  match_x &lt;- match(x, uni_x)\n  # `tabulate` count the occurrences of integer values in a vector.\n  tab_x  &lt;-  tabulate(match_x) \n  # returns element of uni_x that corresponds to max occurrences\n  uni_x[tab_x == max(tab_x)]\n}"
  },
  {
    "objectID": "practice/slides_lab01.html#create-custom-function-to-calculate-statistical-mode-22",
    "href": "practice/slides_lab01.html#create-custom-function-to-calculate-statistical-mode-22",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Create custom function to calculate statistical mode 2/2",
    "text": "Create custom function to calculate statistical mode 2/2\nCall the custom function\n\nf_calc_mode(autism_pids$age)\n\n[1] 21\n\nf_calc_mode(autism_pids$age_inputed)\n\n[1] 21\n\nf_calc_mode(autism_pids$ethnicity)\n\n[1] White-European\n11 Levels: Asian Black Hispanic Latino Middle Eastern  others ... White-European"
  },
  {
    "objectID": "practice/slides_lab01.html#variance-and-standard-deviation",
    "href": "practice/slides_lab01.html#variance-and-standard-deviation",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Variance and Standard deviation",
    "text": "Variance and Standard deviation\nRecall that: Population Variance \\(\\sigma^2 = \\frac{\\displaystyle\\sum_{i=1}^{n}(x_i - \\mu)^2} {n}\\) Sample Variance \\(s^2 =\\frac{\\sum{(x_i-\\bar{x})^2}}{n-1}\\)Population Standard deviation \\(\\sigma = \\sqrt\\frac{\\displaystyle\\sum_{i=1}^{n}(x_i - \\mu)^2} {n}\\) Sample Standard deviation \\(s = \\sqrt\\frac{\\sum{(x_i-\\bar{x})^2}}{n-1}\\)"
  },
  {
    "objectID": "practice/slides_lab01.html#variance-and-standard-deviation-using-base-r",
    "href": "practice/slides_lab01.html#variance-and-standard-deviation-using-base-r",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Variance and Standard deviation using base R",
    "text": "Variance and Standard deviation using base R\n\nImportant to specify the argument na.rm = TRUE or the functions won’t work (or use the age_inputed variable)\n\n\nvar(autism_pids$age, na.rm = TRUE)\n\n[1] 94.28966\n\nvar(autism_pids$age_inputed)\n\n[1] 96.19328\n\nsd(autism_pids$age, na.rm = TRUE)\n\n[1] 9.710286\n\nsd(autism_pids$age_inputed)\n\n[1] 9.807817"
  },
  {
    "objectID": "practice/slides_lab01.html#plotting-with-ggplot2",
    "href": "practice/slides_lab01.html#plotting-with-ggplot2",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Plotting with ggplot2",
    "text": "Plotting with ggplot2\n\nggplot2 provides a set of tools to map data to visual elements on a plot, to specify the kind of plot you want, and then subsequently to control the fine details of how it will be displayed. It basically allows to build a plot layer by layer (Figure 2).\n\n\ndata -&gt; specify what the dataset is\n\naesthetic mappings (or just aesthetics) -&gt; specify which dataset’s variables will turn into the plot elements (e.g. \\(x\\) and \\(y\\) values, or categorical variable into colors, points, and shapes).\n\ngeom -&gt; the overall type of plot, e.g. geom_point() makes scatterplots, geom_bar() makes barplots, geom_boxplot() makes boxplots.\n\nAdditional (optional) pieces:\n\ninformation about the scales,\nthe labels of legends and axes\nother guides that help people to read the plot,"
  },
  {
    "objectID": "practice/slides_lab01.html#plotting-with-ggplot2-cont.",
    "href": "practice/slides_lab01.html#plotting-with-ggplot2-cont.",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Plotting with ggplot2 (cont.)",
    "text": "Plotting with ggplot2 (cont.)\na layered approach!\n\n\nFigure 2: ggplot2 layers Source: Mine Çetinkaya-Rundel’ Data Viz class"
  },
  {
    "objectID": "practice/slides_lab01.html#save-some-colors-for-customizing-plots",
    "href": "practice/slides_lab01.html#save-some-colors-for-customizing-plots",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Save some colors (for customizing plots)",
    "text": "Save some colors (for customizing plots)\n\nColors are defined in the form of Hexadecimal color values\n\n\n\ntwo_col_palette &lt;-  c(\"#9b2339\", \"#005ca1\")\n\ncontrast_cols_palette &lt;- c(\"#E7B800\",\"#239b85\", \"#85239b\", \"#9b8523\",\"#23399b\",\n                \"#d8e600\", \"#0084e6\", \"#399B23\", \"#e60066\",\n                \"#00d8e6\", \"#e68000\")"
  },
  {
    "objectID": "practice/slides_lab01.html#histograms",
    "href": "practice/slides_lab01.html#histograms",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Histograms",
    "text": "Histograms\nHistograms (and density plots) are often used to show the distribution of a continuous variable.\n\nOption 1) data inside the ggplot() function\n\n\nggplot(data = autism_pids, mapping = aes(x=age_inputed)) + \n  geom_histogram() + \n  theme_bw()\n\n\nOption 2) data before the pipe %&gt;%\n\n\n\nautism_pids %&gt;% \n  ggplot(aes(x = age_inputed )) + \n  geom_histogram() + \n  theme_bw()\n\n\n\n\nnotice that after calling ggplot(), subsequent layers are added with +"
  },
  {
    "objectID": "practice/slides_lab01.html#histograms-output",
    "href": "practice/slides_lab01.html#histograms-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Histograms",
    "text": "Histograms"
  },
  {
    "objectID": "practice/slides_lab01.html#define-bin-width",
    "href": "practice/slides_lab01.html#define-bin-width",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "… define bin width",
    "text": "… define bin width\nHistograms split the data into ranges (bins) and show the number of observations in each. Hence, it’s important to pick widths that represents the data well.\n\nThe default value is 30\nWe can change it using the argument bins = #\n\n\n\nautism_pids %&gt;% \n  ggplot(aes(x = age_inputed )) + \n  # specify to avoid warning if we fail to specify the number of bins \n  geom_histogram(bins=40) + \n  theme_bw()"
  },
  {
    "objectID": "practice/slides_lab01.html#define-bin-width-output",
    "href": "practice/slides_lab01.html#define-bin-width-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "… define bin width",
    "text": "… define bin width"
  },
  {
    "objectID": "practice/slides_lab01.html#add-mean-and-std-dev-vertical-lines",
    "href": "practice/slides_lab01.html#add-mean-and-std-dev-vertical-lines",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "… add mean and std dev vertical lines",
    "text": "… add mean and std dev vertical lines\n\nusing geom_vline() to add a vertical line for the mean, and the range between -1 and +1 sd from the mean.\nusing annotate() for adding small annotations (such as text labels)\n\n\nautism_pids %&gt;% \n  ggplot(aes(x = age_inputed )) + \n  geom_histogram(bins=40) + \n  # add mean vertical line\n  geom_vline(xintercept = mean(autism_pids$age_inputed),\n             na.rm = FALSE,\n             lwd=1,\n             color=\"#9b2339\") +\n  # add annotations with the mean value\n  annotate(\"text\",                        \n           x = mean(autism_pids$age_inputed) * 1.2, # coordinates for positioning\n           y = mean(autism_pids$age_inputed) * 2.5,\n           label = paste(\"Mean =\", round(mean(autism_pids$age_inputed), digits = 2)),\n           col = \"#9b2339\",\n           size = 4)+\n  # add also sd +1 and -1 \n  geom_vline(aes(xintercept = mean(autism_pids$age_inputed) + sd(autism_pids$age_inputed)), \n             color = \"#000000\", size = 1, linetype = \"dashed\") +\n  geom_vline(aes(xintercept = mean(autism_pids$age_inputed) - sd(autism_pids$age_inputed)), \n             color = \"#000000\", size = 1, linetype = \"dashed\") +\n  theme_bw()"
  },
  {
    "objectID": "practice/slides_lab01.html#add-mean-and-std-dev-vertical-lines-output",
    "href": "practice/slides_lab01.html#add-mean-and-std-dev-vertical-lines-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "… add mean and std dev vertical lines",
    "text": "… add mean and std dev vertical lines"
  },
  {
    "objectID": "practice/slides_lab01.html#density-plot",
    "href": "practice/slides_lab01.html#density-plot",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Density plot",
    "text": "Density plot\n\nspecifying x (the continuous variable)\nusing geom_density(), in which we\n\n\nautism_pids %&gt;% \n  ggplot(aes(x = age_inputed)) +\n  geom_density()+\n  theme_bw()"
  },
  {
    "objectID": "practice/slides_lab01.html#density-plot-output",
    "href": "practice/slides_lab01.html#density-plot-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Density plot",
    "text": "Density plot"
  },
  {
    "objectID": "practice/slides_lab01.html#density-plot-cont.",
    "href": "practice/slides_lab01.html#density-plot-cont.",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Density plot (cont.)",
    "text": "Density plot (cont.)\n\nspecifying shape colors with the arguments inside geom_density(...)\n\n\ncolor for the line color\n\nfill for area color\n\n\nalpha to specify the degree of transparency in the density fill area\n\n\nautism_pids %&gt;% \n  ggplot(aes( x=age_inputed)) +\n  geom_density(fill=\"#85239b\", color=\"#4c4c4c\", alpha=0.5)+\n  theme_bw()"
  },
  {
    "objectID": "practice/slides_lab01.html#density-plot-cont.-output",
    "href": "practice/slides_lab01.html#density-plot-cont.-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Density plot (cont.)",
    "text": "Density plot (cont.)"
  },
  {
    "objectID": "practice/slides_lab01.html#increase-of-x-axis-ticks",
    "href": "practice/slides_lab01.html#increase-of-x-axis-ticks",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "… increase # of x-axis ticks",
    "text": "… increase # of x-axis ticks\n\nspecifying the amount of breaks inside scale_x_continuous()\n\n\n\nautism_pids %&gt;% \n  ggplot(aes( x=age_inputed)) +\n  geom_density(fill=\"#85239b\", color=\"#4c4c4c\", alpha=0.5)+\n  theme_bw() + \n  # increase number of x axis ticks \n  scale_x_continuous(breaks = seq(10, 100,5 ), limits = c(16, 86))"
  },
  {
    "objectID": "practice/slides_lab01.html#increase-of-x-axis-ticks-output",
    "href": "practice/slides_lab01.html#increase-of-x-axis-ticks-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "… increase # of x-axis ticks",
    "text": "… increase # of x-axis ticks"
  },
  {
    "objectID": "practice/slides_lab01.html#histograms-with-fill-category",
    "href": "practice/slides_lab01.html#histograms-with-fill-category",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Histograms with fill = category\n",
    "text": "Histograms with fill = category\n\n\nindicate the categorical group as fill = in the aesthetic mapping\nspecify custom colors for each group:\n\n\nuse scale_color_manual() for changing line color\nuse scale_fill_manual() for changing area fill colors.\n\n\nautism_pids %&gt;% \n  # specifying `fill` = gender\n  ggplot(mapping = aes(x = age_inputed, fill = gender )) + \n  geom_histogram(bins=40) + \n  scale_fill_manual(values = c(\"#e07689\",\"#57b7ff\")) +\n  scale_color_manual(values = c(\"#9b2339\",\"#005ca1\")) +\n  theme_bw()"
  },
  {
    "objectID": "practice/slides_lab01.html#histograms-with-fill-category-output",
    "href": "practice/slides_lab01.html#histograms-with-fill-category-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Histograms with fill = category\n",
    "text": "Histograms with fill = category"
  },
  {
    "objectID": "practice/slides_lab01.html#shifting-bars-by-group",
    "href": "practice/slides_lab01.html#shifting-bars-by-group",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "… shifting bars by group",
    "text": "… shifting bars by group\n\nusing the specification position = 'dodge' inside geom_histogram()\n\n\n\n# trying to improve readability \nautism_pids %&gt;% \n  ggplot(mapping = aes(x = age_inputed, fill = gender )) + \n  # bars next to each other with `position = 'dodge'`\n  geom_histogram(bins=40, position = 'dodge')  + \n  scale_fill_manual(values = c(\"#e07689\",\"#57b7ff\")) +\n  scale_color_manual(values = c(\"#9b2339\",\"#005ca1\")) +\n  theme_bw()"
  },
  {
    "objectID": "practice/slides_lab01.html#shifting-bars-by-group-output",
    "href": "practice/slides_lab01.html#shifting-bars-by-group-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "… shifting bars by group",
    "text": "… shifting bars by group"
  },
  {
    "objectID": "practice/slides_lab01.html#facet-by-gender",
    "href": "practice/slides_lab01.html#facet-by-gender",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "…facet by gender",
    "text": "…facet by gender\nThat’s still not very easy to digest. Instead of only filling, you can separate the data into multiple plots to improve readability\n\nadding facet_wrap() with the the specification of ~categ_var\n\nalso ncol = 1 requires the subplot to be in 1 column\n\n\nautism_pids %&gt;% \n  ggplot(aes(x = age_inputed, fill = gender )) + \n  geom_histogram(color=\"#e9ecef\", alpha=0.8, position = 'dodge') + \n  theme_bw() + \n  # splitting the gender groups, specifying `ncol` to see one above the other\n  facet_wrap(~gender, ncol = 1)  + \n  scale_fill_cyclical(values = c(\"#9b2339\",\"#005ca1\"))"
  },
  {
    "objectID": "practice/slides_lab01.html#facet-by-gender-output",
    "href": "practice/slides_lab01.html#facet-by-gender-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "…facet by gender",
    "text": "…facet by gender"
  },
  {
    "objectID": "practice/slides_lab01.html#adding-2-meanmedian-vert-lines-by-gender",
    "href": "practice/slides_lab01.html#adding-2-meanmedian-vert-lines-by-gender",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "… adding 2 mean/median vert lines (by gender)",
    "text": "… adding 2 mean/median vert lines (by gender)\nI want to see the mean vertical line for each of the subgroups, but in this case, I need to create a small dataframe of summary statistics (group_stats).\nI do so by using dplyr add a column mean_age with the group mean\n\ngroup_stats &lt;- autism_pids %&gt;% \n  dplyr::group_by(gender) %&gt;% \n  dplyr::summarize(mean_age = mean(age_inputed),\n                   median_age = median (age_inputed)) \n\ngroup_stats\n\n\n\n# A tibble: 2 × 3\n  gender mean_age median_age\n  &lt;fct&gt;     &lt;dbl&gt;      &lt;dbl&gt;\n1 f          29.6         28\n2 m          29.0         26"
  },
  {
    "objectID": "practice/slides_lab01.html#small-digression-on-tidyrpivot_longer",
    "href": "practice/slides_lab01.html#small-digression-on-tidyrpivot_longer",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "(Small digression on tidyr::pivot_longer)",
    "text": "(Small digression on tidyr::pivot_longer)\n\nThe new small dataframe group_stats offers an example of reshaping, i.e. turning a table from a “wide” form (with each variable in its own column) to a “long” form (one column for both the measures names and another for both the measures values).\n\nThis can be done using tidyr::pivot_longer function, where these arguments must be specified:\n\n\ncols: The names of the columns to pivot\n\nnames_to: The name for the new character column\n\nvalues_to: The name for the new values column\n\n\n\n\ngroup_stats_long &lt;- group_stats %&gt;% \n  tidyr::pivot_longer(cols = mean_age:median_age, \n                      names_to = \"Stat\", \n                      values_to = \"Value\") %&gt;% \n  dplyr::mutate(label = as.character(glue::glue(\"{gender}_{Stat}\")))\n\ngroup_stats_long \n\n# A tibble: 4 × 4\n  gender Stat       Value label       \n  &lt;fct&gt;  &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       \n1 f      mean_age    29.6 f_mean_age  \n2 f      median_age  28   f_median_age\n3 m      mean_age    29.0 m_mean_age  \n4 m      median_age  26   m_median_age"
  },
  {
    "objectID": "practice/slides_lab01.html#facet-by-gender-vert-lines-by-group",
    "href": "practice/slides_lab01.html#facet-by-gender-vert-lines-by-group",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "…facet by gender + vert lines by group",
    "text": "…facet by gender + vert lines by group\nNotice that now the plot will have 2 data sources:\n\nautism_pids\ngroup_stats_long\n\n\nautism_pids %&gt;% \n  ggplot(aes(x = age_inputed, fill = gender)) + \n  # geom_histogram from dataframe 1\n  geom_histogram(bins=30,color=\"#e9ecef\", alpha=0.8, position = 'dodge') + \n  facet_wrap(~gender, ncol = 1) + \n  scale_fill_manual(values = c(\"#9b2339\",\"#005ca1\"))  +\n  # geom_vline from dataframe 2\n  geom_vline(data = group_stats_long, \n             mapping = aes(xintercept = Value, color = Stat),\n             lwd=1,\n             linetype=1) + \n  scale_color_manual(values = c( \"#f0a441\" , \"#d8cf71\")) +\n  theme_bw()"
  },
  {
    "objectID": "practice/slides_lab01.html#facet-by-gender-vert-lines-by-group-output",
    "href": "practice/slides_lab01.html#facet-by-gender-vert-lines-by-group-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "…facet by gender + vert lines by group",
    "text": "…facet by gender + vert lines by group"
  },
  {
    "objectID": "practice/slides_lab01.html#finishing-touches",
    "href": "practice/slides_lab01.html#finishing-touches",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "… finishing touches",
    "text": "… finishing touches\n\nusing labs() and theme() layers\n\n\nhist_plot &lt;- autism_pids %&gt;% \n  ggplot(aes(x = age_inputed, fill = gender)) + \n  # geom_histogram from dataframe 1\n  geom_histogram(bins=30,color=\"#e9ecef\", alpha=0.8, position = 'dodge') + \n  facet_wrap(~gender, ncol = 1) + \n  scale_fill_manual(values = c(\"#9b2339\",\"#005ca1\"))  +\n  # geom_vline from dataframe 2\n  geom_vline(data = group_stats_long, \n             mapping = aes(xintercept = Value, color = Stat),\n             lwd=1.5,\n             linetype=6) + \n  scale_color_manual(values = c( \"#e68000\", \"#d8cf71\")) +\n  # increase number of x axis ticks \n  scale_x_continuous(breaks = seq(10, 100,10 ), limits = c(10,70)) +\n  # Additional theme details \n  labs(x = \"age brackets\", y = \"n of individuals\",\n       color = \"Stats\",\n       title = \"Distribution of observations by gender\",\n       subtitle = \"\",\n       caption = \"Source: Thabtah,Fadi (2017) https://doi.org/10.24432/C5F019.\") +\n  theme(legend.position = \"right\",\n        plot.title = element_text(face = \"bold\")) \nhist_plot"
  },
  {
    "objectID": "practice/slides_lab01.html#finishing-touches-output",
    "href": "practice/slides_lab01.html#finishing-touches-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "… finishing touches",
    "text": "… finishing touches"
  },
  {
    "objectID": "practice/slides_lab01.html#density-ggridges-package",
    "href": "practice/slides_lab01.html#density-ggridges-package",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Density ggridges package",
    "text": "Density ggridges package\nAs an alternative, you can use the ggridges package to make ridge plots. The geom geom_density_ridges calculates density estimates from the provided data and then plots those, using the ridgeline visualization. In this case plots include a vertical median line.\n\nautism_pids %&gt;% \n  # this takes also `y` = group\n  ggplot(aes(x=age_inputed, y = gender, fill = gender)) +\n  ggridges::geom_density_ridges() +\n  # I can add quantile lines (2 is the median)\n  stat_density_ridges(quantile_lines = TRUE, quantiles = c(0.5), alpha = 0.75)+  \n  # increase number of x axis ticks \n  scale_x_continuous(breaks = seq(10, 100,10 ), limits = c(16, 86)) + \n  scale_fill_cyclical(values = c(\"#9b2339\",\"#005ca1\")) + \n  theme_bw()"
  },
  {
    "objectID": "practice/slides_lab01.html#density-ggridges-package-output",
    "href": "practice/slides_lab01.html#density-ggridges-package-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Density ggridges package",
    "text": "Density ggridges package"
  },
  {
    "objectID": "practice/slides_lab01.html#barchart",
    "href": "practice/slides_lab01.html#barchart",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Barchart",
    "text": "Barchart\nBar charts provide a visual presentation of categorical data, with geom_bar() (height of the bar proportional to the number of cases in each group)\n\n\nFigure 3: Difference barchart v. histogram Source: https://www.biorender.com/"
  },
  {
    "objectID": "practice/slides_lab01.html#barchart-cont.",
    "href": "practice/slides_lab01.html#barchart-cont.",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Barchart (cont.)",
    "text": "Barchart (cont.)\n\n# Let's take a variable that we recoded as `factor`\nclass(autism_pids$ethnicity)\n\n[1] \"factor\"\n\n#### ... no formatting ---------------------------------- \nautism_pids %&gt;% \n  ggplot(aes(x = ethnicity )) + \n  geom_bar() +   \n  theme_bw()"
  },
  {
    "objectID": "practice/slides_lab01.html#improve-theme",
    "href": "practice/slides_lab01.html#improve-theme",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "…improve theme",
    "text": "…improve theme\n\nautism_pids %&gt;% \n  ggplot(aes(x = ethnicity )) + \n  geom_bar(fill = \"steelblue\") +\n  # reference line  \n  geom_hline(yintercept=100, color = \"#9b2339\", size=0.5, ) +\n  # labels, title, etc \n  labs(x = \"ethnicity\", y = \"n of individuals\",\n       color = \"Stats\",\n       title = \"Distribution of observations by ethnicity\",\n       subtitle = \"\",\n       caption = \"Autism study\")  +\n  theme_bw() +\n  # specification son axis labels\n  theme(axis.text.x = element_text(angle=50, vjust=0.75), \n        axis.text.y = element_text(size=10,face=\"bold\"))"
  },
  {
    "objectID": "practice/slides_lab01.html#improve-theme-output",
    "href": "practice/slides_lab01.html#improve-theme-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "…improve theme",
    "text": "…improve theme"
  },
  {
    "objectID": "practice/slides_lab01.html#improve-readability-reorder-bars",
    "href": "practice/slides_lab01.html#improve-readability-reorder-bars",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "…improve readability (reorder bars)",
    "text": "…improve readability (reorder bars)\nReordering the bars by count using the package forcats and its function fct_infreq\n\n(which we can do because ethnicity was recoded as factor)\n\n\nautism_pids %&gt;% \n    # we modify our x like so \n    ggplot(aes(x = forcats::fct_infreq(ethnicity ))) + \n    geom_bar(fill = \"steelblue\") +\n    geom_hline(yintercept=100, color = \"#9b2339\", size=0.5, ) +\n    labs(x = \"ethnicity\", y = \"n of individuals\",\n         color = \"Stats\",\n         title = \"Distribution of observations by ethnicity\",\n         subtitle = \"\",\n         caption = \"Autism study\")  +\n    # --- wrap long x labels (flipped ) !!!\n    #  scale_x_discrete(labels = function(x) stringr::str_wrap(x, width = 10)) +\n    theme_bw() +\n    theme(axis.text.x = element_text(angle=50, vjust=0.75), \n          axis.text.y = element_text(size=10,face=\"bold\"))"
  },
  {
    "objectID": "practice/slides_lab01.html#improve-readability-reorder-bars-output",
    "href": "practice/slides_lab01.html#improve-readability-reorder-bars-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "…improve readability (reorder bars)",
    "text": "…improve readability (reorder bars)"
  },
  {
    "objectID": "practice/slides_lab01.html#improve-readability-highlight-na",
    "href": "practice/slides_lab01.html#improve-readability-highlight-na",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "…improve readability (highlight NA)",
    "text": "…improve readability (highlight NA)\nLet’s highlight the fact that the last column (NA) represents missing values.\n\nCreate the highlight variable\nMap color to a variable (fill = highlight)"
  },
  {
    "objectID": "practice/slides_lab01.html#improve-readability-highlight-na-code",
    "href": "practice/slides_lab01.html#improve-readability-highlight-na-code",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "…improve readability (highlight NA) code",
    "text": "…improve readability (highlight NA) code\n\nautism_pids %&gt;%\n  ## --- prep the dataframe \n  dplyr::mutate(# Add a factor variable with two levels\n    highlight = forcats::fct_other(ethnicity, \n                                   keep = \"NA\", \n                                   other_level = \"All Groups\")) %&gt;% \n  ## --- now plot \n  # In `aes mapping` we map color to a variable (`fill = highlight`)\n  ggplot(aes(x = forcats::fct_infreq(ethnicity), fill = highlight)) + \n  geom_bar()+\n  # Use custom color palettes\n  scale_fill_manual(values=c(\"#0084e6\")) +\n  # Add a line at a significant level \n  geom_hline(yintercept=100, color = \"#9b2339\", size=0.5, ) +\n  theme_bw() +\n  # make some more theme specifications  \n  labs(x = \"ethnicity\", y = \"n of individuals\",\n       color = \"Stats\",\n       title = \"Distribution of observations by ethnicity\",\n       subtitle = \"\",\n       caption = \"Autism study\")  +\n  theme(axis.text.x = element_text(angle=50, vjust=0.75), \n        axis.text.y = element_text(size=10,face=\"bold\"))  +\n  theme(legend.position = \"none\")"
  },
  {
    "objectID": "practice/slides_lab01.html#improve-readability-highlight-na-code-output",
    "href": "practice/slides_lab01.html#improve-readability-highlight-na-code-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "…improve readability (highlight NA) code",
    "text": "…improve readability (highlight NA) code"
  },
  {
    "objectID": "practice/slides_lab01.html#boxplot",
    "href": "practice/slides_lab01.html#boxplot",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Boxplot",
    "text": "Boxplot\nThe boxplot is one of the simplest ways of representing a distribution of a continuous variable and it is packed with information. It consists of two parts:\n\n\nBox — Extending from the 1st to the 3rd quartile (Q1 to Q3) with a line in the middle that represents the median.\n\nWhiskers — Lines extending from both ends of the box (minimum/maximum whisker values are calculated as Q1/Q3 -/+ 1.5 * IQR)\nEverything outside is represented as an outlier\n\n\n\n\nFigure 4: Boxplot Source: https://www.appsilon.com/post/ggplot2-boxplots"
  },
  {
    "objectID": "practice/slides_lab01.html#boxplot-example-1",
    "href": "practice/slides_lab01.html#boxplot-example-1",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Boxplot example 1",
    "text": "Boxplot example 1\nLet’s use a boxplot to explore how the continuous variable result is distributed in the autism dataset.\n\nin the aesthetic mapping we specify only x (continuous variable)\nswitch to vertical orientation with coord_flip()\n\n\n\nautism_pids %&gt;% \n  ggplot(aes(x = result )) +\n  geom_boxplot(alpha=0.5)+\n  # switch to vertical orientation\n  coord_flip() +\n  theme_bw()"
  },
  {
    "objectID": "practice/slides_lab01.html#boxplot-example-1-output",
    "href": "practice/slides_lab01.html#boxplot-example-1-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Boxplot example 1",
    "text": "Boxplot example 1"
  },
  {
    "objectID": "practice/slides_lab01.html#boxplot-example-2",
    "href": "practice/slides_lab01.html#boxplot-example-2",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Boxplot example 2",
    "text": "Boxplot example 2\nLet’s also explore how the continuous variable result is distributed by the categorical variable (factor) ethnicity.\n\nin the aesthetic mapping we specify y (continuous variable), plus x and fill (categorical variable)\nmake x axis labels readable with theme(axis.text.x (...)) layer\nI specify colors that I had previously saved in a color palette contrast_cols_palette\n\n\n\nautism_pids %&gt;% \n  ggplot(aes(x = ethnicity,  y= result, fill = ethnicity)) +\n  geom_boxplot(alpha=0.5)+\n  scale_fill_manual(values =  contrast_cols_palette)   +\n  theme_bw()+\n  # make x axis labes readable\n  theme(axis.text.x = element_text(angle=50, vjust=0.75)) +\n  # drop legend and Y-axis title\n  theme(legend.position = \"none\")"
  },
  {
    "objectID": "practice/slides_lab01.html#boxplot-example-2-output",
    "href": "practice/slides_lab01.html#boxplot-example-2-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Boxplot example 2",
    "text": "Boxplot example 2"
  },
  {
    "objectID": "practice/slides_lab01.html#violin-plot",
    "href": "practice/slides_lab01.html#violin-plot",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Violin plot",
    "text": "Violin plot\nSimilarly, the violin plot is an interesting alternative to show the distribution of a continuous variable along one or more categorical variables. Here, the kernel density plot shows the smoothed curve of the probability density function (PDF) of the data. \nCompared to the box plot, a violin plot provides more information, as it shows not only the summary statistics but also the shape and variability of the data (i.e. helping to identify any skewness or multimodality in the data)."
  },
  {
    "objectID": "practice/slides_lab01.html#violin-plot-example",
    "href": "practice/slides_lab01.html#violin-plot-example",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Violin plot example",
    "text": "Violin plot example\n\nit requires the geom_violin function\nit can be enriched by adding with other geoms, such as points, lines, or box plots, to create more complex and informative plots\nlet’s add points with the geom_point layer\n\n\nautism_pids %&gt;% \n  ggplot(mapping = aes(y = age_inputed, x = ethnicity, fill = ethnicity)) +\n  geom_violin(alpha=0.5) +\n  geom_point(position = position_jitter(width = 0.1), size = 0.5)+ \n  scale_fill_manual(values =  contrast_cols_palette)  +\n  # make x axis labes readable\n  theme(axis.text.x = element_text(angle=50, vjust=0.75)) +\n  # drop legend and Y-axis title\n  theme(legend.position = \"none\")"
  },
  {
    "objectID": "practice/slides_lab01.html#violin-plot-example-output",
    "href": "practice/slides_lab01.html#violin-plot-example-output",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Violin plot example",
    "text": "Violin plot example"
  },
  {
    "objectID": "practice/slides_lab01.html#saving-one-plot",
    "href": "practice/slides_lab01.html#saving-one-plot",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Saving one plot",
    "text": "Saving one plot\nIf I want to use these output files later, I can easily save in the output folder created at the beginning.\n\nsave a plot with ggplot2::ggsave\n\nspecifying the output directory with here::here(...)\n\n\n\nggsave (hist_plot, \n        filename = here::here(\"practice\",  \"data_output\", \"hist_plot.png\"))"
  },
  {
    "objectID": "practice/slides_lab01.html#saving-a-.rds-data-file.",
    "href": "practice/slides_lab01.html#saving-a-.rds-data-file.",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Saving a .Rds data file.",
    "text": "Saving a .Rds data file.\n\nsave a dataframe with base::saveRDS\n\nspecifying the output directory with here::here(...)\n\n\n\nsaveRDS (object = autism_pids, \n         file =  here::here(\"practice\",  \"data_output\", \"autism_pids_v2.Rds\"))\n\n\n\n(later) load a saved dataframe with base::readRDS\n\n\n\n# to load it later I will use \nreadRDS(here::here(\"practice\",  \"data_output\", \"autism_pids_v2.Rds\")) \n\n\n\nnotice I renamed while saving: next time I load it it will be called “autism_pids_v2”"
  },
  {
    "objectID": "practice/slides_lab01.html#final-thoughtsrecommendations",
    "href": "practice/slides_lab01.html#final-thoughtsrecommendations",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Final thoughts/recommendations",
    "text": "Final thoughts/recommendations\n\nAlways read the documentation (?package::function, especially the examples at the bottom)\nAlways inspect the data / variables before and after making changes\n\nBetter rename (i.e. create a new R object) when you recode/manipulate a column or a dataset\n\n(this promotes reproducibility, since you will be able to retrace your coding steps)\n\n\nAlways plot distributions for visual data exploration\nMake changes in small increments (like we saw in building ggplot2 graph in subsequent layers)\n\n\n\n\nR 4 Biostatistics | MITGEST::training(2024)"
  },
  {
    "objectID": "practice/lab04_intro_ML.html",
    "href": "practice/lab04_intro_ML.html",
    "title": "Lab 4: Intro to machine learning",
    "section": "",
    "text": "View slides in full screen"
  },
  {
    "objectID": "practice/lab04_intro_ML.html#practice-session-4-input-data-as-subfolder",
    "href": "practice/lab04_intro_ML.html#practice-session-4-input-data-as-subfolder",
    "title": "Lab 4: Intro to machine learning",
    "section": "Practice session 4: input data (as subfolder)",
    "text": "Practice session 4: input data (as subfolder)"
  },
  {
    "objectID": "practice/lab04_intro_ML.html#practice-session-4-r-code-as-.r-file",
    "href": "practice/lab04_intro_ML.html#practice-session-4-r-code-as-.r-file",
    "title": "Lab 4: Intro to machine learning",
    "section": "Practice session 4: R code (as .R file)",
    "text": "Practice session 4: R code (as .R file)"
  },
  {
    "objectID": "practice/lab02_inference.html",
    "href": "practice/lab02_inference.html",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "",
    "text": "View slides in full screen"
  },
  {
    "objectID": "practice/lab02_inference.html#practice-session-2-input-data-as-subfolder",
    "href": "practice/lab02_inference.html#practice-session-2-input-data-as-subfolder",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Practice session 2: input data (as subfolder)",
    "text": "Practice session 2: input data (as subfolder)\n\n\n\n Download input data directory"
  },
  {
    "objectID": "practice/lab02_inference.html#practice-session-2-r-code-as-.r-file",
    "href": "practice/lab02_inference.html#practice-session-2-r-code-as-.r-file",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Practice session 2: R code (as .R file)",
    "text": "Practice session 2: R code (as .R file)\n\n\n\n Download Lab session 2 as .R file"
  },
  {
    "objectID": "me.html",
    "href": "me.html",
    "title": "About the Instructor",
    "section": "",
    "text": "Caution\n\n\n\n\n\nWebsite construction in progress…"
  },
  {
    "objectID": "me.html#education",
    "href": "me.html#education",
    "title": "About the Instructor",
    "section": "Education",
    "text": "Education\nUniversità degli Studi di Pavia | Pavia, Italy Master of Biostatistics and Epidemiology | 2018-2019\nUniversità degli Studi di Milano | Milano, Italy Ph.D. in Chemical Sciences | 2001 - 2003\nInstitut National de la Recherche Agronomique | Versailles-Grignon, France Visiting scholar | 2003 - 2003\nUniversità degli Studi di Pavia | Pavia, Italy BSc Degree in Chemistry | 1994 - 2000\nUniversiteit Leiden | Leiden, The Netherlands Erasmus exchange student (6 months) | 1999 - 1999"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#collaborators",
    "href": "lectures_slides/000_exe_mine.html#collaborators",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "collaborators",
    "text": "collaborators\n\nJohanna Hardin, Pomona College\nBenjamin S. Baumer, Smith College\nAmelia McNamara, University of St Thomas\nNicholas J. Horton, Amherst College\nColin W. Rundel, Duke University"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#setting-the-scene",
    "href": "lectures_slides/000_exe_mine.html#setting-the-scene",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "setting the scene",
    "text": "setting the scene\n\n\n\nAssumption 1:\nTeach authentic tools\n\n\nAssumption 2:\nTeach R as the authentic tool"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#takeaway",
    "href": "lectures_slides/000_exe_mine.html#takeaway",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "takeaway",
    "text": "takeaway\n\n\nThe tidyverse provides an effective and efficient pathway for undergraduate students at all levels and majors to gain computational skills and thinking needed throughout the data science cycle.\n\n\n\nÇetinkaya-Rundel, M., Hardin, J., Baumer, B. S., McNamara, A., Horton, N. J., & Rundel, C. (2021). An educator’s perspective of the tidyverse. arXiv preprint arXiv:2108.03510. arxiv.org/abs/2108.03510"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#tidyverse",
    "href": "lectures_slides/000_exe_mine.html#tidyverse",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "tidyverse",
    "text": "tidyverse\n\n\n\nmeta R package that loads eight core packages when invoked and also bundles numerous other packages upon installation\ntidyverse packages share a design philosophy, common grammar, and data structures"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#tidyverse-flow",
    "href": "lectures_slides/000_exe_mine.html#tidyverse-flow",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "tidyverse flow",
    "text": "tidyverse flow"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#setup",
    "href": "lectures_slides/000_exe_mine.html#setup",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "setup",
    "text": "setup\nData: Thousands of loans made through the Lending Club, a peer-to-peer lending platform available in the openintro package, with a few modifications.\n\nlibrary(tidyverse)\nlibrary(openintro)\n\nloans &lt;- loans_full_schema %&gt;%\n  mutate(\n    homeownership = str_to_title(homeownership), \n    bankruptcy = if_else(public_record_bankrupt &gt;= 1, \"Yes\", \"No\")\n  ) %&gt;%\n  filter(annual_income &gt;= 10) %&gt;%\n  select(\n    loan_amount, homeownership, bankruptcy,\n    application_type, annual_income, interest_rate\n  )"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#start-with-a-data-frame",
    "href": "lectures_slides/000_exe_mine.html#start-with-a-data-frame",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "start with a data frame",
    "text": "start with a data frame\n\nloans\n\n# A tibble: 9,976 × 6\n  loan_amount homeownership bankruptcy application_type annual_income\n        &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;      &lt;fct&gt;                    &lt;dbl&gt;\n1       28000 Mortgage      No         individual               90000\n2        5000 Rent          Yes        individual               40000\n3        2000 Rent          No         individual               40000\n4       21600 Rent          No         individual               30000\n5       23000 Rent          No         joint                    35000\n6        5000 Own           No         individual               34000\n# ℹ 9,970 more rows\n# ℹ 1 more variable: interest_rate &lt;dbl&gt;"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#tidy-data",
    "href": "lectures_slides/000_exe_mine.html#tidy-data",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "tidy data",
    "text": "tidy data\n\nEach variable forms a column\nEach observation forms a row\nEach type of observational unit forms a table\n\n\n\nWickham, H. . (2014). Tidy Data. Journal of Statistical Software, 59(10), 1–23. doi.org/10.18637/jss.v059.i10."
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#task-calculate-a-summary-statistic",
    "href": "lectures_slides/000_exe_mine.html#task-calculate-a-summary-statistic",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "task: calculate a summary statistic",
    "text": "task: calculate a summary statistic\n\nCalculate the mean loan amount.\n\n\nloans\n\n# A tibble: 9,976 × 6\n  loan_amount homeownership bankruptcy application_type annual_income\n        &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;      &lt;fct&gt;                    &lt;dbl&gt;\n1       28000 Mortgage      No         individual               90000\n2        5000 Rent          Yes        individual               40000\n3        2000 Rent          No         individual               40000\n4       21600 Rent          No         individual               30000\n5       23000 Rent          No         joint                    35000\n6        5000 Own           No         individual               34000\n# ℹ 9,970 more rows\n# ℹ 1 more variable: interest_rate &lt;dbl&gt;\n\n\n\n\nmean(loan_amount)\n\n\n\n\n\nError in mean(loan_amount): object 'loan_amount' not found"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#accessing-a-variable",
    "href": "lectures_slides/000_exe_mine.html#accessing-a-variable",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "accessing a variable",
    "text": "accessing a variable\nApproach 1: With attach():\n\nattach(loans)\nmean(loan_amount)\n\n[1] 16357.53\n\n\n\n\nNot recommended. What if you had another data frame you’re working with concurrently called car_loans that also had a variable called loan_amount in it?"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#accessing-a-variable-1",
    "href": "lectures_slides/000_exe_mine.html#accessing-a-variable-1",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "accessing a variable",
    "text": "accessing a variable\nApproach 2: Using $:\n\nmean(loans$loan_amount)\n\n[1] 16357.53\n\n\n\n\nApproach 3: Using with():\n\nwith(loans, mean(loan_amount))\n\n[1] 16357.53"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#accessing-a-variable-2",
    "href": "lectures_slides/000_exe_mine.html#accessing-a-variable-2",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "accessing a variable",
    "text": "accessing a variable\nApproach 4: The tidyverse approach:\n\nloans %&gt;%\n  summarise(mean_loan_amount = mean(loan_amount))\n\n# A tibble: 1 × 1\n  mean_loan_amount\n             &lt;dbl&gt;\n1           16358.\n\n\n\n\nMore verbose\nBut also more expressive and extensible"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#the-tidyverse-approach",
    "href": "lectures_slides/000_exe_mine.html#the-tidyverse-approach",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "the tidyverse approach",
    "text": "the tidyverse approach\n\n\ntidyverse functions take a data argument that allows them to localize computations inside the specified data frame\ndoes not muddy the concept of what is in the current environment: variables always accessed from within in a data frame without the use of an additional function (like with()) or quotation marks, never as a vector"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#task-grouped-summary",
    "href": "lectures_slides/000_exe_mine.html#task-grouped-summary",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "task: grouped summary",
    "text": "task: grouped summary\n\nBased on the applicants’ home ownership status, compute the average loan amount and the number of applicants. Display the results in descending order of average loan amount.\n\n\n\n\n\n\n\n\nHomeownership\nNumber of applicants\nAverage loan amount\n\n\n\nMortgage\n$18,132\n4,778\n\n\nOwn\n$15,665\n1,350\n\n\nRent\n$14,396\n3,848"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#break-it-down-i",
    "href": "lectures_slides/000_exe_mine.html#break-it-down-i",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "break it down I",
    "text": "break it down I\n\n\nBased on the applicants’ home ownership status, compute the average loan amount and the number of applicants. Display the results in descending order of average loan amount.\n\n\nloans\n\n# A tibble: 9,976 × 6\n  loan_amount homeownership bankruptcy application_type annual_income\n        &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;      &lt;fct&gt;                    &lt;dbl&gt;\n1       28000 Mortgage      No         individual               90000\n2        5000 Rent          Yes        individual               40000\n3        2000 Rent          No         individual               40000\n4       21600 Rent          No         individual               30000\n5       23000 Rent          No         joint                    35000\n6        5000 Own           No         individual               34000\n# ℹ 9,970 more rows\n# ℹ 1 more variable: interest_rate &lt;dbl&gt;"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#break-it-down-ii",
    "href": "lectures_slides/000_exe_mine.html#break-it-down-ii",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "break it down II",
    "text": "break it down II\n\n\nBased on the applicants’ home ownership status, compute the average loan amount and the number of applicants. Display the results in descending order of average loan amount.\n\n\n\n[input] data frame\n\n\n\n\nloans %&gt;%\n  group_by(homeownership)\n\n# A tibble: 9,976 × 6\n# Groups:   homeownership [3]\n  loan_amount homeownership bankruptcy application_type annual_income\n        &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;      &lt;fct&gt;                    &lt;dbl&gt;\n1       28000 Mortgage      No         individual               90000\n2        5000 Rent          Yes        individual               40000\n3        2000 Rent          No         individual               40000\n4       21600 Rent          No         individual               30000\n5       23000 Rent          No         joint                    35000\n6        5000 Own           No         individual               34000\n# ℹ 9,970 more rows\n# ℹ 1 more variable: interest_rate &lt;dbl&gt;\n\n\n\n\n\ndata frame [output]"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#break-it-down-iii",
    "href": "lectures_slides/000_exe_mine.html#break-it-down-iii",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "break it down III",
    "text": "break it down III\n\n\nBased on the applicants’ home ownership status, compute the average loan amount and the number of applicants. Display the results in descending order of average loan amount.\n\n\nloans %&gt;%\n  group_by(homeownership) %&gt;% \n  summarize(\n    avg_loan_amount = mean(loan_amount)\n    )\n\n# A tibble: 3 × 2\n  homeownership avg_loan_amount\n  &lt;chr&gt;                   &lt;dbl&gt;\n1 Mortgage               18132.\n2 Own                    15665.\n3 Rent                   14396."
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#break-it-down-iv",
    "href": "lectures_slides/000_exe_mine.html#break-it-down-iv",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "break it down IV",
    "text": "break it down IV\n\n\nBased on the applicants’ home ownership status, compute the average loan amount and the number of applicants. Display the results in descending order of average loan amount.\n\n\nloans %&gt;%\n  group_by(homeownership) %&gt;% \n  summarize(\n    avg_loan_amount = mean(loan_amount),\n    n_applicants = n()\n    )\n\n# A tibble: 3 × 3\n  homeownership avg_loan_amount n_applicants\n  &lt;chr&gt;                   &lt;dbl&gt;        &lt;int&gt;\n1 Mortgage               18132.         4778\n2 Own                    15665.         1350\n3 Rent                   14396.         3848"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#break-it-down-v",
    "href": "lectures_slides/000_exe_mine.html#break-it-down-v",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "break it down V",
    "text": "break it down V\n\n\nBased on the applicants’ home ownership status, compute the average loan amount and the number of applicants. Display the results in descending order of average loan amount.\n\n\nloans %&gt;%\n  group_by(homeownership) %&gt;% \n  summarize(\n    avg_loan_amount = mean(loan_amount),\n    n_applicants = n()\n    ) %&gt;%\n  arrange(desc(avg_loan_amount))\n\n# A tibble: 3 × 3\n  homeownership avg_loan_amount n_applicants\n  &lt;chr&gt;                   &lt;dbl&gt;        &lt;int&gt;\n1 Mortgage               18132.         4778\n2 Own                    15665.         1350\n3 Rent                   14396.         3848"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#putting-it-back-together",
    "href": "lectures_slides/000_exe_mine.html#putting-it-back-together",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "putting it back together",
    "text": "putting it back together\n\n[input] data frame\n\n\nloans %&gt;%\n  group_by(homeownership) %&gt;% \n  summarize(\n    avg_loan_amount = mean(loan_amount),\n    n_applicants = n()\n    ) %&gt;%\n  arrange(desc(avg_loan_amount))\n\n# A tibble: 3 × 3\n  homeownership avg_loan_amount n_applicants\n  &lt;chr&gt;                   &lt;dbl&gt;        &lt;int&gt;\n1 Mortgage               18132.         4778\n2 Own                    15665.         1350\n3 Rent                   14396.         3848\n\n\n\n[output] data frame"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#grouped-summary-with-aggregate",
    "href": "lectures_slides/000_exe_mine.html#grouped-summary-with-aggregate",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "grouped summary with aggregate()\n",
    "text": "grouped summary with aggregate()\n\n\nres1 &lt;- aggregate(loan_amount ~ homeownership, \n                  data = loans, FUN = length)\nres1\n\n  homeownership loan_amount\n1      Mortgage        4778\n2           Own        1350\n3          Rent        3848\n\nnames(res1)[2] &lt;- \"n_applicants\"\nres1\n\n  homeownership n_applicants\n1      Mortgage         4778\n2           Own         1350\n3          Rent         3848"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#grouped-summary-with-aggregate-1",
    "href": "lectures_slides/000_exe_mine.html#grouped-summary-with-aggregate-1",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "grouped summary with aggregate()\n",
    "text": "grouped summary with aggregate()\n\n\nres2 &lt;- aggregate(loan_amount ~ homeownership, \n                  data = loans, FUN = mean)\nnames(res2)[2] &lt;- \"avg_loan_amount\"\n\nres2\n\n  homeownership avg_loan_amount\n1      Mortgage        18132.45\n2           Own        15665.44\n3          Rent        14396.44\n\n\n\n\nres &lt;- merge(res1, res2)\nres[order(res$avg_loan_amount, decreasing = TRUE), ]\n\n  homeownership n_applicants avg_loan_amount\n1      Mortgage         4778        18132.45\n2           Own         1350        15665.44\n3          Rent         3848        14396.44"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#grouped-summary-with-aggregate-2",
    "href": "lectures_slides/000_exe_mine.html#grouped-summary-with-aggregate-2",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "grouped summary with aggregate()\n",
    "text": "grouped summary with aggregate()\n\n\n\nres1 &lt;- aggregate(loan_amount ~ homeownership, data = loans, FUN = length)\nnames(res1)[2] &lt;- \"n_applicants\"\nres2 &lt;- aggregate(loan_amount ~ homeownership, data = loans, FUN = mean)\nnames(res2)[2] &lt;- \"avg_loan_amount\"\nres &lt;- merge(res1, res2)\nres[order(res$avg_loan_amount, decreasing = TRUE), ]\n\n\n\n\n\nGood: Inputs and outputs are data frames\n\nNot so good: Need to introduce\n\nformula syntax\npassing functions as arguments\nmerging datasets\nsquare bracket notation for accessing rows"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#grouped-summary-with-tapply",
    "href": "lectures_slides/000_exe_mine.html#grouped-summary-with-tapply",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "grouped summary with tapply()\n",
    "text": "grouped summary with tapply()\n\n\nsort(\n  tapply(loans$loan_amount, loans$homeownership, mean),\n  decreasing = TRUE\n  )\n\nMortgage      Own     Rent \n18132.45 15665.44 14396.44 \n\n\n\n\nNot so good:\n\npassing functions as arguments\ndistinguishing between the various apply() functions\nending up with a new data structure (array)\nreading nested functions"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#task-data-visualization",
    "href": "lectures_slides/000_exe_mine.html#task-data-visualization",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "task: data visualization",
    "text": "task: data visualization\n\nCreate side-by-side box plots that shows the relationship between loan amount and application type, faceted by homeownership."
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#break-it-down-i-1",
    "href": "lectures_slides/000_exe_mine.html#break-it-down-i-1",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "break it down I",
    "text": "break it down I\n\n\nCreate side-by-side box plots that shows the relationship between annual income and application type, faceted by homeownership.\n\n\nggplot(loans)"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#break-it-down-ii-1",
    "href": "lectures_slides/000_exe_mine.html#break-it-down-ii-1",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "break it down II",
    "text": "break it down II\n\n\nCreate side-by-side box plots that shows the relationship between annual income and application type, faceted by homeownership.\n\n\nggplot(loans, \n       aes(x = application_type))"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#break-it-down-iii-1",
    "href": "lectures_slides/000_exe_mine.html#break-it-down-iii-1",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "break it down III",
    "text": "break it down III\n\n\nCreate side-by-side box plots that shows the relationship between annual income and application type, faceted by homeownership.\n\n\nggplot(loans, \n       aes(x = application_type,\n           y = loan_amount))"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#break-it-down-iv-1",
    "href": "lectures_slides/000_exe_mine.html#break-it-down-iv-1",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "break it down IV",
    "text": "break it down IV\n\n\nCreate side-by-side box plots that shows the relationship between annual income and application type, faceted by homeownership.\n\n\nggplot(loans, \n       aes(x = application_type,\n           y = loan_amount)) +\n  geom_boxplot()"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#break-it-down-iv-2",
    "href": "lectures_slides/000_exe_mine.html#break-it-down-iv-2",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "break it down IV",
    "text": "break it down IV\n\n\nCreate side-by-side box plots that shows the relationship between annual income and application type, faceted by homeownership.\n\n\nggplot(loans, \n       aes(x = application_type,\n           y = loan_amount)) +\n  geom_boxplot() +\n  facet_wrap(~ homeownership)"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#plotting-with-ggplot",
    "href": "lectures_slides/000_exe_mine.html#plotting-with-ggplot",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "plotting with ggplot()\n",
    "text": "plotting with ggplot()\n\n\nggplot(loans, \n       aes(x = application_type, y = loan_amount)) +\n  geom_boxplot() +\n  facet_wrap(~ homeownership)\n\n\n\nEach layer produces a valid plot\nFaceting by a third variable takes only one new function"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#plotting-with-boxplot",
    "href": "lectures_slides/000_exe_mine.html#plotting-with-boxplot",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "plotting with boxplot()\n",
    "text": "plotting with boxplot()\n\n\nlevels &lt;- sort(unique(loans$homeownership))\nlevels\n\n[1] \"Mortgage\" \"Own\"      \"Rent\"    \n\nloans1 &lt;- loans[loans$homeownership == levels[1],]\nloans2 &lt;- loans[loans$homeownership == levels[2],]\nloans3 &lt;- loans[loans$homeownership == levels[3],]"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#plotting-with-boxplot-1",
    "href": "lectures_slides/000_exe_mine.html#plotting-with-boxplot-1",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "plotting with boxplot()\n",
    "text": "plotting with boxplot()\n\n\npar(mfrow = c(1, 3))\n\nboxplot(loan_amount ~ application_type, \n        data = loans1, main = levels[1])\nboxplot(loan_amount ~ application_type, \n        data = loans2, main = levels[2])\nboxplot(loan_amount ~ application_type, \n        data = loans3, main = levels[3])"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#visualizing-a-different-relationship",
    "href": "lectures_slides/000_exe_mine.html#visualizing-a-different-relationship",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "visualizing a different relationship",
    "text": "visualizing a different relationship\n\nVisualize the relationship between interest rate and annual income, conditioned on whether the applicant had a bankruptcy."
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#plotting-with-ggplot-1",
    "href": "lectures_slides/000_exe_mine.html#plotting-with-ggplot-1",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "plotting with ggplot()\n",
    "text": "plotting with ggplot()\n\n\nggplot(loans, \n       aes(y = interest_rate, x = annual_income, \n           color = bankruptcy)) +\n  geom_point(alpha = 0.1) + \n  geom_smooth(method = \"lm\", linewidth = 2, se = FALSE) + \n  scale_x_log10()"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#further-customizing-ggplot",
    "href": "lectures_slides/000_exe_mine.html#further-customizing-ggplot",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "further customizing ggplot()\n",
    "text": "further customizing ggplot()\n\n\nggplot(loans, \n       aes(y = interest_rate, x = annual_income, \n           color = bankruptcy)) +\n  geom_point(alpha = 0.1) + \n  geom_smooth(method = \"lm\", linewidth = 2, se = FALSE) + \n  scale_x_log10(labels = scales::label_dollar()) +\n  scale_y_continuous(labels = scales::label_percent(scale = 1)) +\n  scale_color_OkabeIto() +\n  labs(x = \"Annual Income\", y = \"Interest Rate\", \n       color = \"Previous\\nBankruptcy\") +\n  theme_minimal(base_size = 18)"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#plotting-with-plot",
    "href": "lectures_slides/000_exe_mine.html#plotting-with-plot",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "plotting with plot()\n",
    "text": "plotting with plot()\n\n\n# From the OkabeIto palette\ncols = c(No = \"#e6a003\", Yes = \"#57b4e9\")\n\nplot(\n  loans$annual_income,\n  loans$interest_rate,\n  pch = 16,\n  col = adjustcolor(cols[loans$bankruptcy], alpha.f = 0.1),\n  log = \"x\",\n  xlab = \"Annual Income ($)\",\n  ylab = \"Interest Rate (%)\",\n  xaxp = c(1000, 10000000, 1)\n)\n\nlm_b_no = lm(\n  interest_rate ~ log10(annual_income), \n  data = loans[loans$bankruptcy == \"No\",]\n)\nlm_b_yes = lm(\n  interest_rate ~ log10(annual_income), \n  data = loans[loans$bankruptcy == \"Yes\",]\n)\n\nabline(lm_b_no, col = cols[\"No\"], lwd = 3)\nabline(lm_b_yes, col = cols[\"Yes\"], lwd = 3)\n\nlegend(\n  \"topright\", \n  legend = c(\"Yes\", \"No\"), \n  title = \"Previous\\nBankruptcy\", \n  col = cols[c(\"Yes\", \"No\")], \n  pch = 16, lwd = 1\n)"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#plotting-with-plot-1",
    "href": "lectures_slides/000_exe_mine.html#plotting-with-plot-1",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "plotting with plot()\n",
    "text": "plotting with plot()"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#beyond-wrangling-summaries-visualizations",
    "href": "lectures_slides/000_exe_mine.html#beyond-wrangling-summaries-visualizations",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "beyond wrangling, summaries, visualizations",
    "text": "beyond wrangling, summaries, visualizations\nModeling and inference with tidymodels:\n\nA unified interface to modeling functions available in a large variety of packages\nSticking to the data frame in / data frame out paradigm\nGuardrails for methodology"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#consistency",
    "href": "lectures_slides/000_exe_mine.html#consistency",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "consistency",
    "text": "consistency\n\nNo matter which approach or tool you use, you should strive to be consistent in the classroom whenever possible\ntidyverse offers consistency, something we believe to be of the utmost importance, allowing students to move knowledge about function arguments to their long-term memory"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#teaching-consistently",
    "href": "lectures_slides/000_exe_mine.html#teaching-consistently",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "teaching consistently",
    "text": "teaching consistently\n\nChallenge: Google and Stack Overflow can be less useful – demo problem solving\nCounter-proposition: teach all (or multiple) syntaxes at once – trying to teach two (or more!) syntaxes at once will slow the pace of the course, introduce unnecessary syntactic confusion, and make it harder for students to complete their work.\n“Disciplined in what we teach, liberal in what we accept”\n\n\n\nPostel, J. (1980). DoD standard internet protocol. ACM SIGCOMM Computer Communication Review, 10(4), 12-51. datatracker.ietf.org/doc/html/rfc760"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#mixability",
    "href": "lectures_slides/000_exe_mine.html#mixability",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "mixability",
    "text": "mixability\n\nMix with base R code or code from other packages\nIn fact, you can’t not mix with base R code!"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#scalability",
    "href": "lectures_slides/000_exe_mine.html#scalability",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "scalability",
    "text": "scalability\nAdding a new variable to a visualization or a new summary statistic doesn’t require introducing a numerous functions, interfaces, and data structures"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#user-centered-design",
    "href": "lectures_slides/000_exe_mine.html#user-centered-design",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "user-centered design",
    "text": "user-centered design\n\nInterfaces designed with user experience (and learning) in mind\nContinuous feedback collection and iterative improvements based on user experiences improve functions’ and packages’ usability (and learnability)"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#readability",
    "href": "lectures_slides/000_exe_mine.html#readability",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "readability",
    "text": "readability\nInterfaces that are designed to produce readable code"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#community",
    "href": "lectures_slides/000_exe_mine.html#community",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "community",
    "text": "community\n\nThe encouraging and inclusive tidyverse community is one of the benefits of the paradigm\nEach package comes with a website, each of these websites are similarly laid out, and results of example code are displayed, and extensive vignettes describe how to use various functions from the package together"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#shared-syntax",
    "href": "lectures_slides/000_exe_mine.html#shared-syntax",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "shared syntax",
    "text": "shared syntax\nGet SQL for free with dplyr verbs!"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#building-a-curriculum",
    "href": "lectures_slides/000_exe_mine.html#building-a-curriculum",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "building a curriculum",
    "text": "building a curriculum\n\nStart with library(tidyverse)\nTeach by learning goals, not packages"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#keeping-up-with-the-tidyverse",
    "href": "lectures_slides/000_exe_mine.html#keeping-up-with-the-tidyverse",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "keeping up with the tidyverse",
    "text": "keeping up with the tidyverse\n\nBlog posts highlight updates, along with the reasoning behind them and worked examples\n\nLifecycle stages and badges"
  },
  {
    "objectID": "lectures_slides/000_exe_mine.html#coda",
    "href": "lectures_slides/000_exe_mine.html#coda",
    "title": "Day 2: Inference and Hypothesis testing",
    "section": "coda",
    "text": "coda\n\n\n\nWe are all converts to the tidyverse and have made a conscious choice to use it in our research and our teaching. We each learned R without the tidyverse and have all spent quite a few years teaching without it at a variety of levels from undergraduate introductory statistics courses to graduate statistical computing courses. This paper is a synthesis of the reasons supporting our tidyverse choice, along with benefits and challenges associated with teaching statistics with the tidyverse.\n\n\n\n\n\n\n\nÇetinkaya-Rundel, M., Hardin, J., Baumer, B. S., McNamara, A., Horton, N. J., & Rundel, C. (2021). An educator’s perspective of the tidyverse. arXiv preprint arXiv:2108.03510. arxiv.org/abs/2108.03510"
  },
  {
    "objectID": "lectures/lec03_corr_regress.html",
    "href": "lectures/lec03_corr_regress.html",
    "title": "Modeling correlation and regression",
    "section": "",
    "text": "View slides in full screen"
  },
  {
    "objectID": "lectures/lec03_corr_regress.html#lecture-3-outline",
    "href": "lectures/lec03_corr_regress.html#lecture-3-outline",
    "title": "Modeling correlation and regression",
    "section": "Lecture 3 Outline",
    "text": "Lecture 3 Outline\n\nTesting for a correlation hypothesis (relationship of variables)\n\nPearson rho analysis (param)\nSpearman test (no param)\n\nMeasures of association\n\nFisher’s Exact Test\nChi-Square Test of Independence\n\nFrom association to prediction -&gt; Machine learning algorithms\n\nSupervised ML\n\nExamples"
  },
  {
    "objectID": "lectures/lec01_data_with_R.html",
    "href": "lectures/lec01_data_with_R.html",
    "title": "Lecture 1: Intro to R and data analysis",
    "section": "",
    "text": "View slides in full screen"
  },
  {
    "objectID": "lectures/lec01_data_with_R.html#lecture-1-outline",
    "href": "lectures/lec01_data_with_R.html#lecture-1-outline",
    "title": "Lecture 1: Intro to R and data analysis",
    "section": "Lecture 1 Outline",
    "text": "Lecture 1 Outline\n\nIntroduction to R and R-studio\n\nWhy R?\nPrinciples of reproducible analysis with R + RStudio\n\nR objects, functions, packages\nUnderstanding different types of variables\n\nPrinciples of “tidy data”\nData cleaning and manipulation\n\nDescriptive statistics\n\nMeasures of central tendency, measures of variability (or spread), and\n\nFrequency distribution\nVisual data exploration\n\n{ggplot2}"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Intro to Biostatistics with R",
    "section": "",
    "text": "Caution\n\n\n\n\n\nWebsite construction in progress…\n\n\n\nWelcome!\nThis website collects the materials for a four day workshop organized by MITGEST Doctoral Network in July 2024, hosted by the Radboud Center for Mitochondrial Medicine, Nijmegen, Netherlands.\n\n\nLocation: Radboud Center for Mitochondrial Medicine, xxxxx Nijmegen, Netherland\n\nTime: 9 am - 5 pm July 24th to July 27th, 2024\nWorkshop Overview\nThis Biostatistics workshop provides an introduction to selected topics in biostatistical concepts and reasoning. This course aims to introduce to the field and gives a solid understanding of data and data types, statistical inference and survey design applied to life sciences.\nSpecific topics covered include: tools for describing central tendency and variability in data; methods for performing inference on population means and proportions via sample data; statistical hypothesis testing and its application to group comparisons; issues of power and sample size in study designs; elements of machine learning algorithms for understanding data.\nWhile there are some formulae and computational elements to the course, the emphasis is on applications of acquired concepts to “real life” of research scientists.\nThough the vast majority of what you will learn in this course can be applied in any software package, the seminar will mostly use R for empirical examples and exercises.\n\n\n\n\n\n\nSchedule\n\n\n\n\nTentative Schedule\n\nDay\nTime\nActivity\nLocation\n\n\n\n24 July, 2024\n9am - 12am\nLesson 1 ~ Working with data (in R)\nBuilding ??, Room ?\n\n\n\"\"\n2pm - 5pm\nPractice Session 1\nBuilding ??, Room ?\n\n\n25 July, 2024\n9am - 12am\nLesson 2 ~ Inference\nBuilding ??, Room ?\n\n\n\"\"\n2pm - 5pm\nPractice Session 2\nBuilding ??, Room ?\n\n\n26 July, 2024\n9am - 12am\nLesson 3 ~ Modeling correlation and regression\nBuilding ??, Room ?\n\n\n\"\"\n2pm - 5pm\nPractice Session 3\nBuilding ??, Room ?\n\n\n27 July, 2024\n9am - 12am\nLesson 4 ~ Intro to machine learning\nBuilding ??, Room ?\n\n\n\"\"\n2pm - 5pm\nPractice Session 4\nBuilding ??, Room ?\n\n\n\n\n\n\nHot & cold drinks will be served during the morning breaks.\nPractical information\nPlease, do bring your laptop as no computer will be available.\nAlso, please make sure to have the required software installed ahead of the workshop. You can find step-by-step instructions here."
  },
  {
    "objectID": "install.html",
    "href": "install.html",
    "title": "Installation and setup",
    "section": "",
    "text": "Caution\n\n\n\n\n\nWebsite construction in progress…\nThis workshop showcases introductory bio statistics concepts using the open source (and free!) programming language . Each session of the workshop features exercises that will help you learn by doing.\nWe will quickly go over this at our first Practice session, but you are expected to have the required software installed on your machine before the workshop.\nBelow is a step by step process that should guide you through the needed installation steps."
  },
  {
    "objectID": "install.html#useful-keyboard-shortcuts-in-rstudio",
    "href": "install.html#useful-keyboard-shortcuts-in-rstudio",
    "title": "Installation and setup",
    "section": "Useful keyboard shortcuts in RStudio",
    "text": "Useful keyboard shortcuts in RStudio\n\n\n\n\n\n\nDescription\nWindows & Linux\nMac\n\n\n\nInsert code section\nCtrl+Shift+R\nShift+Command+R  or Ctrl+Shift+R\n\n\nRun current line/selection\nCtrl+Enter\nCommand+Return\n\n\nReindent lines\nCtrl+I\nCommand+I\n\n\nInsert &lt;- operator\nAlt+-\nOption+-\n\n\nInsert %&gt;% operator\nCtrl+Shift+M\nShift+Command+M\n\n\nCode completion\nTab\nTab\n\n\nFile path completion (console)\n\"+Tab\n\"+Tab\n\n\n\n\n\n\nHere you find the complete list of RStudio Keyboard Shortcuts"
  },
  {
    "objectID": "lectures/lec02_inference.html",
    "href": "lectures/lec02_inference.html",
    "title": "Statistical inference & hypothesis testing",
    "section": "",
    "text": "View slides in full screen"
  },
  {
    "objectID": "lectures/lec02_inference.html#lecture-2-outline",
    "href": "lectures/lec02_inference.html#lecture-2-outline",
    "title": "Statistical inference & hypothesis testing",
    "section": "Lecture 2 Outline",
    "text": "Lecture 2 Outline\n\nPurpose and foundations of inferential statistics\n\nProbability and random variables\nMeaningful probability distributions\nSampling distributions and Central Limit Theorem\n\nGetting to know the “language” of hypothesis testing\n\nThe null and alternative hypothesis\nThe probability of error? (α or “significance level”)\nThe p-value probability and tests interpretation\nConfidence Intervals\nTypes of errors (Type 1 and Type 2)\nEffective vs statistical significance\n\nHypothesis tests examples\n\nComparing sample mean to a hypothesized population mean (Z test & t test)\nComparing two independent sample means (t test)\nComparing sample means from 3 or more groups (ANOVA) \n\nA closer look at testing assumptions (with examples)\n\nTesting two groups that are not independent\nTesting if the data are not normally distributed: non-parametric tests\nTesting samples without homogeneous variance of observations"
  },
  {
    "objectID": "lectures/lec04_intro_ML.html",
    "href": "lectures/lec04_intro_ML.html",
    "title": "Intro to machine learning",
    "section": "",
    "text": "View slides in full screen"
  },
  {
    "objectID": "lectures/lec04_intro_ML.html#lecture-4-outline",
    "href": "lectures/lec04_intro_ML.html#lecture-4-outline",
    "title": "Intro to machine learning",
    "section": "Lecture 4 Outline",
    "text": "Lecture 4 Outline\n\nFrom association to prediction -&gt; Machine learning algorithms\n\nUnsupervised ML\n\nExamples\n\n\nElements of Statistical Power analysis\nUseful R resources for metabolomics"
  },
  {
    "objectID": "license_etc.html",
    "href": "license_etc.html",
    "title": "Acknowledgments and use of the course materials",
    "section": "",
    "text": "Caution\n\n\n\n\n\nWebsite construction in progress…"
  },
  {
    "objectID": "license_etc.html#acknowledgements",
    "href": "license_etc.html#acknowledgements",
    "title": "Acknowledgments and use of the course materials",
    "section": "Acknowledgements",
    "text": "Acknowledgements\n\n\nI developed this course with a major contribution from Luisa M. Mimmi (my sister!), who co-created the practice labs and built this website.\nWe are genuinely grateful to many people within the Biostatistics, Epidemiology and R programming communities who shared their valuable work and teaching materials. Below is a curated list of great resources (many of which free and openly accessible).\n\nWe would love to hear your feedback, questions, or suggestions about the workshop materials:\n\n    contact us"
  },
  {
    "objectID": "license_etc.html#licensing-and-use-of-the-course-materials",
    "href": "license_etc.html#licensing-and-use-of-the-course-materials",
    "title": "Acknowledgments and use of the course materials",
    "section": "Licensing and use of the course materials",
    "text": "Licensing and use of the course materials\nThe course materials are licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. All borrowed external materials (images, examples, etc.), are credited with proper “Source:” statements and governed by their own licenses. We mostly drew from sources that were published under “open access” or “creative commons” frameworks. If this were not the case for any of material displayed here, please let us know and we will remove it."
  },
  {
    "objectID": "license_etc.html#list-of-great-resources",
    "href": "license_etc.html#list-of-great-resources",
    "title": "Acknowledgments and use of the course materials",
    "section": "List of great resources",
    "text": "List of great resources\n\n\nBiostatistics/Epidemiology with R examples\n\nApplied Epi Team (2024). Applied Epi - Elevating frontline epidemiology [Course]. Training, support, tools. https://www.appliedepi.org/\nApplied Epi Team (2024). R for applied epidemiology and public health The Epidemiologist R Handbook [Course]. https://epirhandbook.com/en/\nBobbitt, Z. (2024). Statology [Course]. Statology. https://www.statology.org/\nSelby, D., & 2021 (2024). Analytical Epidemiology II [Course]. David Selby. https://personalpages.manchester.ac.uk/staff/david.selby/analysis/2021-03-30-inference/\nR packages & tools\n\nRStudio, & Posit (2024). Base-r-cheat-sheet.pdf [R]. https://iqss.github.io/dss-workshops/R/Rintro/base-r-cheat-sheet.pdf\nWickham, H., François, R., Müller, K., & Vaughan, D. (2023). Programming with dplyr [R]. dplyr. https://dplyr.tidyverse.org/articles/programming.html#tidy-selection\nWickham, H. (2014). Tidy Data [R]. Journal of Statistical Software, 59(10). https://doi.org/10.18637/jss.v059.i10\nSources of practice datasets\n\n\nChicco, D., & Jurman, G. (2020). Machine learning can predict survival of patients with heart failure from serum creatinine and ejection fraction alone [Dataset]. BMC Medical Informatics and Decision Making, 20(1), 16. https://doi.org/10.1186/s12911-020-1023-5\n\nAhmad, T., Munir, A., Bhatti, S. H., Aftab, M., & Raza, M. A. (2017). Survival analysis of heart failure patients: A case study [Dataset]. PLOS ONE, 12(7), e0181001. https://doi.org/10.1371/journal.pone.0181001"
  },
  {
    "objectID": "practice/lab01_data_with_R.html",
    "href": "practice/lab01_data_with_R.html",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "",
    "text": "View slides in full screen"
  },
  {
    "objectID": "practice/lab01_data_with_R.html#practice-session-1-input-data-as-subfolder",
    "href": "practice/lab01_data_with_R.html#practice-session-1-input-data-as-subfolder",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Practice session 1: input data (as subfolder)",
    "text": "Practice session 1: input data (as subfolder)\n\n\n Download input data 1"
  },
  {
    "objectID": "practice/lab01_data_with_R.html#practice-session-1-r-code-as-.r-file",
    "href": "practice/lab01_data_with_R.html#practice-session-1-r-code-as-.r-file",
    "title": "Lab 1: Intro to R and data analysis",
    "section": "Practice session 1: R code (as .R file)",
    "text": "Practice session 1: R code (as .R file)\n\n\n Download Lab session 1 as .R file"
  },
  {
    "objectID": "practice/lab03_corr_regress.html",
    "href": "practice/lab03_corr_regress.html",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "",
    "text": "View slides in full screen"
  },
  {
    "objectID": "practice/lab03_corr_regress.html#practice-session-3-input-data-as-subfolder",
    "href": "practice/lab03_corr_regress.html#practice-session-3-input-data-as-subfolder",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Practice session 3: input data (as subfolder)",
    "text": "Practice session 3: input data (as subfolder)"
  },
  {
    "objectID": "practice/lab03_corr_regress.html#practice-session-3-r-code-as-.r-file",
    "href": "practice/lab03_corr_regress.html#practice-session-3-r-code-as-.r-file",
    "title": "Lab 3: Modeling correlation and regression",
    "section": "Practice session 3: R code (as .R file)",
    "text": "Practice session 3: R code (as .R file)"
  },
  {
    "objectID": "practice/slides_lab00.html#workshop-topics",
    "href": "practice/slides_lab00.html#workshop-topics",
    "title": "Lab’s slides placeholder",
    "section": "WORKSHOP TOPICS",
    "text": "WORKSHOP TOPICS\n\nIntro to R and data analysis\n\nDescriptive statistics and visual data exploration\n\nStatistical inference & hypothesis testing\n\nprobability, CI, comparing 1 sample to population, comparing 2 samples, tests\n\nFrom association to prediction\n\nSupervised ML (regression)\n\nIntro to ML, elements of power analysis\n\nUnsupervised ML algorithm (PCA)"
  },
  {
    "objectID": "practice/slides_lab00.html#workshop-schedule",
    "href": "practice/slides_lab00.html#workshop-schedule",
    "title": "Lab’s slides placeholder",
    "section": "WORKSHOP SCHEDULE",
    "text": "WORKSHOP SCHEDULE\n\n4 days\nEach day will include:\n\nFrontal class (MORNING)\nPractical training with R about the topics discussed in the morning. (AFTERNOON)\n\n\n\n\n\nR 4 Biostatistics | MITGEST::training(2024)"
  },
  {
    "objectID": "practice/slides_lab02.html#goal-of-todays-practice-session",
    "href": "practice/slides_lab02.html#goal-of-todays-practice-session",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "GOAL OF TODAY’S PRACTICE SESSION",
    "text": "GOAL OF TODAY’S PRACTICE SESSION\nConsolidate understanding of inferential statistic, through R coding examples conducted on real biostatistics research data.\n\nLecture 2: topics\n\n\nPurpose and foundations of inferential statistics    \n\n\nGetting to know the “language” of hypothesis testing     \n\n\nHypothesis testing\n\nreview examples\n\n\n\n\nA closer look at testing assumptions\n\nmore examples dealing with assumptions’ violation"
  },
  {
    "objectID": "practice/slides_lab02.html#needed-r-packages",
    "href": "practice/slides_lab02.html#needed-r-packages",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Needed R Packages",
    "text": "Needed R Packages\n\n\nWe will use functions from packages base, utils, and stats (pre-installed and pre-loaded)\nWe will also use the packages below (specifying package::function for clarity).\n\n\n\n# Load them for this R session\n\n# General \nlibrary(fs)           # file/directory interactions\nlibrary(here)         # tools find your project's files, based on working directory\nlibrary(janitor)      # tools for examining and cleaning data\nlibrary(dplyr)        # {tidyverse} tools for manipulating and summarising tidy data \nlibrary(forcats)      # {tidyverse} tool for handling factors\n\n# Statistics\nlibrary(BSDA)   \nlibrary(rstatix)      # Pipe-Friendly Framework for Basic Statistical Tests\nlibrary(car)          # Companion to Applied Regression\nlibrary(multcomp)     # Simultaneous Inference in General Parametric Models \n\n# Plotting\nlibrary(ggplot2)      # {tidyverse} tools for plotting\nlibrary(ggstatsplot)  # 'ggplot2' Based Plots with Statistical Details \nlibrary(ggpubr)       # 'ggplot2' Based Publication Ready Plots \nlibrary(patchwork)    # Functions for \"\"Grid\" Graphics\"composing\" plots \nlibrary(viridis)      # Colorblind-Friendly Color Maps for R \nlibrary(ggthemes)    # Extra Themes, Scales and Geoms for 'ggplot2'"
  },
  {
    "objectID": "practice/slides_lab02.html#our-dataset-for-today",
    "href": "practice/slides_lab02.html#our-dataset-for-today",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Our dataset for today",
    "text": "Our dataset for today\nFor the most part, we will refer to a real clinical dataset (for which a Creative Commons license was granted) discussed in two articles (also open access) :\n\nAhmad, T., Munir, A., Bhatti, S. H., Aftab, M., & Raza, M. A. (2017). Survival analysis of heart failure patients: A case study. PLOS ONE, 12(7), e0181001. https://doi.org/10.1371/journal.pone.0181001\n\nChicco, D., & Jurman, G. (2020). Machine learning can predict survival of patients with heart failure from serum creatinine and ejection fraction alone. BMC Medical Informatics and Decision Making, 20(1), 16. https://doi.org/10.1186/s12911-020-1023-5\n\n\nHere is the link to the dataset (or download from workshop website)\n\nFrom the UC Irvine Machine Learning Repository Heart Failure Clinical Records"
  },
  {
    "objectID": "practice/slides_lab02.html#importing-from-your-project-folder-previously-downloaded-file",
    "href": "practice/slides_lab02.html#importing-from-your-project-folder-previously-downloaded-file",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Importing from your project folder (previously downloaded file)",
    "text": "Importing from your project folder (previously downloaded file)\n\n\n\n\n\n\nTip\n\n\nMake sure to match your own folder structure!\n\n\n\n\n\nThe function here lets me specify the complete path of the destination folder\n\n\n# Check my working directory location\n# here::here()\n\n# Use `here` in specifying all the subfolders AFTER the working directory \nheart_failure &lt;- read.csv(file = here::here(\"practice\", \"data_input\", \"02_datasets\",\n                                      \"heart_failure_clinical_records_dataset.csv\"), \n                          header = TRUE, # 1st line is the name of the variables\n                          sep = \",\", # which is the field separator character.\n                          na.strings = c(\"?\",\"NA\" ), # specific MISSING values  \n                          row.names = NULL)"
  },
  {
    "objectID": "practice/slides_lab02.html#what-are-the-variables-and-their-levels-of-measurement",
    "href": "practice/slides_lab02.html#what-are-the-variables-and-their-levels-of-measurement",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "What are the variables and their levels of measurement?",
    "text": "What are the variables and their levels of measurement?\n\nThe data, containing the medical records of 299 heart failure patient, were collected at the Faisalabad Institute of Cardiology and at the Allied Hospital in Faisalabad (Punjab, Pakistan), during April–December 2015.\nTable 1 from the second article (Chicco & Jurman, 2020, p. 3) offers a synthetic explanation of hte observed variables."
  },
  {
    "objectID": "practice/slides_lab02.html#look-into-the-dataset-just-loaded-in-the-r-environment",
    "href": "practice/slides_lab02.html#look-into-the-dataset-just-loaded-in-the-r-environment",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Look into the dataset just loaded in the R environment",
    "text": "Look into the dataset just loaded in the R environment\nRecall some base R functions from Lab 1\n\n# What variables are included in this dataset?\ncolnames(heart_failure)\n\n [1] \"age\"                      \"anaemia\"                 \n [3] \"creatinine_phosphokinase\" \"diabetes\"                \n [5] \"ejection_fraction\"        \"high_blood_pressure\"     \n [7] \"platelets\"                \"serum_creatinine\"        \n [9] \"serum_sodium\"             \"sex\"                     \n[11] \"smoking\"                  \"time\"                    \n[13] \"DEATH_EVENT\"             \n\n# How many observations & variables?\nnrow(heart_failure)\n\n[1] 299\n\n# How many rows & columns?\ndim(heart_failure)\n\n[1] 299  13"
  },
  {
    "objectID": "practice/slides_lab02.html#inspect-the-dataframe-structure-base-r",
    "href": "practice/slides_lab02.html#inspect-the-dataframe-structure-base-r",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Inspect the dataframe structure (base R)",
    "text": "Inspect the dataframe structure (base R)\n\n# What does the dataframe look like?\nstr(heart_failure)\n\n'data.frame':   299 obs. of  13 variables:\n $ age                     : num  75 55 65 50 65 90 75 60 65 80 ...\n $ anaemia                 : int  0 0 0 1 1 1 1 1 0 1 ...\n $ creatinine_phosphokinase: int  582 7861 146 111 160 47 246 315 157 123 ...\n $ diabetes                : int  0 0 0 0 1 0 0 1 0 0 ...\n $ ejection_fraction       : int  20 38 20 20 20 40 15 60 65 35 ...\n $ high_blood_pressure     : int  1 0 0 0 0 1 0 0 0 1 ...\n $ platelets               : num  265000 263358 162000 210000 327000 ...\n $ serum_creatinine        : num  1.9 1.1 1.3 1.9 2.7 2.1 1.2 1.1 1.5 9.4 ...\n $ serum_sodium            : int  130 136 129 137 116 132 137 131 138 133 ...\n $ sex                     : int  1 1 1 1 0 1 1 1 0 1 ...\n $ smoking                 : int  0 0 1 0 0 1 0 1 0 1 ...\n $ time                    : int  4 6 7 7 8 8 10 10 10 10 ...\n $ DEATH_EVENT             : int  1 1 1 1 1 1 1 1 1 1 ..."
  },
  {
    "objectID": "practice/slides_lab02.html#inspect-the-dataframe-structure-skimr",
    "href": "practice/slides_lab02.html#inspect-the-dataframe-structure-skimr",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Inspect the dataframe structure (skimr)",
    "text": "Inspect the dataframe structure (skimr)\nRemember the skimr function skim?\n\n# some variables \nheart_failure %&gt;% skimr::skim( age, DEATH_EVENT ) \n\n# the whole dataframe\nheart_failure %&gt;% skimr::skim() \n\n\n\n\n\n You try…\n\n\nRun skimr::skim() on your own either on the whole dataset or on any specific variable\n\n\n\n\nnotice there are no (missing values) NAs in any of the variables"
  },
  {
    "objectID": "practice/slides_lab02.html#recode-some-variables-for-later-ease-of-analysis",
    "href": "practice/slides_lab02.html#recode-some-variables-for-later-ease-of-analysis",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Recode some variables for later ease of analysis",
    "text": "Recode some variables for later ease of analysis\n\nI may need some variables coded as factor (e.g. categorical variables for plotting), and, while I am at it, I can add clearer labels for the variables’ levels. Here, we are:\n\nusing tidyverse packages dplyr and forcats\n\nadding new (recoded) variables called “oldname_f”\n\n\n\n\nheart_failure &lt;-heart_failure %&gt;% \n  dplyr::mutate(DEATH_EVENT_f = as.factor(DEATH_EVENT) %&gt;%\n                  forcats::fct_recode(\"died\" = \"1\", \"survived\" = \"0\")) %&gt;% \n  dplyr::mutate(sex_f = as.factor(sex) %&gt;%\n                  forcats::fct_recode(\"male\" = \"1\", \"female\" = \"0\"))\n\n# check \ntable(heart_failure$DEATH_EVENT_f)\n\n\nsurvived     died \n     203       96 \n\ntable(heart_failure$sex_f)\n\n\nfemale   male \n   105    194"
  },
  {
    "objectID": "practice/slides_lab02.html#some-more-dummy-variables-recoded-as-factor",
    "href": "practice/slides_lab02.html#some-more-dummy-variables-recoded-as-factor",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Some more dummy variables recoded as factor",
    "text": "Some more dummy variables recoded as factor\n\n[Mostly for illustration: it’s totally fine (if not preferable) to keep these as binary [0,1] variables]\n\nIt’s worth learning the useful function dplyr::across1, which allows to iteratively transform several columns at once!\n\n\n\n# Recode as factor with levels \"yes\" (= 1), \"no\" (= 0)\nfct_cols = c(\"anaemia\", \"diabetes\", \"high_blood_pressure\", \"smoking\" )\n\nheart_failure &lt;- heart_failure  %&gt;% \n  ## ---- 1st create new cols as \"factor versions\" of old cols\n  dplyr::mutate(\n    # let's introduce `across` function \n    dplyr::across(\n      # Columns to transform\n      .cols = all_of(fct_cols), \n      # Functions to apply to each col  \n      .fns =  ~as.factor (.x),\n      # new name to apply where \"{.col}\" stands for the selected column\n      .names = \"{.col}_f\")) %&gt;% \n  ## ---- 2nd create new cols as \"factor versions\" of old cols\n  dplyr::mutate(\n    dplyr::across(\n      # Columns to transform 2 conditions \n      .cols = ends_with(\"_f\") & !matches(c( \"DEATH_EVENT_f\", \"sex_f\" )) , \n      # Functions to apply to each col(different syntax)\n      .fns = ~forcats::fct_recode(.x,  yes = \"1\", no = \"0\" )))\n\nThis is a bit more advanced, but it will save a lot of typing in some situations…"
  },
  {
    "objectID": "practice/slides_lab02.html#small-digression-on-dplyracross",
    "href": "practice/slides_lab02.html#small-digression-on-dplyracross",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "(Small digression on dplyr::across)",
    "text": "(Small digression on dplyr::across)\n\nNotice how dplyr::across(.cols = ..., .fns = ..., .names = ...) has these arguments:\n\n\n.cols = to select the columns which we want to transform (i.e. fct_cols)\n\nwith help from tidyselect functions: all_of, ends_with, and matches\n\n\n\n\n.fns = ~function(.x) to specify the function   \n\nwhere ~function(.x) uses the “anonymous function” syntax of the tidyverse\n\nand .x inside the function is a “stand in” for each of the columns selected\n\n\n\n[optional] .names = to name the new cols created using {.col} in place of each of the transformed columns\n\n\n\n## ---- 1st create new cols as \"factor versions\" of old cols\nheart_failure &lt;- heart_failure  %&gt;% \n  dplyr::mutate(\n    dplyr::across(\n      .cols = all_of(fct_cols), \n      .fns = ~as.factor (.x), \n      # (optional)\n      .names = \"{.col}_f\")) %&gt;% \n  ## ---- 2nd create new cols as \"factor versions\" of old cols\n  dplyr::mutate(\n    dplyr::across(\n      .cols = ends_with(\"_f\") & !matches(c( \"DEATH_EVENT_f\", \"sex_f\" )) , \n      .fns =  ~forcats::fct_recode(.x,  yes = \"1\", no = \"0\" )))"
  },
  {
    "objectID": "practice/slides_lab02.html#why-is-visual-exploration-important",
    "href": "practice/slides_lab02.html#why-is-visual-exploration-important",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Why is visual exploration important?",
    "text": "Why is visual exploration important?\n\n\nGaining insight on the variables (range, outliers, missing data)\nPreliminary check of assumptions for parametric hypothesis testing:\n\nnormally distributed outcome variables?\nhomogeneity of variance across groups?\n\n\n\nLet’s explore the Heart failure dataset with some data visualization…\n\nFollowing the referenced articles (which were mostly interested in predict mortality based on patients’ characteristics), we will take the categorical, binary variable DEATH_EVENT_f as our main criterion to split the sample (into survived and dead patients) to explore any significant difference between groups in terms of means of known quantitative features.\n\nWe will look at both:\n\n\ncontinuous variables in the dataset (with the Probability Density Function (PDF))\n\ndiscrete variables in the dataset (with the Probability Mass Function (PMF))"
  },
  {
    "objectID": "practice/slides_lab02.html#age",
    "href": "practice/slides_lab02.html#age",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Age",
    "text": "Age\nIntroducing the handy R package patchwork which lets us compose different plots in a very simple and intuitive way\n\n(check it out with ??patchwork)\n\n\nage &lt;-ggplot(heart_failure,aes(x = age ))+\n  geom_histogram(binwidth = 5, color = \"white\", fill = \"grey\",alpha = 0.5)+\n  geom_vline(aes(xintercept = mean(age)), color = \"#4c4c4c\")+\n  theme_fivethirtyeight()+\n  labs(title = \"Age Distribution\" )+\n  scale_x_continuous(breaks = seq(40,100,5))  \n\nage2 &lt;-ggplot(heart_failure, aes(x = age, fill = DEATH_EVENT_f))+\n  geom_histogram(binwidth = 5, position = \"identity\",alpha = 0.5,color = \"white\")+\n  geom_vline(aes(xintercept = mean(age[DEATH_EVENT == 0])), color = \"#4c4c4c\")+\n  geom_vline(aes(xintercept = mean(age[DEATH_EVENT==1])), color = \"#d8717b\")+\n  theme_fivethirtyeight()+\n  scale_fill_manual(values = c(\"#999999\", \"#d8717b\"))+\n  labs(title =  \"Age Distribution by group (Death Event)\")+\n  scale_x_continuous(breaks = seq(40,100,5))\n\n# patchwork\nlibrary(patchwork)\nage + age2 + plot_layout(ncol = 1)"
  },
  {
    "objectID": "practice/slides_lab02.html#age-output",
    "href": "practice/slides_lab02.html#age-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Age",
    "text": "Age\n\n\nAs the age increases, the incidence of death event seems to increase"
  },
  {
    "objectID": "practice/slides_lab02.html#creatinine-phosphokinase-cpk",
    "href": "practice/slides_lab02.html#creatinine-phosphokinase-cpk",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Creatinine Phosphokinase (CPK)",
    "text": "Creatinine Phosphokinase (CPK)\n\ncpk &lt;- ggplot(heart_failure,aes(x = creatinine_phosphokinase))+\n  geom_density(fill = \"gray\", alpha = 0.5)+\n  scale_x_continuous(breaks = seq(0,8000, 500))+\n  geom_vline(aes(xintercept = mean(creatinine_phosphokinase)), color = \"#4c4c4c\")+\n  theme_fivethirtyeight()+\n  theme(axis.text.x = element_text(angle=50, vjust=0.75))+\n  labs(title = \"Creatinine phosphokinase (density distribution)\" )+\n  theme(plot.caption = element_text(hjust = 0.5, face = \"italic\"))\n\ncpk2 &lt;- ggplot(heart_failure,aes(x = creatinine_phosphokinase,fill = DEATH_EVENT_f))+\n  geom_density(alpha = 0.5)+theme_fivethirtyeight()+\n  scale_fill_manual(values = c(\"#999999\", \"#d8717b\"))+\n  scale_x_continuous(breaks = seq(0,8000, 500))+\n  geom_vline(aes(xintercept = mean(creatinine_phosphokinase[DEATH_EVENT == 0])),\n             color = \"#4c4c4c\")+\n  geom_vline(aes(xintercept = mean(creatinine_phosphokinase[DEATH_EVENT==1])), \n             color = \"#d8717b\")+\n  theme_fivethirtyeight()+\n  theme(axis.text.x = element_text(angle=50, vjust=0.75))+\n  labs(title =  \"Creatinine phosphokinase (density distribution) by group (Death Event)\")\n\ncpk + cpk2 + plot_layout(ncol = 1)"
  },
  {
    "objectID": "practice/slides_lab02.html#creatinine-phosphokinase-cpk-output",
    "href": "practice/slides_lab02.html#creatinine-phosphokinase-cpk-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Creatinine Phosphokinase (CPK)",
    "text": "Creatinine Phosphokinase (CPK)\n\n\nThis definitely doesn’t look like a normal distribution!"
  },
  {
    "objectID": "practice/slides_lab02.html#ejection-fraction",
    "href": "practice/slides_lab02.html#ejection-fraction",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Ejection Fraction",
    "text": "Ejection Fraction\n\nejf &lt;- ggplot(heart_failure,aes(x = ejection_fraction))+\n  geom_density(fill = \"gray\", alpha = 0.5)+\n  scale_x_continuous(breaks = seq(0,100, 5))+\n  geom_vline(aes(xintercept = mean(ejection_fraction)), color = \"#4c4c4c\")+\n  theme_fivethirtyeight()+\n  labs(title = \"Ejection Fraction (density distribution)\" )+\n  theme(plot.caption = element_text(hjust = 0.5, face = \"italic\"))\n\nejf2 &lt;- ggplot(heart_failure,aes(x = ejection_fraction,fill = DEATH_EVENT_f))+\n  geom_density(alpha = 0.5)+theme_fivethirtyeight()+\n  scale_x_continuous(breaks = seq(0,100, 5))+\n  scale_fill_manual(values = c(\"#999999\", \"#d8717b\"))+\n  geom_vline(aes(xintercept = mean(ejection_fraction[DEATH_EVENT == 0])),\n             color = \"#4c4c4c\")+\n  geom_vline(aes(xintercept = mean(ejection_fraction[DEATH_EVENT==1])), \n             color = \"#d8717b\")+\n  labs(title =  \"Ejection Fraction (density distribution) by group (Death Event)\")+\n  theme_fivethirtyeight()\n\nejf + ejf2 + plot_layout(ncol = 1)"
  },
  {
    "objectID": "practice/slides_lab02.html#ejection-fraction-output",
    "href": "practice/slides_lab02.html#ejection-fraction-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Ejection Fraction",
    "text": "Ejection Fraction\n\n\nThis also doesn’t look like a normal distribution… and there is a remarkable change in the probability density function (PDF) shape when we introduce the grouping variable"
  },
  {
    "objectID": "practice/slides_lab02.html#platelets",
    "href": "practice/slides_lab02.html#platelets",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Platelets",
    "text": "Platelets\n\n# normalize the var for readability \nheart_failure  &lt;-  heart_failure %&gt;%  dplyr::mutate(plat_norm = platelets/1000) \n\nplat &lt;- ggplot(heart_failure,aes(x = plat_norm))+\n  geom_density(fill = \"gray\", alpha = 0.5)+\n  scale_x_continuous(breaks = seq(0,800, 100))+\n  geom_vline(aes(xintercept = mean(plat_norm)), color = \"#4c4c4c\")+\n  theme_fivethirtyeight()   + \n  labs(title =  \"Platelets (density distribution)\",\n       y = \"Density\", x = \"Sample platelet count (in 10^3 µL)\") \n\nplat2 &lt;- ggplot(heart_failure,aes(x = plat_norm,fill = DEATH_EVENT_f))+\n  geom_density(alpha = 0.5)+theme_fivethirtyeight()+\n  scale_x_continuous(breaks = seq(0,800, 100))+\n  scale_fill_manual(values = c(\"#999999\", \"#d8717b\"))+\n  geom_vline(aes(xintercept = mean(plat_norm[DEATH_EVENT == 0])),\n             color = \"#4c4c4c\")+\n  geom_vline(aes(xintercept = mean(plat_norm[DEATH_EVENT==1])), \n             color = \"#d8717b\")+\n  theme_fivethirtyeight()   + \n  labs(title =  \"Platelets (density distribution) by group (Death Event)\",\n       caption = \"(Sample platelet count in 10^3 µL)\") \n \nplat + plat2 + plot_layout(ncol = 1)"
  },
  {
    "objectID": "practice/slides_lab02.html#platelets-output",
    "href": "practice/slides_lab02.html#platelets-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Platelets",
    "text": "Platelets\n\n\nHere the probability distributions resemble a Normal one and we observe more uniformity in the mean/variance across the 2 groups"
  },
  {
    "objectID": "practice/slides_lab02.html#serum-creatinine",
    "href": "practice/slides_lab02.html#serum-creatinine",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Serum Creatinine",
    "text": "Serum Creatinine\n\nser_cr &lt;- ggplot(heart_failure,aes(x = serum_creatinine))+\n  geom_density(fill = \"gray\", alpha = 0.5)+\n  scale_x_continuous(breaks = seq(0,10, 1))+\n  geom_vline(aes(xintercept = mean(serum_creatinine)), color = \"#4c4c4c\")+\n  theme_fivethirtyeight()+\n  labs(title = \"Serum Creatinine (density distribution)\" )+\n  theme(plot.caption = element_text(hjust = 0.5, face = \"italic\"))\n\nser_cr2 &lt;- ggplot(heart_failure,aes(x = serum_creatinine,fill = DEATH_EVENT_f))+\n  geom_density(alpha = 0.5)+theme_fivethirtyeight()+\n  scale_x_continuous(breaks = seq(0,10, 1))+\n  scale_fill_manual(values = c(\"#999999\", \"#d8717b\"))+\n  geom_vline(aes(xintercept = mean(serum_creatinine[DEATH_EVENT == 0])),\n             color = \"#4c4c4c\")+\n  geom_vline(aes(xintercept = mean(serum_creatinine[DEATH_EVENT==1])), \n             color = \"#d8717b\")+\n  labs(title =  \"Serum Creatinine (density distribution) by group (Death Event)\")+\n  theme_fivethirtyeight()\n\nser_cr + ser_cr2 + plot_layout(ncol = 1)"
  },
  {
    "objectID": "practice/slides_lab02.html#serum-creatinine-output",
    "href": "practice/slides_lab02.html#serum-creatinine-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Serum Creatinine",
    "text": "Serum Creatinine\n\n\nAnother continuous random variable with a non-normal distribution (long right tails) and a seemingly important difference in variance between the groups."
  },
  {
    "objectID": "practice/slides_lab02.html#serum-sodium",
    "href": "practice/slides_lab02.html#serum-sodium",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Serum Sodium",
    "text": "Serum Sodium\n\nser_sod &lt;- ggplot(heart_failure,aes(x = serum_sodium))+\n  geom_density(fill = \"gray\", alpha = 0.5)+\n  scale_x_continuous(breaks = seq(0,150, 5))+\n  geom_vline(aes(xintercept = mean(serum_sodium)), color = \"#4c4c4c\")+\n  theme_fivethirtyeight()+\n  labs(title = \"Serum Sodium (density distribution)\" )\n\nser_sod2 &lt;- ggplot(heart_failure,aes(x = serum_sodium,fill = DEATH_EVENT_f))+\n  geom_density(alpha = 0.5)+\n  scale_x_continuous(breaks = seq(0,150, 5))+\n  scale_fill_manual(values = c(\"#999999\", \"#d8717b\"))+\n  geom_vline(aes(xintercept = mean(serum_sodium[DEATH_EVENT == 0])),\n             color = \"#4c4c4c\")+\n  geom_vline(aes(xintercept = mean(serum_sodium[DEATH_EVENT==1])), \n             color = \"#d8717b\")+\n  theme_fivethirtyeight()+\n  labs(title =  \"Serum Sodium (density distribution) by group (Death Event)\")+\n  theme_fivethirtyeight()\n\nser_sod + ser_sod2 + plot_layout(ncol = 1)"
  },
  {
    "objectID": "practice/slides_lab02.html#serum-sodium-output",
    "href": "practice/slides_lab02.html#serum-sodium-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Serum Sodium",
    "text": "Serum Sodium\n\n\nSame as above, except for the long left tails…"
  },
  {
    "objectID": "practice/slides_lab02.html#anaemia",
    "href": "practice/slides_lab02.html#anaemia",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Anaemia",
    "text": "Anaemia\n\nanem &lt;- ggplot(heart_failure, aes(x = forcats::fct_infreq(DEATH_EVENT_f ), \n                                  fill = anaemia_f ))+\n  geom_bar(position = \"dodge\")+\n  ## add count labels\n  geom_text(stat = \"count\", aes(label = ..count..),\n            ## make labels suit the dodged bars \n            position=position_dodge(width = 1 ), \n            hjust=0.5, vjust=2,color = \"white\") +\n  theme_fivethirtyeight() +\n  #scale_x_discrete(labels  = c(\"Death Event:No\",\"Death Event:Yes\"))+\n  scale_fill_manual(values = c(\"#af854f\", \"#af4f78\"),\n                    name = \"Has Anaemia\",\n                    labels = c(\"No\",\"Yes\"))+\n  labs(title = \"Number of Patients with Anemia\") + \n  theme(#axis.text.x = element_text(angle=50, vjust=0.75), \n    axis.text.x = element_text(size=12,face=\"bold\"))     \n\nanem"
  },
  {
    "objectID": "practice/slides_lab02.html#anaemia-output",
    "href": "practice/slides_lab02.html#anaemia-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Anaemia",
    "text": "Anaemia\n\n\nThere seems to be a greater incidence of anaemia in group ‘died’"
  },
  {
    "objectID": "practice/slides_lab02.html#diabetes",
    "href": "practice/slides_lab02.html#diabetes",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Diabetes",
    "text": "Diabetes\n\ndiab &lt;- ggplot(heart_failure, \n               aes(x = forcats::fct_infreq(DEATH_EVENT_f ), fill = diabetes_f ))+\n  geom_bar(position = \"dodge\")+\n  ## add count labels\n  geom_text(stat = \"count\", aes(label = ..count..),\n            ## make labels suit the dodged bars \n            position=position_dodge(width = 1 ), \n            hjust=0.5, vjust=2,color = \"white\", size =4) +\n  theme_fivethirtyeight() +\n  #scale_x_discrete(labels  = c(\"Death Event:No\",\"Death Event:Yes\"))+\n  scale_fill_manual(values = c(\"#af854f\", \"#af4f78\"),\n                    name = \"Has Diabetes\",\n                    labels = c(\"No\",\"Yes\"))+\n  labs(title = \"Number of Patients with Diabetes\") + \n  theme(#axis.text.x = element_text(angle=50, vjust=0.75), \n    axis.text.x = element_text(size=12,face=\"bold\"))     \n\ndiab"
  },
  {
    "objectID": "practice/slides_lab02.html#diabetes-output",
    "href": "practice/slides_lab02.html#diabetes-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Diabetes",
    "text": "Diabetes"
  },
  {
    "objectID": "practice/slides_lab02.html#smoking",
    "href": "practice/slides_lab02.html#smoking",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Smoking",
    "text": "Smoking\n\nsmok &lt;- ggplot(heart_failure, aes(x = forcats::fct_infreq(DEATH_EVENT_f ), \n                                  fill = smoking_f ))+\n  geom_bar(position = \"dodge\")+\n  ## add count labels\n  geom_text(stat = \"count\", aes(label = ..count..),\n            ## make labels suit the dodged bars \n            position=position_dodge(width = 1 ), \n            hjust=0.5, vjust=2,color = \"white\", size =4) +\n  theme_fivethirtyeight() +\n  #scale_x_discrete(labels  = c(\"Death Event:No\",\"Death Event:Yes\"))+\n  scale_fill_manual(values = c(\"#af854f\", \"#af4f78\"),\n                    name = \"Patient smokes\",\n                    labels = c(\"No\",\"Yes\"))+\n  labs(title = \"Number of Patients who smoke\") + \n  theme(#axis.text.x = element_text(angle=50, vjust=0.75), \n    axis.text.x = element_text(size=12,face=\"bold\"))     \n\nsmok"
  },
  {
    "objectID": "practice/slides_lab02.html#smoking-output",
    "href": "practice/slides_lab02.html#smoking-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Smoking",
    "text": "Smoking"
  },
  {
    "objectID": "practice/slides_lab02.html#high-blood-pressure",
    "href": "practice/slides_lab02.html#high-blood-pressure",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "High blood pressure",
    "text": "High blood pressure\n\nhbp &lt;- ggplot(heart_failure, aes(x = forcats::fct_infreq(DEATH_EVENT_f ), \n                                  fill = high_blood_pressure_f ))+\n  geom_bar(position = \"dodge\")+\n    ## add count labels\n  geom_text(stat = \"count\", aes(label = ..count..),\n            ## make labels suit the dodged bars \n            position=position_dodge(width = 1 ), \n            hjust=0.5, vjust=2,color = \"white\", size =4) +\n  theme_fivethirtyeight() +\n  #scale_x_discrete(labels  = c(\"Death Event:No\",\"Death Event:Yes\"))+\n  scale_fill_manual(values = c(\"#af854f\", \"#af4f78\"),\n                    name = \"Has high blood pressure\",\n                    labels = c(\"No\",\"Yes\"))+\n  labs(title = \"Number of Patients with High blood pressure\") + \n  theme(#axis.text.x = element_text(angle=50, vjust=0.75), \n    axis.text.x = element_text(size=12,face=\"bold\"))     \n\nhbp"
  },
  {
    "objectID": "practice/slides_lab02.html#high-blood-pressure-output",
    "href": "practice/slides_lab02.html#high-blood-pressure-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "High blood pressure",
    "text": "High blood pressure\n\n\nThere is also a greater incidence of high blood pressure in group ‘died’"
  },
  {
    "objectID": "practice/slides_lab02.html#comparing-sample-mean-to-a-hypothesized-population-mean-with-z-test",
    "href": "practice/slides_lab02.html#comparing-sample-mean-to-a-hypothesized-population-mean-with-z-test",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Comparing sample mean to a hypothesized population mean (with Z test)",
    "text": "Comparing sample mean to a hypothesized population mean (with Z test)\n\nStating the above hypotheses more formally:\nWhat is the population Total Platelet Count (TPC) mean for all people who suffered of heart failure (\\(𝝁_{HF}\\))?\n\n\n\\(𝑯_𝟎\\) : there is no difference in mean TPC between patients who suffered heart failure and the general population\n\n\n\\(𝝁_{HF}\\) = 236 -&gt; hypothesis of no effect or (“no difference”)\n\n\n\n\\(𝑯_𝒂\\) : there is a difference in mean TPC between patients who have suffered heart failure and the general population (“some effect”). This can be formalized as either:\n\n\n\\(𝝁_{HF}\\) &lt; 236 (one-sided test), or\n\n\n\\(𝝁_{HF}\\) &gt; 236 (one-sided test), or\n\n\\(𝝁_{HF}\\) ≠ 236 (two-sided test)"
  },
  {
    "objectID": "practice/slides_lab02.html#question-how-does-the-mean-platelets-count-in-the-patients-sample-compare-against-a-reference-population",
    "href": "practice/slides_lab02.html#question-how-does-the-mean-platelets-count-in-the-patients-sample-compare-against-a-reference-population",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "1. Question: How does the mean platelets count in the patients’ sample compare against a reference population?",
    "text": "1. Question: How does the mean platelets count in the patients’ sample compare against a reference population?\n\n# compute mean & sd for plot\nmean_plat_p &lt;- round(mean(heart_failure$plat_norm), digits = 1)\nsd_plat_p &lt;- round(sd(heart_failure$plat_norm), digits = 1)\n \nheart_failure %&gt;% \n  ggplot(aes(x = plat_norm))+\n  geom_histogram(aes(y = ..density..), bins=30, alpha=0.25, colour = \"#4c4c4c\") + \n  geom_density(colour =\"#9b2339\", alpha=0.25, fill = \"#9b2339\") +\n  # add mean vertical line\n  geom_vline(xintercept = mean_plat_p, na.rm = FALSE,size = 1,color= \"#9b6723\") +\n  # add also +/- 1sd  \n  geom_vline(aes(xintercept = mean_plat_p + sd_plat_p), \n             color = \"#23749b\", size = 1, linetype = \"dashed\") +\n  geom_vline(aes(xintercept = mean_plat_p - sd_plat_p), \n             color = \"#23749b\", size = 1, linetype = \"dashed\") +\n  # add annotations with the mean value\n  geom_label(aes(x=mean_plat_p,  y=0.0085, label=paste0(\"Sample mean\\n\",mean_plat_p)),\n             color = \"#9b6723\") + \n  geom_label(aes(x=361,  y=0.0085, label=paste0(\"Sample sd\\n\",sd_plat_p)),\n             color = \"#23749b\") +\n  theme_bw() +  labs(y = \"Density\", x = \"Sample platelet count (x 1000/µL)\") \n\n\n\n\nGeneral population data taken from the literature (See Wongsaengsak, Dennis, Arevalo, Ball, & Nugent, 2019)."
  },
  {
    "objectID": "practice/slides_lab02.html#question-how-does-the-mean-platelets-count-in-the-patients-sample-compare-against-a-reference-population-output",
    "href": "practice/slides_lab02.html#question-how-does-the-mean-platelets-count-in-the-patients-sample-compare-against-a-reference-population-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "1. Question: How does the mean platelets count in the patients’ sample compare against a reference population?",
    "text": "1. Question: How does the mean platelets count in the patients’ sample compare against a reference population?\n\n\nFor a general population, the Total Platelet Count (TPL) has 𝛍=236 (1000 /µL) and 𝛔= 59 (1000 /µL). Below is the sample distribution:"
  },
  {
    "objectID": "practice/slides_lab02.html#a-computation-of-the-test-statistic",
    "href": "practice/slides_lab02.html#a-computation-of-the-test-statistic",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "2.a Computation of the test statistic",
    "text": "2.a Computation of the test statistic\n\nIn this case, we have:\n\na large sample \\((n &gt; 100)\\)\n\na known \\(𝛔^𝟐\\) (of the reference population)\nthe observed sample mean \\(\\bar{x}\\) and sample sd \\(s\\).\n\nSo we can compute:\n\\(𝒁_{calc}=\\frac{\\bar{x}-\\mu}{\\frac{\\sigma}{\\sqrt{n}}}\\)\n\n✍🏻 Let’s do it “by hand” first to see the steps\n\n\n# General Population of reference \nmu &lt;- 236 \nsigma  &lt;- 59\n# Sample of HF patients\nn &lt;- 299\nx_HF &lt;- mean(heart_failure$plat_norm)         #    263.358\ns_HF &lt;- sd(heart_failure$plat_norm)           #    97.80424\n# IF large sample & KNOWN pop variance \nstd_err_HF &lt;- sigma /sqrt(n)                  # 3.412058\nz_calc_HF &lt;-  (x_HF - mu) / std_err_HF        # 8.018043"
  },
  {
    "objectID": "practice/slides_lab02.html#b-computation-of-the-p-value-associated-to-the-test-statistic",
    "href": "practice/slides_lab02.html#b-computation-of-the-p-value-associated-to-the-test-statistic",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "2.b Computation of the p-value associated to the test statistic",
    "text": "2.b Computation of the p-value associated to the test statistic\nTo find the p-value associated with a z-score in R, we can use the pnorm() function, which uses the following syntax:\n\n\nq: The z-score\n\nmean: The mean of the normal distribution. Default is 0.\n\nsd: The standard deviation of the normal distribution. Default is 1.\n\nlower.tail:\n\nIf TRUE, the probability to the left of q in the normal distribution is returned\nIf FALSE, the probability to the right is returned. Default is TRUE.\n\n\n\n\n# Left-tailed test\np_value_l &lt;- stats::pnorm(z_calc_HF, mean = 0, sd = 1, lower.tail = TRUE) \n# Right-tailed test\np_value_r &lt;- stats::pnorm(z_calc_HF, mean = 0, sd = 1,lower.tail = FALSE) \n# Two-tailed test  (our case)\np_value_two &lt;- 2*stats::pnorm(z_calc_HF, mean = 0, sd = 1, lower.tail = FALSE)"
  },
  {
    "objectID": "practice/slides_lab02.html#c-computation-of-the-p-value-associated-to-the-test-statistic",
    "href": "practice/slides_lab02.html#c-computation-of-the-p-value-associated-to-the-test-statistic",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "2.c Computation of the p-value associated to the test statistic",
    "text": "2.c Computation of the p-value associated to the test statistic\n\n👩🏻‍💻 Let’s see how this could be done using an R function BSDA::z.test\n\n\n\nz_test_summary &lt;- BSDA::z.test(x = heart_failure$plat_norm,   \n             alternative='two.sided', \n             mu=236, \n             sigma.x=59, \n             conf.level=.95)\nz_test_summary\n\n\n    One-sample z-Test\n\ndata:  heart_failure$plat_norm\nz = 8.018, p-value = 1.074e-15\nalternative hypothesis: true mean is not equal to 236\n95 percent confidence interval:\n 256.6705 270.0455\nsample estimates:\nmean of x \n  263.358 \n\n\nSame results!"
  },
  {
    "objectID": "practice/slides_lab02.html#results-and-interpretation",
    "href": "practice/slides_lab02.html#results-and-interpretation",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "3. Results and interpretation",
    "text": "3. Results and interpretation\n\nBased on the critical region, the calculated test statistic z_calc_HF = 8.0180 falls in the CRITICAL REGION (well beyond the critical point)\n\n\n# given \nz_critical  &lt;- c(-1.96, +1.96) # (Z score corresponding to 𝛼  = 0.05)\n# Check \nz_calc_HF &gt; z_critical \n\n[1] TRUE TRUE\n\n\n\nBased on the p-value, p_value_two = 1.07443e-15 is much much smaller than \\(\\alpha\\)\n\n\n\n# Check\np_value_two &lt;  0.05\n\n[1] TRUE\n\n\nDECISION: we reject the Null Hypothesis (basically we conclude that it is extremely unlikely that the sample we drew could have occurred just by chance). So the test indicates that, indeed, there is a difference between heart failure patients and the general population in terms of average platelets count."
  },
  {
    "objectID": "practice/slides_lab02.html#comparing-sample-mean-to-a-hypothesized-population-mean-with-t-test",
    "href": "practice/slides_lab02.html#comparing-sample-mean-to-a-hypothesized-population-mean-with-t-test",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Comparing sample mean to a hypothesized population mean (with t test)",
    "text": "Comparing sample mean to a hypothesized population mean (with t test)\n\nSame question, but with a smaller sample to work on (this varies, but generally it means \\(n &lt; 30\\)). Imagine the patients were only observed over a follow-up period of 21 days, and also let’s assume we don’t know the population’s variance\nStating the hypothesis more formally:\nWhat is the population Total Platelet Count (TPC) mean for all people who suffered of heart failure (\\(𝝁_{HF21d}\\)) in the past 21 days or less?\n\n\n\\(𝑯_𝟎\\) : there is no difference in mean TPC between patients who suffered heart failure (visited in 21 days) and the general population\n\n\n\\(𝝁_{HF21d}\\) = 236 -&gt; hypothesis of no effect or (“no difference”)\n\n\n\n\\(𝑯_𝒂\\) : there is a difference in mean TPC between patients who have suffered heart failure and the general population (“some effect”). This can be formalized as:\n\n\n\\(𝝁_{HF21d}\\) ≠ 236 (two-sided test)"
  },
  {
    "objectID": "practice/slides_lab02.html#question-how-does-the-mean-platelets-count-in-the-patients-sample-compare-against-a-reference-population-1",
    "href": "practice/slides_lab02.html#question-how-does-the-mean-platelets-count-in-the-patients-sample-compare-against-a-reference-population-1",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "1. Question: How does the mean platelets count in the patients’ sample compare against a reference population?",
    "text": "1. Question: How does the mean platelets count in the patients’ sample compare against a reference population?\n\n# normalize the var for readability \nheart_21d  &lt;-  heart_failure %&gt;%  dplyr::mutate(plat_norm = platelets/1000) %&gt;% \n  filter(time &lt;= 21)                                # 23 obs \n# compute mean & sd for plot\nmean_plat_p &lt;- round(mean(heart_21d$plat_norm), digits = 1)\nsd_plat_p &lt;- round(sd(heart_21d$plat_norm), digits = 1)\n \nheart_21d %&gt;% \n  ggplot(aes(x = plat_norm))+\n  geom_histogram(aes(y = ..density..), bins=30, alpha=0.25, colour = \"#4c4c4c\") + \n  geom_density(colour =\"#9b2339\", alpha=0.25, fill = \"#9b2339\") +\n  # add mean vertical line\n  geom_vline(xintercept = mean_plat_p, na.rm = FALSE,size = 1,color= \"#9b6723\") +\n  # add also +/- 1sd  \n  geom_vline(aes(xintercept = mean_plat_p + sd_plat_p), \n             color = \"#23749b\", size = 1, linetype = \"dashed\") +\n  geom_vline(aes(xintercept = mean_plat_p - sd_plat_p), \n             color = \"#23749b\", size = 1, linetype = \"dashed\") +\n  # add annotations with the mean value\n  geom_label(aes(x=mean_plat_p,  y=0.014, label=paste0(\"Sample mean\\n\",mean_plat_p)),\n             color = \"#9b6723\") + \n  geom_label(aes(x=361,  y=0.014, label=paste0(\"Sample sd\\n\",sd_plat_p)),\n             color = \"#23749b\") +\n  theme_bw() +  labs(y = \"Density\", x = \"Sample platelet count (x 1000/µL)\")"
  },
  {
    "objectID": "practice/slides_lab02.html#question-how-does-the-mean-platelets-count-in-the-patients-sample-compare-against-a-reference-population-1-output",
    "href": "practice/slides_lab02.html#question-how-does-the-mean-platelets-count-in-the-patients-sample-compare-against-a-reference-population-1-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "1. Question: How does the mean platelets count in the patients’ sample compare against a reference population?",
    "text": "1. Question: How does the mean platelets count in the patients’ sample compare against a reference population?\n\n\nFor a general population, the Total Platelet Count (TPL) has 𝛍=236 (1000 /µL) and 𝛔= 59 (1000 /µL). Below is the smaller sample distribution:"
  },
  {
    "objectID": "practice/slides_lab02.html#a-picking-the-suitable-test",
    "href": "practice/slides_lab02.html#a-picking-the-suitable-test",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "2.a Picking the suitable test",
    "text": "2.a Picking the suitable test\nIn this case, we have:\n\na “small” sample \\(n = 23\\)\n\nan unknown \\(𝛔^𝟐\\) (of the reference population)\nWe obtained the sample mean \\(\\bar{x}\\) and sample sd \\(s\\).\n\nSo we can compute:\n\\(t_{calc} =\\frac{\\bar{x}-\\mu}{\\frac{s_\\bar{x}}{\\sqrt{n-1}}}\\)"
  },
  {
    "objectID": "practice/slides_lab02.html#b-computation-of-the-test-statistic",
    "href": "practice/slides_lab02.html#b-computation-of-the-test-statistic",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "2.b Computation of the test statistic",
    "text": "2.b Computation of the test statistic\n\n\nOption 1: Let’s compute the t test “by hand” ✍🏻\n\n\n# General Population of reference \nmu_pop &lt;- 236 \n\n# SAMPLE HF patients follow up less 21 days \nheart_21d &lt;- heart_failure %&gt;% filter(time &lt;= 21) \n\nn_21d &lt;- nrow(heart_21d)                            # 23\nx_HF_21d &lt;- mean(heart_21d$plat_norm)               # 251.5094\ns_HF_21d &lt;- sd(heart_21d$plat_norm)                 # 102.7341\ndf_HF_21d &lt;- n_21d-1                                # 22   \n\n# IF SMALL sample UNKNOWN sigma\nstd_err_HF_21d &lt;- s_HF_21d /sqrt(n_21d -1)        # 21.90298\nt_calc &lt;-  (x_HF_21d - mu_pop) / std_err_HF_21d   # 0.7080951\n\n\nOption 2: Let’s compute the t test with stats::t.test 👩🏻‍💻\n\n\nt_stat_HF_21d_v2 &lt;- stats::t.test(x = heart_21d$plat_norm,\n                                  mu = mu_pop,\n                                  alternative = \"two.sided\")\n# extract t_calc from results df\nt_calc_v2  &lt;- t_stat_HF_21d_v2[[\"statistic\"]][[\"t\"]] # 0.7240093\n\n\n\n\nThere is a small difference in the t_calc ≠ t_calc_v2 due to the fact that I use the Bessel’s correction n-1 in the sample standard deviation formula denominator, while the R function uses n"
  },
  {
    "objectID": "practice/slides_lab02.html#c-computation-of-the-p-value-associated-to-the-test-statistic-1",
    "href": "practice/slides_lab02.html#c-computation-of-the-p-value-associated-to-the-test-statistic-1",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "2.c Computation of the p-value associated to the test statistic",
    "text": "2.c Computation of the p-value associated to the test statistic\n\n\nOption 1: “by hand” ✍🏻\n\nTo find the p-value associated with a t-score in R, we can use the pt(q, df, lower.tail = TRUE) function, which uses the following syntax:\n\n\nq: The t-score\n\ndf: The degrees of freedom\n\nlower.tail:\n\nTRUE to calculate the probability to the left of q which is called as left-tailed test\nFALSE as right-tailed test.\n\n\n\n\n# ---- Option 1 \n# -- Left-tailed test\n#pt(t_stat_HF_21d, df_HF_21d, lower.tail = TRUE)\n\n# -- Right-tailed test\n#pt(t_stat_HF_21d, df_HF_21d, lower.tail = FALSE) \n\n# -- Two-tailed test  (our case)\np_value_t_test &lt;- 2*pt(t_calc, df_HF_21d, lower.tail = FALSE) # 0.4863214\n\n\nOption 2: from results of stats::t.test 👩🏻‍💻\n\n\n# ---- Option 2 \n# extract  p_value from results df\np_value_v2  &lt;- t_stat_HF_21d_v2[[\"p.value\"]] # 0.4766892"
  },
  {
    "objectID": "practice/slides_lab02.html#results-and-interpretation-1",
    "href": "practice/slides_lab02.html#results-and-interpretation-1",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "3. Results and interpretation",
    "text": "3. Results and interpretation\n\n\nBased on the critical region, t_calc ≃ 0.71 is smaller than the t critical value, i.e. it falls within the region of acceptance, so he null hypothesis is not rejected\n\n\n#find two-tailed t critical values\n\nt_crit_two &lt;- qt(p=.05/2, df=22, lower.tail=FALSE)    # 2.073873\n# Compare t score against t critical    \nt_calc &gt; t_crit_two  # FALSE \n\n[1] FALSE\n\n\n\nBased on the p-value, p_value ≃ 0.48 is larger than \\(\\alpha\\), i.e. the probability of observing a test statistic (assuming \\(H_0\\) is true) is quite large\n\n\n# Check \np_value_t_test &lt;  0.05  # FALSE \n\n[1] FALSE\n\n\nDECISION: we FAIL to reject \\(H_0\\). So the test indicates that there is not a statistically significant difference between heart failure patients visited within 21 days and the general population in terms of average platelets count.\n\n\n\n\n\n\nNote\n\n\nWhat changed testing a sample with smaller n, instead of a large one?"
  },
  {
    "objectID": "practice/slides_lab02.html#comparing-two-independent-sample-means-t-test",
    "href": "practice/slides_lab02.html#comparing-two-independent-sample-means-t-test",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Comparing two independent sample means (t test)",
    "text": "Comparing two independent sample means (t test)\n\nThis time, we investigate if there might be an actual difference in the Platelet Count means between the patients who died and the patients who survived heart failure.\nStating the above hypotheses more formally:\nIs there a statistically significant difference between the mean values of two groups?\n\n\n\\(𝑯_𝟎\\) : The two population means are equal\n\n\n\\(𝝁_𝟏 = 𝝁_𝟎 ⟺ 𝝁_𝟏−𝝁_𝟎=𝟎\\)\n\n\n\n\n\\(𝑯_𝒂\\) : There is a mean difference between the two groups in the population. Possible directional difference formulation (two-tailed, left-tailed, right-tailed)\n\n\n\\(𝝁_𝟏≠𝝁_𝟎  ⟺ 𝝁_𝟏−𝝁_𝟎≠𝟎\\) (the two population means are not equal)\n\n\\(𝝁_𝟏 &lt; 𝝁_𝟎  ⟺ 𝝁_𝟏−𝝁_𝟎&lt;𝟎\\) (population 1 mean is less than population 0 mean)\n\n\\(𝝁_𝟏 &gt; 𝝁_𝟎  ⟺ 𝝁_𝟏−𝝁_𝟎&gt;𝟎\\) (population 1 mean is greater than population 0 mean)"
  },
  {
    "objectID": "practice/slides_lab02.html#comparing-two-independent-sample-means-t-test-cont.",
    "href": "practice/slides_lab02.html#comparing-two-independent-sample-means-t-test-cont.",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Comparing two independent sample means (t test) (cont.)",
    "text": "Comparing two independent sample means (t test) (cont.)\n1. Question: Is there a statistically significant difference between the Platelet Counts in the patients who died v. survived heart failure?\n\n# boxplot by group\nheart_failure %&gt;% \n  ggplot(mapping = aes(y = plat_norm, x = DEATH_EVENT_f, fill = DEATH_EVENT_f)) +\n  geom_boxplot(alpha=0.5)+ \n  #geom_violin(alpha=0.5) +\n  geom_point(position = position_jitter(width = 0.1), size = 0.5)+ \n  scale_fill_manual(values = c(\"#999999\", \"#d8717b\"))  +\n  # drop legend and Y-axis title\n  theme(plot.title = element_text(size = 14,face=\"bold\", color = \"#873c4a\"),\n        legend.position = \"none\",\n        axis.text.x = element_text(size=12,face=\"bold\"), \n        axis.text.y = element_text(size=12,face=\"bold\")) + \n  labs(title = \"Boxplot of Total Platelet Count (TPL), grouping by DEATH_EVENT [0,1]\",\n       x = \"\", y  = \"Platelet count (1000 /µL)\")"
  },
  {
    "objectID": "practice/slides_lab02.html#comparing-two-independent-sample-means-t-test-cont.-output",
    "href": "practice/slides_lab02.html#comparing-two-independent-sample-means-t-test-cont.-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Comparing two independent sample means (t test) (cont.)",
    "text": "Comparing two independent sample means (t test) (cont.)\n\n\nThere seems to be no major difference in the two groups"
  },
  {
    "objectID": "practice/slides_lab02.html#verify-the-assumptions-for-independent-t-test",
    "href": "practice/slides_lab02.html#verify-the-assumptions-for-independent-t-test",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "2. Verify the assumptions for independent t-test",
    "text": "2. Verify the assumptions for independent t-test\n\nThe 2 samples (“died” and “survived”) must be independent ✅\nThe dependent variable is scaled in intervals (Platelets Count in 10^3 “/µL”) ✅\nThe dependent variable is normally distributed (Platelets Count in 10^3 “/µL”) ✅\n\n\n(If not, use non parametric test)\n\n\n\nThe variance within the 2 groups should be similar ❓\n\n\n(If not, perform Welch’s t-test)"
  },
  {
    "objectID": "practice/slides_lab02.html#preliminary-fishers-f-test-to-check-for-variance-equality",
    "href": "practice/slides_lab02.html#preliminary-fishers-f-test-to-check-for-variance-equality",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Preliminary Fisher’s F test to check for variance equality",
    "text": "Preliminary Fisher’s F test to check for variance equality\n\nWe can compute the Fisher test “by hand” ✍🏻\n\n\n## -- data by group\nn_died &lt;- nrow(heart_failure[heart_failure$DEATH_EVENT == 1 ,])\nmean_died &lt;- mean(heart_failure [ heart_failure$DEATH_EVENT == 1,  \"plat_norm\"])\nsd_died &lt;- sd(heart_failure [heart_failure$DEATH_EVENT == 1 ,  \"plat_norm\"])\nvar_died &lt;- var(heart_failure [heart_failure$DEATH_EVENT == 1 ,  \"plat_norm\"])\n\nn_survived &lt;- nrow(heart_failure[heart_failure$DEATH_EVENT == 0, ])\nmean_survived &lt;- mean(heart_failure [ heart_failure$DEATH_EVENT == 0,  \"plat_norm\"])\nsd_survived &lt;- sd(heart_failure [heart_failure$DEATH_EVENT == 0 ,  \"plat_norm\"])\nvar_survived &lt;- var(heart_failure [heart_failure$DEATH_EVENT == 0 ,  \"plat_norm\"])\n\n## -- F TEST\nF_ratio &lt;- var_died / var_survived\nF_ratio  # 1.020497 \n\n[1] 1.020497"
  },
  {
    "objectID": "practice/slides_lab02.html#preliminary-fishers-f-test-to-check-for-variance-equality-.cont",
    "href": "practice/slides_lab02.html#preliminary-fishers-f-test-to-check-for-variance-equality-.cont",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Preliminary Fisher’s F test to check for variance equality (.cont)",
    "text": "Preliminary Fisher’s F test to check for variance equality (.cont)\n\n## -- Define the critical value of F distribution for a risk of alpha = 0.05\n# qf(p=.05, df1 = n_died-1, df2 = n_survived-1, lower.tail = FALSE) # RIGHT-Tailed\n# qf(0.95, df1 = n_died-1, df2 = n_survived-1, lower.tail = FALSE) # LEFT- Tailed \nqf(c(0.025, 0.975), df1 = n_died-1, df2 = n_survived-1) # TWO-Tailed \n\n[1] 0.6994659 1.3987233\n\n## --Compute the exact p-value (two-tailed )\np_value_f &lt;- 2 * (1 - pf(F_ratio, df1 = (n_died-1), df2 = (n_survived-1))) \np_value_f\n\n[1] 0.8914982\n\n\nA test statistic (F) of 1.02 is obtained, with degrees of freedom 95 and 202.\nThe p-value is 0.89, greater than the p-value threshold of 0.05. This suggests we can not reject the null hypothesis of equal variances.\nThe variance within the 2 groups should be similar ✅ –&gt; we can run a t-test."
  },
  {
    "objectID": "practice/slides_lab02.html#a-computation-of-t-test-statistic",
    "href": "practice/slides_lab02.html#a-computation-of-t-test-statistic",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "3.a Computation of t test statistic",
    "text": "3.a Computation of t test statistic\n\nSince we verified the required assumptions, the test method is the independent (two-sample) t-test. In this case, we have:\n\na large sample \\((𝐧_𝟏 +𝐧_𝟐 &gt; 100)\\)\n\nthe population variance(s) are unknown, but we can assume = variances in 2 groups\n\n\n\\(standard\\, error\\) of the means’ difference is obtained as pooled estimate standard deviation of the sampling distribution of the difference\n\n\nSo we can compute: \\(t_{calc} = \\frac{Difference\\,Between\\,Sample\\,means}{Std.\\,Err.\\,of\\,the\\,difference} = \\frac{\\bar{x_1} -\\bar{x_2}}{\\sqrt{\\frac{s_{1}^{2}}{n_{1}}+\\frac{s_{2}^{2}}{n_{2}}}}\\)\n\n\n# Step 1 - compute difference of sample means\nmean_diff &lt;- (mean_died - mean_survived) # -10.27645 \n\n# Step 2 - Compute associated t-statistics\n# pooled std error \npooled_stderror &lt;- sqrt(sd_died^2/(n_died ) + sd_survived^2/(n_survived )) \n# pooled std error corrected\npooled_stderror_corr &lt;- sqrt(sd_died^2/(n_died-1) + sd_survived^2/(n_survived-1)) \n\n###  t statistic  \nt_calc &lt;- (mean_died - mean_survived) / pooled_stderror_corr"
  },
  {
    "objectID": "practice/slides_lab02.html#b-computation-of-the-p-value-associated-to-the-t-statistic",
    "href": "practice/slides_lab02.html#b-computation-of-the-p-value-associated-to-the-t-statistic",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "3.b Computation of the p-value associated to the t statistic",
    "text": "3.b Computation of the p-value associated to the t statistic\n\n# Step 3 - degrees of freedom\n# n1 + n2 - number of estimated parameters (2 means)\nd_f &lt;- n_died + n_survived - 1 - 1 # 297\n\n# Step 4 - Deduced p-value\np_value &lt;- 2 * pt(t_calc, df = d_f) # 0.4009635\np_value\n\n[1] 0.4009635"
  },
  {
    "objectID": "practice/slides_lab02.html#results-and-interpretation-2",
    "href": "practice/slides_lab02.html#results-and-interpretation-2",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "4. Results and interpretation",
    "text": "4. Results and interpretation\n\n\nLooking at the confidence interval of the difference, the sample mean_diff is well inside the 95% CI of = population mean\n\n\nmean_diff\n\n[1] -10.27645\n\n# CI of the means difference \nCI_lower &lt;- mean_diff + qt(.025, sum(n_died + n_survived) - 2) * pooled_stderror_corr  \nCI_lower\n\n[1] -34.32074\n\nCI_upper &lt;- mean_diff + qt(.975, sum(n_died + n_survived) - 2) * pooled_stderror_corr  \nCI_upper\n\n[1] 13.76785\n\n\n\nAs for the p-value, p_value = 0.40 is bigger than threshold probability \\(\\alpha\\)\n\n\n\n# Check \np_value\n\n[1] 0.4009635\n\np_value &lt;  0.05  # FALSE \n\n[1] FALSE\n\n\nDECISION: So, we fail to reject the null hypothesis of equal populations means of TPC. So the test indicates that we do not have sufficient evidence to say that the mean counts of platelets in between these two populations is different."
  },
  {
    "objectID": "practice/slides_lab02.html#comparing-sample-means-from-3-or-more-groups-anova",
    "href": "practice/slides_lab02.html#comparing-sample-means-from-3-or-more-groups-anova",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Comparing sample means from 3 or more groups (ANOVA)",
    "text": "Comparing sample means from 3 or more groups (ANOVA)\nIn this example, we adopt the ANOVA (“Analysis Of Variance”) test, i.e. an extension of the previous test, but examined how means of a variable differ across 3 or more groups. We will use ‘one- way’ ANOVA, which serves when there is only one explanatory variable (“treatment”) with 3 or more levels, and only one level of treatment is applied for a given subject.\nFor this particular case, we use another realistic dataset showing the survival times of 33 laboratory mice with thymic leukemia who were randomly divided into 3 groups:\n\n1st group received Treatment 1\n2nd group received Treatment 2\n3rd group as Control\n\n\n# load new dataset\nmice &lt;- readxl::read_excel(here::here(\"practice\",\"data_input\",\n                                      \"02_datasets\",\"mice_exe_ANOVA.xlsx\"))"
  },
  {
    "objectID": "practice/slides_lab02.html#question-is-there-a-statistically-significant-difference-between-the-mean-values-of-the-k-populations",
    "href": "practice/slides_lab02.html#question-is-there-a-statistically-significant-difference-between-the-mean-values-of-the-k-populations",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "1. Question: Is there a statistically significant difference between the mean values of the k populations?",
    "text": "1. Question: Is there a statistically significant difference between the mean values of the k populations?\nDefining the question formally:\n\n\n\\(𝑯_𝟎\\) : \\(𝝁_𝟏 = 𝝁_𝟐 =  𝝁_3\\) all 3 population means are equal\n\n\\(𝑯_𝒂\\) : at least one of \\((𝝁_𝟏,𝝁_𝟐,𝝁_3)\\) is not equal to the other means\n\n\n# boxplot by group\nmice %&gt;% \nggplot(., aes(x = group, y = surv_days, fill = group)) +\n  geom_boxplot() + \n  scale_fill_viridis(discrete = TRUE, alpha=0.6, option=\"A\") +\n  geom_jitter(color=\"black\", size=0.4, alpha=0.9) +\n  # theme_minimal() +\n  # drop legend and Y-axis title\n  theme(plot.title = element_text(size = 14,face=\"bold\", color = \"#873c4a\"),\n        axis.text.x = element_text(size=12,face=\"bold\"), \n        axis.text.y = element_text(size=12,face=\"bold\"),\n        legend.position = \"none\",\n        ) + \n  labs(title = \"Visually check mean and variance in populations' samples\" ) + \n  ylab(label = \"Survival (# days\") + xlab(label = \"\")"
  },
  {
    "objectID": "practice/slides_lab02.html#question-is-there-a-statistically-significant-difference-between-the-mean-values-of-the-k-populations-output",
    "href": "practice/slides_lab02.html#question-is-there-a-statistically-significant-difference-between-the-mean-values-of-the-k-populations-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "1. Question: Is there a statistically significant difference between the mean values of the k populations?",
    "text": "1. Question: Is there a statistically significant difference between the mean values of the k populations?\n\n\nThe boxplot suggests that the 3 groups might have some fairly different distributions"
  },
  {
    "objectID": "practice/slides_lab02.html#verify-the-assumptions-for-one-way-anova",
    "href": "practice/slides_lab02.html#verify-the-assumptions-for-one-way-anova",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "2. Verify the assumptions for one-way ANOVA",
    "text": "2. Verify the assumptions for one-way ANOVA\nThe dependent variable is on a metric scale. In the case of the analysis of variance, the independent variable (factor) has at least three levels.\nAssumptions for the results of a one-way ANOVA to be valid:\n\n\nIndependence of observations – The observations in each group are independent of each other and the observations within groups were obtained by a random sample. ✅\n\nNormally-distributed response variable – The values of the dependent variable follow a normal distribution. ❓\n\nHomogeneity of variance – The variances of the populations that the samples come from are equal. ❓"
  },
  {
    "objectID": "practice/slides_lab02.html#preliminary-check-for-normality-visual",
    "href": "practice/slides_lab02.html#preliminary-check-for-normality-visual",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Preliminary check for normality (visual)",
    "text": "Preliminary check for normality (visual)\n\n\nNormally-distributed response variable ✅\n\n\n(confirmed by visual inspection )"
  },
  {
    "objectID": "practice/slides_lab02.html#preliminary-check-for-normality-test-with-statsshapiro.test",
    "href": "practice/slides_lab02.html#preliminary-check-for-normality-test-with-statsshapiro.test",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Preliminary check for normality (test) with stats::shapiro.test",
    "text": "Preliminary check for normality (test) with stats::shapiro.test\n\n# Shapiro-Wilk Normality Test to verify normality  \n# option 1 \nstats::shapiro.test(mice[mice$group == \"Control\", \"surv_days\", drop=TRUE])\n\n\n    Shapiro-Wilk normality test\n\ndata:  mice[mice$group == \"Control\", \"surv_days\", drop = TRUE]\nW = 0.99374, p-value = 0.9989\n\nstats::shapiro.test(mice[mice$group == \"Treatment 1\", \"surv_days\", drop=TRUE])\n\n\n    Shapiro-Wilk normality test\n\ndata:  mice[mice$group == \"Treatment 1\", \"surv_days\", drop = TRUE]\nW = 0.95716, p-value = 0.6106\n\nstats::shapiro.test(mice[mice$group == \"Treatment 2\", \"surv_days\", drop=TRUE])\n\n\n    Shapiro-Wilk normality test\n\ndata:  mice[mice$group == \"Treatment 2\", \"surv_days\", drop = TRUE]\nW = 0.97921, p-value = 0.9601"
  },
  {
    "objectID": "practice/slides_lab02.html#preliminary-check-for-normality-test-with-rstatixshapiro_test",
    "href": "practice/slides_lab02.html#preliminary-check-for-normality-test-with-rstatixshapiro_test",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Preliminary check for normality (test) with rstatix::shapiro_test",
    "text": "Preliminary check for normality (test) with rstatix::shapiro_test\n(same thing, but using a different R function)\n\n\nNormally-distributed response variable – ✅\n\n\n(confirmed by Shapiro-Wilk normality test)\n\n[The null hypothesis of this test is \\(H_0\\) = “sample distribution is normal” ]\n\n# Shapiro-Wilk Normality Test to verify normality  \n# option 2 (all 3 groups at once)\nmice %&gt;%\n  dplyr::group_by(group) %&gt;%\n  rstatix::shapiro_test(surv_days)\n\n# A tibble: 3 × 4\n  group       variable  statistic     p\n  &lt;chr&gt;       &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;\n1 Control     surv_days     0.994 0.999\n2 Treatment 1 surv_days     0.957 0.611\n3 Treatment 2 surv_days     0.979 0.960"
  },
  {
    "objectID": "practice/slides_lab02.html#preliminary-check-variance-equality",
    "href": "practice/slides_lab02.html#preliminary-check-variance-equality",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Preliminary check variance equality",
    "text": "Preliminary check variance equality\n\n\n\nHomogeneity of variance – ✅\n\n\n(Besides visual inspection, confirmed by Levene test for variance equality)\n\n[The null hypothesis \\(H_0\\) = several groups have the same variance (possible variance differences occur only by chance, since there are small differences in each sampling)]\n\n# Levene test for variance equality\nlevene &lt;- mice %&gt;%                               # name of the data\n  car::leveneTest(surv_days ~ as.factor(group),   # continuous DV ~  group IV\n                  data = .,            # pipe the data from above\n                  center = mean)       # default is median \nlevene\n\nLevene's Test for Homogeneity of Variance (center = mean)\n      Df F value Pr(&gt;F)\ngroup  2  0.1721 0.8427\n      30               \n\n\nNo evidence of violations of HOV were found, since the p-value for the Levene test (= 0.8427157) is greater than .05, then the variances are not significantly different from each other (i.e., the homogeneity assumption of the variance is met)."
  },
  {
    "objectID": "practice/slides_lab02.html#computation-of-anova-f-ratio",
    "href": "practice/slides_lab02.html#computation-of-anova-f-ratio",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "3 Computation of ANOVA F-ratio",
    "text": "3 Computation of ANOVA F-ratio\nANOVA in R can be done in several ways.\nSince it’s quite straightforward, let’s do all the steps by hand first. We need to obtain the needed “ingredients” to calculate the F-ratio:\n\\[𝑭_{calc}=\\frac{Mean\\, Square\\, Between}{Mean, Square\\, Within}=  \\frac{MSB}{MSW} = \\frac{\\frac{SSB}{df1}}{\\frac{SSW}{df2}} \\]"
  },
  {
    "objectID": "practice/slides_lab02.html#a-computation-of-anova-f-ratio-by-hand",
    "href": "practice/slides_lab02.html#a-computation-of-anova-f-ratio-by-hand",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "3.a Computation of ANOVA F-ratio (“by hand”)",
    "text": "3.a Computation of ANOVA F-ratio (“by hand”)\n\n\nOption 1: Let’s compute the ANOVA test “by hand” ✍🏻\n\n\n# Summary statistics\nmice_calc &lt;- mice %&gt;% \n  dplyr::mutate(mean_all = mean(surv_days),\n         sd_all = sd (surv_days),\n         dfw = 33-3, # df1 = n-k\n         dfb = 3-1, # df2 = K−1 \n         group_f = as.factor(group)\n         ) %&gt;% \n  dplyr::group_by(group) %&gt;% \n  dplyr::mutate(n_group = n(),\n         mean_group = mean(surv_days),\n         sd_group = sd (surv_days)) %&gt;% \n  ungroup() %&gt;% \n  mutate (ST = (surv_days - mean_all)^2,\n          SW = (surv_days - mean_group)^2,\n          SB = (mean_group - mean_all)^2)\n\n# Sum of Squares \nSST &lt;- sum(mice_calc$ST)\nSSB &lt;- sum(mice_calc$SB)\nSSW &lt;- sum(mice_calc$SW)\ndfw &lt;- 33-3  # df2\ndfb &lt;- 3-1 # df1\n\n# calculated F statistic \nF_calc &lt;- (SSB/dfb)/(SSW/dfw) # 5.65\n# F critical value\nF_crit &lt;- qf(p = 0.01, df1 = 2, df2 = 30, lower.tail = FALSE) # 5.390346"
  },
  {
    "objectID": "practice/slides_lab02.html#b-computation-of-anova-f-ratio-with-r-functions",
    "href": "practice/slides_lab02.html#b-computation-of-anova-f-ratio-with-r-functions",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "3.b Computation of ANOVA F-ratio (with R functions)",
    "text": "3.b Computation of ANOVA F-ratio (with R functions)\n\nThat was just to show how to build it step-by-step (🤓), but we don’t have to! We have alternative R functions that can do ANOVA for us:\n\nOption 2: With the stats::aov followed by the command summary 👩🏻‍💻\n\n\naov_1 &lt;- stats::aov(surv_days ~ group_f,\n                 data = mice_calc)\nsummary(aov_1) \n\n            Df Sum Sq Mean Sq F value  Pr(&gt;F)   \ngroup_f      2  434.6  217.32   5.652 0.00826 **\nResiduals   30 1153.4   38.45                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nOption 3: With the stats::oneway.test() function 👩🏻‍💻\n\n\naov_2 &lt;- stats::oneway.test(surv_days ~ group_f,\n            data = mice_calc,\n            # assuming equal variances\n            var.equal = TRUE)\naov_2\n\n\n    One-way analysis of means\n\ndata:  surv_days and group_f\nF = 5.6522, num df = 2, denom df = 30, p-value = 0.008258"
  },
  {
    "objectID": "practice/slides_lab02.html#results-and-interpretation-3",
    "href": "practice/slides_lab02.html#results-and-interpretation-3",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "4. Results and interpretation",
    "text": "4. Results and interpretation\nAll 3 options have given the same results, i.e., F-ratio = 5.652 and a p-value = 0.00826\nDECISION: Given that the p-value is smaller than 0.05, we reject the null hypothesis, so we reject the hypothesis that all means are equal. Therefore, we can conclude that at least one group is different than the others in mean number of survival days.\n\n\n\n\n\n\nNote\n\n\nHave you seen the kind of notation Pr(&gt;F) 0.00826 ** before (as in the output of the stats::aov function)?"
  },
  {
    "objectID": "practice/slides_lab02.html#testing-two-groups-that-are-not-independent",
    "href": "practice/slides_lab02.html#testing-two-groups-that-are-not-independent",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Testing two groups that are not independent",
    "text": "Testing two groups that are not independent\nLet’s introduce another toy dataset just for demonstration purposes: imagine a statistics test is administered to the same group of 12 students before and after attending a workshop 😉.\n\n# toy dataset for paired groups\ngrades &lt;- data.frame(\n  before = c(16, 5, 15, 2, 14, 15, 4, 7, 15, 6, 7, 14),\n  after = c(19, 18, 9, 17, 8, 7, 16, 19, 20, 9, 11, 18)\n)\n\nWe may reshape the dataframe into the long form using tidyr::pivot_longer (for plotting)\n\n# reshape into long form\ngrades_long &lt;- grades %&gt;% \n  dplyr::mutate(id = row_number()) %&gt;%\n  tidyr::pivot_longer(cols = before:after, \n                      names_to = \"time\", \n                      values_to = \"grade\") %&gt;% \n  dplyr::group_by(id) %&gt;% \n  # recode time as factor \n  dplyr::mutate(time_f = as_factor(time ))  %&gt;% \n  # reorder time_ levels  \n  dplyr::mutate(time_f =  fct_relevel(time_f, \"after\", after =  1))"
  },
  {
    "objectID": "practice/slides_lab02.html#question-is-the-difference-between-two-paired-samples-statistically-significant",
    "href": "practice/slides_lab02.html#question-is-the-difference-between-two-paired-samples-statistically-significant",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "1. Question: Is the difference between two PAIRED samples statistically significant?",
    "text": "1. Question: Is the difference between two PAIRED samples statistically significant?\n\nWhat a successful workshop! 😁"
  },
  {
    "objectID": "practice/slides_lab02.html#hypotehsis-for-the-paired-t-test-for-dependent-samples",
    "href": "practice/slides_lab02.html#hypotehsis-for-the-paired-t-test-for-dependent-samples",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "2 Hypotehsis for the PAIRED t-test for dependent samples",
    "text": "2 Hypotehsis for the PAIRED t-test for dependent samples\n\nIn this example, it is clear that the two samples are not independent since the same 12 students took the test before and after the workshop.\nGiven that the normality assumption is NOT violated (and given the small sample size), we use the paired t-test, with the following hypotheses:\n\n\n\\(𝑯_𝟎\\) : mean grades before and after the workshop are equal\n\n\\(𝑯_𝒂\\) : mean grades before and after the workshop are different"
  },
  {
    "objectID": "practice/slides_lab02.html#computation-of-the-paired-t-test-for-dependent-samples",
    "href": "practice/slides_lab02.html#computation-of-the-paired-t-test-for-dependent-samples",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "2 Computation of the PAIRED t-test for dependent samples",
    "text": "2 Computation of the PAIRED t-test for dependent samples\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nt_stat_paired &lt;- stats::t.test(x = grades$before,\n                               y = grades$after, \n                               mu = 0, \n                               alternative = \"two.sided\",\n                               paired = TRUE\n)\nt_stat_paired\n\n\n    Paired t-test\n\ndata:  grades$before and grades$after\nt = -1.8777, df = 11, p-value = 0.08718\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n -9.2317713  0.7317713\nsample estimates:\nmean difference \n          -4.25 \n\n# extract t_calc from results df\nt_calc_pair   &lt;- t_stat_paired[[\"statistic\"]][[\"t\"]] # -1.877683\np_value_pair   &lt;- t_stat_paired[[\"p.value\"]] # 0.08717703"
  },
  {
    "objectID": "practice/slides_lab02.html#results-and-interpretation-4",
    "href": "practice/slides_lab02.html#results-and-interpretation-4",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "3. Results and interpretation",
    "text": "3. Results and interpretation\nWe obtain the test statistic, the p-value and a reminder of the hypothesis tested.\nThe calculated t value is -1.8776829 The p-value is 0.087177. Therefore, at the 5% significance level, we do not reject the null hypothesis that the statistics’ grades are similar before and after the workshop (😭)."
  },
  {
    "objectID": "practice/slides_lab02.html#bonus-function",
    "href": "practice/slides_lab02.html#bonus-function",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Bonus function!",
    "text": "Bonus function!\nIt is worth mentioning the ggstatsplot package, which combines plots representing the distribution for each group—and the results of the statistical test displayed in the subtitle of the plot.\nBelow we check out the ggwithinstats() function for paired samples.\n\n# load package\nlibrary(ggstatsplot)\n\n# plot with statistical results\ngrades_long %&gt;% \n  # must ungroup the dataframe or it will give an error\n  ungroup () %&gt;% \n  ggstatsplot::ggwithinstats(.,\n                             x = time_f ,\n                             y = grade ,\n                             type = \"parametric\", # for t test \n                             centrality.plotting = FALSE # remove median\n  )"
  },
  {
    "objectID": "practice/slides_lab02.html#bonus-function-output",
    "href": "practice/slides_lab02.html#bonus-function-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Bonus function!",
    "text": "Bonus function!\n\n\nThe test results are rendered with the plot!"
  },
  {
    "objectID": "practice/slides_lab02.html#testing-samples-without-normality-assumption",
    "href": "practice/slides_lab02.html#testing-samples-without-normality-assumption",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Testing samples without normality assumption",
    "text": "Testing samples without normality assumption\nLet’s go back to the HEART FAILURE dataset but looking at the levels of Creatinine Phosphokinase (CPK) in the blood, an enzyme that might indicate a heart failure or injury"
  },
  {
    "objectID": "practice/slides_lab02.html#question-is-there-a-statistically-significant-difference-between-cpk-levels-in-the-blood-of-the-survivors-v.-those-who-died-after-heart-failure",
    "href": "practice/slides_lab02.html#question-is-there-a-statistically-significant-difference-between-cpk-levels-in-the-blood-of-the-survivors-v.-those-who-died-after-heart-failure",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "1. Question: Is there a statistically significant difference between CPK levels in the blood of the survivors v. those who died after heart failure?",
    "text": "1. Question: Is there a statistically significant difference between CPK levels in the blood of the survivors v. those who died after heart failure?\nDefining the question formally:\n\n\\(𝑯_𝟎\\) : \\(𝝁_{CPK-died} = 𝝁_{CPK-surv}\\) there is no difference in mean CPK between patients who suffered heart failure and died versus patients who survived after heart failure\n\\(𝑯_𝒂\\) : \\(𝝁_{CPK-died} ≠ 𝝁_{CPK-surv}\\) there is a difference in mean CPK between patients who suffered heart failure and died versus patients who survived after heart failure (two-sided test)\n\n\nggplot(heart_failure,aes(x = creatinine_phosphokinase,fill = DEATH_EVENT_f))+\n  geom_density(alpha = 0.5)+theme_fivethirtyeight()+\n  scale_fill_manual(values = c(\"#999999\", \"#d8717b\"))+\n  guides(fill = \"none\") +\n  scale_x_continuous(breaks = seq(0,8000, 500))+\n  geom_vline(aes(xintercept = mean(creatinine_phosphokinase[DEATH_EVENT == 0])),\n             color = \"#4c4c4c\")+\n  geom_vline(aes(xintercept = mean(creatinine_phosphokinase[DEATH_EVENT==1])), \n             color = \"#d8717b\")+\n  theme_fivethirtyeight()+\n  theme(axis.text.x = element_text(angle=50, vjust=0.75))+\n  labs(title =  \"Creatinine phosphokinase (density distribution) by group (Death Event)\") + \n  theme(plot.title = element_text(size = 14,face=\"bold\", color = \"#873c4a\"))"
  },
  {
    "objectID": "practice/slides_lab02.html#question-is-there-a-statistically-significant-difference-between-cpk-levels-in-the-blood-of-the-survivors-v.-those-who-died-after-heart-failure-output",
    "href": "practice/slides_lab02.html#question-is-there-a-statistically-significant-difference-between-cpk-levels-in-the-blood-of-the-survivors-v.-those-who-died-after-heart-failure-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "1. Question: Is there a statistically significant difference between CPK levels in the blood of the survivors v. those who died after heart failure?",
    "text": "1. Question: Is there a statistically significant difference between CPK levels in the blood of the survivors v. those who died after heart failure?\n\n\nThe density plot suggests non normality of the variable distribution"
  },
  {
    "objectID": "practice/slides_lab02.html#preliminary-check-for-normality-visual-1",
    "href": "practice/slides_lab02.html#preliminary-check-for-normality-visual-1",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Preliminary check for normality (visual)",
    "text": "Preliminary check for normality (visual)\n\n\nNormally-distributed response variable - ❌\n\nQQ plot (or quantile-quantile plot) draws the correlation between a given sample and the normal distribution. A 45-degree reference line is also plotted. In a QQ plot, each observation is plotted as a single dot.\n\nIf the data are normal, the dots should form a straight line.\n\n\n# visual verification with QQ plot \nggpubr::ggqqplot( \n  heart_failure$creatinine_phosphokinase, \n  title = \"QQ plot for CPK levels in blood\",\n  xlab =\"Theoretical\", ylab = \"Sample (CPK)\")"
  },
  {
    "objectID": "practice/slides_lab02.html#preliminary-check-for-normality-visual-1-output",
    "href": "practice/slides_lab02.html#preliminary-check-for-normality-visual-1-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Preliminary check for normality (visual)",
    "text": "Preliminary check for normality (visual)\n\n\nIn a QQ plot, if the data are normal, the dots should follow a straight line."
  },
  {
    "objectID": "practice/slides_lab02.html#preliminary-check-for-normality-test-with-rstatixshapiro_test-1",
    "href": "practice/slides_lab02.html#preliminary-check-for-normality-test-with-rstatixshapiro_test-1",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Preliminary check for normality (test) with rstatix::shapiro_test",
    "text": "Preliminary check for normality (test) with rstatix::shapiro_test\n(same thing, but using a different R function)\n\n\nNormally-distributed response variable - ❌\n\n(NOT normality confirmed by Shapiro-Wilk normality test)\n\n\n\n[The null hypothesis of this test is \\(H_0\\) = “sample distribution(s) is/are normal” ]\nGiven the p-value we reject the null hypothesis\n\n# Shapiro-Wilk Normality Test to verify normality  \nheart_failure %&gt;%\n  dplyr::group_by(DEATH_EVENT_f) %&gt;%\n  rstatix::shapiro_test(creatinine_phosphokinase)\n\n# A tibble: 2 × 4\n  DEATH_EVENT_f variable                 statistic        p\n  &lt;fct&gt;         &lt;chr&gt;                        &lt;dbl&gt;    &lt;dbl&gt;\n1 survived      creatinine_phosphokinase     0.628 8.51e-21\n2 died          creatinine_phosphokinase     0.439 1.99e-17"
  },
  {
    "objectID": "practice/slides_lab02.html#computation-of-the-wilcoxon-rank-sum-test-statistic",
    "href": "practice/slides_lab02.html#computation-of-the-wilcoxon-rank-sum-test-statistic",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "3. Computation of the Wilcoxon Rank Sum test statistic",
    "text": "3. Computation of the Wilcoxon Rank Sum test statistic\nThe Wilcoxon Rank Sum test is considered to be the nonparametric equivalent to the two-sample independent t-test\nIts ASSUMPTIONS are:\n\nOrdinal or Continuous dependent variable: e.g. CPK levels ✅\nIndependence: All of the observations from both groups are independent of each other ✅\nShape: The shapes of the distributions for the two groups are roughly the same ✅\n\n\nwrs_res &lt;- wilcox.test(creatinine_phosphokinase ~ DEATH_EVENT, # immagino 0, 1\n                   data = heart_failure ,\n                   exact = FALSE, \n                   alternative = \"two.sided\" )\nwrs_res\n\n\n    Wilcoxon rank sum test with continuity correction\n\ndata:  creatinine_phosphokinase by DEATH_EVENT\nW = 9460, p-value = 0.684\nalternative hypothesis: true location shift is not equal to 0\n\n\n\n\nThe Wilcoxon Rank Sum test is equivalent to the Mann-Whitney U test to compare two independent samples. Different software use one or the other."
  },
  {
    "objectID": "practice/slides_lab02.html#results-and-interpretation-5",
    "href": "practice/slides_lab02.html#results-and-interpretation-5",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "4. Results and interpretation",
    "text": "4. Results and interpretation\nRESULTS: since the test statistic is W = 9460 and the corresponding p-value is 0.684 &gt; 0.05, we fail to reject the null hypothesis.\nINTERPRETATION: We do not have sufficient evidence to say that CPK levels for dead patients is different than that of survived patients \\(𝝁_{CPK-died} ≠ 𝝁_{CPK-surv}\\) at some statistically significant level)"
  },
  {
    "objectID": "practice/slides_lab02.html#testing-samples-without-homogeneous-variance-of-observations-assumption",
    "href": "practice/slides_lab02.html#testing-samples-without-homogeneous-variance-of-observations-assumption",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Testing samples without homogeneous variance of observations assumption",
    "text": "Testing samples without homogeneous variance of observations assumption"
  },
  {
    "objectID": "practice/slides_lab02.html#question-is-there-a-statistically-significant-difference-between-serum-sodium-levels-in-the-blood-of-the-survivors-v.-those-who-died-after-heart-failure",
    "href": "practice/slides_lab02.html#question-is-there-a-statistically-significant-difference-between-serum-sodium-levels-in-the-blood-of-the-survivors-v.-those-who-died-after-heart-failure",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "1. Question: Is there a statistically significant difference between serum sodium levels in the blood of the survivors v. those who died after heart failure?",
    "text": "1. Question: Is there a statistically significant difference between serum sodium levels in the blood of the survivors v. those who died after heart failure?\nDefining the question formally:\n\n\\(𝑯_𝟎\\) : \\(𝝁_{sersod-died} = 𝝁_{sersod-surv}\\) there is no difference in mean serum sodium between patients who suffered heart failure and died versus patients who survived after heart failure\n\\(𝑯_𝒂\\) : \\(𝝁_{sersod-died} ≠ 𝝁_{sersod-surv}\\) there is a difference in mean serum sodium between patients who suffered heart failure and died versus patients who survived after heart failure (two-sided test)"
  },
  {
    "objectID": "practice/slides_lab02.html#preliminary-check-hov-assumption-visual",
    "href": "practice/slides_lab02.html#preliminary-check-hov-assumption-visual",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Preliminary check “HOV” assumption (visual)",
    "text": "Preliminary check “HOV” assumption (visual)\n\n\n\nHomogeneity of Variance assumption - ❌ Plotting the data offers some graphical intuition that the variance of observations in the two groups seem not homogenous\n\n\n#Compute means and 95% confidence intervals\nswstats &lt;- heart_failure %&gt;%\n  group_by(DEATH_EVENT_f) %&gt;%\n  summarise(count = n(),\n    mean = mean(serum_sodium,na.rm=TRUE),\n    stddev = sd(serum_sodium, na.rm=TRUE),\n    meansd_l = mean - stddev,\n    meansd_u = mean + stddev)\n\n#The complete script with some styling added\nggplot(swstats, aes(x=DEATH_EVENT_f, y=mean)) + \n  geom_point(colour = \"black\" , size = 2) +\n  #Now plotting the individual data points before the mean values\n  geom_point(data=heart_failure, aes(x=DEATH_EVENT_f, y=serum_sodium, colour = DEATH_EVENT_f), \n             position = position_jitter() ) +\n  scale_colour_manual(values = c(\"#999999\",\"#d8717b\") ) +\n  #Add the error bars\n  geom_errorbar(aes(ymin = meansd_l, ymax = meansd_u), width=0.2, color = \"black\") +\n  labs(title = \"Mean (-/+SD) serum sodium (mEq/L) by group\", x = \"\", y = \"Serum Sodium\") +\n  guides(fill = \"none\")  +\n  coord_flip() +\n  labs(title =  \"Serum Sodium means and 95% confidence intervals by group (Death Event)\") + \n  theme(legend.position=\"none\",plot.title = element_text(size = 14,face=\"bold\", color = \"#873c4a\"))"
  },
  {
    "objectID": "practice/slides_lab02.html#preliminary-check-hov-assumption-visual-output",
    "href": "practice/slides_lab02.html#preliminary-check-hov-assumption-visual-output",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Preliminary check “HOV” assumption (visual)",
    "text": "Preliminary check “HOV” assumption (visual)"
  },
  {
    "objectID": "practice/slides_lab02.html#preliminary-check-hov-assumption-test",
    "href": "practice/slides_lab02.html#preliminary-check-hov-assumption-test",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Preliminary check “HOV” assumption (test)",
    "text": "Preliminary check “HOV” assumption (test)\nIt is always best to use an actual test, so we use also the Fisher’s F test to verify equal variances of Serum Sodium concentration in the two groups. [In this test \\(H_0\\) = “the ratio of variances is equal to 1”]\n\nf_test_res &lt;- stats::var.test(heart_failure$serum_sodium[heart_failure$DEATH_EVENT == 1] ,\n                              heart_failure$serum_sodium[heart_failure$DEATH_EVENT == 0])\nf_test_res\n\n\n    F test to compare two variances\n\ndata:  heart_failure$serum_sodium[heart_failure$DEATH_EVENT == 1] and heart_failure$serum_sodium[heart_failure$DEATH_EVENT == 0]\nF = 1.5769, num df = 95, denom df = 202, p-value = 0.007646\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 1.127401 2.254466\nsample estimates:\nratio of variances \n          1.576922 \n\n\nGiven the p-value = 0.007646 (smaller than \\(\\alpha\\)) we reject the null hypothesis, hence the HOV assumption for the t test does not hold."
  },
  {
    "objectID": "practice/slides_lab02.html#computation-of-the-t-test-with-the-welch-correction",
    "href": "practice/slides_lab02.html#computation-of-the-t-test-with-the-welch-correction",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "2 Computation of the t test with the Welch correction",
    "text": "2 Computation of the t test with the Welch correction\n\nWe can still run the t test but with Welch correction, i.e. the unequal variance condition is compensated by lowering the df. In fact the documentation (?t.test), reads:\n\nIf var.equal = TRUE, then the pooled variance is used to estimate the variance\nOtherwise (var.equal = FALSE), the Welch approximation to the degrees of freedom is used.\n\n\n# With Welch correction (on by default) Unequal variance is compensated by lowering df\nt_test_w &lt;- t.test(heart_failure$serum_sodium[heart_failure$DEATH_EVENT == 1], \n                   heart_failure$serum_sodium[heart_failure$DEATH_EVENT == 0],\n                   # here we specify the situation\n                   var.equal = FALSE,\n                   paired = FALSE, alternative = \"two.sided\") \n\nt_test_w\n\n\n    Welch Two Sample t-test\n\ndata:  heart_failure$serum_sodium[heart_failure$DEATH_EVENT == 1] and heart_failure$serum_sodium[heart_failure$DEATH_EVENT == 0]\nt = -3.1645, df = 154.01, p-value = 0.001872\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -2.9914879 -0.6920096\nsample estimates:\nmean of x mean of y \n 135.3750  137.2167"
  },
  {
    "objectID": "practice/slides_lab02.html#results-and-interpretation-6",
    "href": "practice/slides_lab02.html#results-and-interpretation-6",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "3. Results and interpretation",
    "text": "3. Results and interpretation\nRESULTS: since the test statistic is t = -3.1645 (with df = 154.01) and the corresponding p-value is 0.001872 &lt; 0.05, we reject the null hypothesis.\nINTERPRETATION: We therefore have sufficient evidence to say that the level of serum sodium levels for dead patients is significantly different than that of survived patients \\(𝝁_{sersod-died} ≠ 𝝁_{sersod-surv}\\)"
  },
  {
    "objectID": "practice/slides_lab02.html#final-thoughtsrecommendations",
    "href": "practice/slides_lab02.html#final-thoughtsrecommendations",
    "title": "Lab 2: Statistical inference & hypothesis testing",
    "section": "Final thoughts/recommendations",
    "text": "Final thoughts/recommendations\n\n\n\nThere are often many ways to do the same thing in R (which is both a blessing and a curse in open source software). Which should you choose? It depends on the situation, but you may want to consider:\n\nhow recent/popular/well maintained is a {package} (this affects its stability)\nthe more a function abstracts away complexity, the easier it is to use interactively, but the harder it gets to handle inside your own custom functions\ndifferent function outputs may be more/less suitable for your analysis/publication requirements (check out your peers’ choices!)\n(Always read the documentation to assess all of the above)\n\n\nWith easy equations, breaking them down “by hand” (at least once!) can really help you understand them\nIt may seem a lot of work to write R code the first time 🥵 (e.g. for a publication-ready plot), but the good news is once you wrote a script, you will be able to easily re-use it in many more instances 🙌🏻 😃\nSample size n has a very powerful impact on classical hypothesis testing results! More on this later…\n\n\n\n\n\n\n\nR 4 Biostatistics | MITGEST::training(2024)"
  }
]